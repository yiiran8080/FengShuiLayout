(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9537],{13716:(e,n,o)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/RegionTestPage",function(){return o(53911)}])},53911:(e,n,o)=>{"use strict";o.r(n),o.d(n,{default:()=>p});var s=o(37876),t=o(14232);let l=async()=>{try{console.log("\uD83C\uDF0D Detecting user region...");let e=await fetch("https://ipapi.co/json/",{timeout:5e3});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let n=await e.json();console.log("\uD83C\uDF0D Geolocation data:",n);let o=n.country_code;if("CN"===o)return console.log("\uD83C\uDDE8\uD83C\uDDF3 Detected: China"),"china";if("HK"===o)return console.log("\uD83C\uDDED\uD83C\uDDF0 Detected: Hong Kong"),"hongkong";return console.log("� Detected: Other region - using Hong Kong as default"),"hongkong"}catch(e){return console.warn("⚠️ Region detection failed:",e.message),console.log("\uD83C\uDDF9\uD83C\uDDFC Falling back to Taiwan as default region"),"taiwan"}},a=()=>{try{for(let e of navigator.languages||[navigator.language||navigator.userLanguage]){let n=e.toLowerCase();if(n.includes("zh-cn")||n.includes("zh-hans"))return console.log("\uD83C\uDE38 Language detected: Simplified Chinese (China)"),"china";if(n.includes("zh-hk"))return console.log("\uD83C\uDE33 Language detected: Hong Kong Chinese"),"hongkong"}return console.log("\uD83C\uDF10 No specific Chinese locale detected, defaulting to Hong Kong"),"hongkong"}catch(e){return console.warn("⚠️ Language detection failed:",e.message),"taiwan"}},c=async()=>{console.log("\uD83D\uDE80 Starting region detection...");let e=localStorage.getItem("userRegion");if(e&&["china","hongkong"].includes(e))return console.log("\uD83D\uDCBE Using stored region preference:",e),e;let n=await l();if("hongkong"===n){let e=a();return console.log("\uD83D\uDCCD Final region selection:",e),e}return console.log("\uD83D\uDCCD Final region selection:",n),n},i=e=>{["china","hongkong"].includes(e)&&(localStorage.setItem("userRegion",e),console.log("\uD83D\uDCBE Saved region preference:",e))},r=()=>{localStorage.removeItem("userRegion"),console.log("\uD83D\uDDD1️ Cleared region preference")},g={china:{name:"China",code:"CN",currency:"CNY",symbol:"\xa5",locale:"zh-CN",prices:{basic:688,premium:1288},stripePriceIds:{basic:"price_china_basic_cny",premium:"price_china_premium_cny"},currencyPosition:"before",flag:"\uD83C\uDDE8\uD83C\uDDF3",paymentMethods:["card","alipay","wechat_pay"]},hongkong:{name:"Hong Kong",code:"HK",currency:"HKD",symbol:"HK$",locale:"zh-TW",prices:{basic:888,premium:1588},stripePriceIds:{basic:"price_hk_basic_hkd",premium:"price_hk_premium_hkd"},currencyPosition:"before",flag:"\uD83C\uDDED\uD83C\uDDF0",paymentMethods:["card","alipay_hk","octopus"]}},d=e=>g[e]||g.hongkong,u=(e,n)=>{let o=d(n),s=e.toLocaleString();return"before"===o.currencyPosition?"".concat(o.symbol).concat(s):"".concat(s).concat(o.symbol)},h=()=>Object.keys(g).map(e=>({key:e,...g[e]})),m=()=>{let[e,n]=(0,t.useState)("hongkong"),[o,s]=(0,t.useState)(null),[l,a]=(0,t.useState)(!0),[r,g]=(0,t.useState)(null);return(0,t.useEffect)(()=>{(async()=>{try{a(!0),console.log("\uD83D\uDE80 Initializing region detection...");let e=await c(),o=d(e);n(e),s(o),g(null),console.log("✅ Region initialized:",e)}catch(o){console.error("❌ Region detection failed:",o),g(o.message);let e=d("hongkong");n("hongkong"),s(e)}finally{a(!1)}})()},[]),{region:e,regionConfig:o,isLoading:l,error:r,changeRegion:e=>{if(["china","hongkong"].includes(e)){let o=d(e);n(e),s(o),i(e),console.log("\uD83D\uDD04 Region changed to:",e)}},formatPriceForRegion:n=>u(n,e),getStripePriceId:function(){var e;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"basic";return(null==o?void 0:null===(e=o.stripePriceIds)||void 0===e?void 0:e[n])||null},currency:(null==o?void 0:o.currency)||"HKD",symbol:(null==o?void 0:o.symbol)||"HK$",locale:(null==o?void 0:o.locale)||"zh-TW",flag:(null==o?void 0:o.flag)||"��"}},x=e=>{let{currentRegion:n,onRegionChange:o,className:t=""}=e;return(0,s.jsx)("select",{value:n,onChange:e=>o(e.target.value),className:"border rounded px-3 py-2 bg-white ".concat(t),children:[{key:"china",name:"中国大陆",flag:"\uD83C\uDDE8\uD83C\uDDF3"},{key:"hongkong",name:"香港",flag:"\uD83C\uDDED\uD83C\uDDF0"}].map(e=>(0,s.jsxs)("option",{value:e.key,children:[e.flag," ",e.name]},e.key))})};function p(){var e,n;let[o,l]=(0,t.useState)([]),[a,i]=(0,t.useState)(!1),{region:g,regionConfig:d,changeRegion:u,formatPriceForRegion:p,isLoading:b}=m(),f=(e,n,o)=>{l(s=>[...s,{test:e,result:n,status:o,time:new Date().toLocaleTimeString()}])},y=async()=>{i(!0),l([]);try{f("Clear Preferences","Clearing stored preferences...","running"),r(),f("Clear Preferences","Preferences cleared","success"),f("Fresh Detection","Detecting region from IP...","running");let e=await c();for(let n of(f("Fresh Detection","Detected: ".concat(e),"success"),h()))f("Test ".concat(n.name),"Price: ".concat(p(888,n.key)),"success");f("Manual Selection","Testing manual region change...","running"),u("china"),setTimeout(()=>{f("Manual Selection","Changed to China successfully","success")},500)}catch(e){f("Test Failed",e.message,"error")}finally{i(!1)}},j=async e=>{let n=window.fetch;window.fetch=async o=>o.includes("ipapi.co")?{ok:!0,json:async()=>({country_code:e,country_name:"CN"===e?"China":"Hong Kong",city:"CN"===e?"Beijing":"Hong Kong"})}:n(o),r();let o=await c();return window.fetch=n,f("Mock ".concat(e),"Simulated ".concat(e," → detected: ").concat(o),"success"),o};return b?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),(0,s.jsx)("p",{children:"\uD83C\uDF0D Loading region detection..."})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-center mb-8",children:"\uD83E\uDDEA Region Detection Test Suite"}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\uD83D\uDCCD Current Status"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Detected Region:"})," ",null==d?void 0:d.flag," ",null==d?void 0:d.name]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Currency:"})," ",null==d?void 0:d.currency," (",null==d?void 0:d.symbol,")"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Sample Price:"})," ",p(888)]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Locale:"})," ",null==d?void 0:d.locale]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Payment Methods:"})," ",null==d?void 0:null===(e=d.paymentMethods)||void 0===e?void 0:e.join(", ")]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\uD83C\uDF9B️ Manual Selection"}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("label",{className:"font-medium",children:"Select Region:"}),(0,s.jsx)(x,{currentRegion:g,onRegionChange:u,className:"border-2 border-gray-300 rounded px-3 py-2 bg-white hover:border-green-500"}),(0,s.jsxs)("span",{className:"text-gray-600",children:["Current: ",null==d?void 0:d.flag," ",null==d?void 0:d.name]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\uD83D\uDE80 Test Controls"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("button",{onClick:y,disabled:a,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 disabled:opacity-50",children:a?"\uD83D\uDD04 Running Tests...":"\uD83E\uDDEA Run Full Test Suite"}),(0,s.jsx)("button",{onClick:()=>j("CN"),className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"\uD83C\uDDE8\uD83C\uDDF3 Mock China Location"}),(0,s.jsx)("button",{onClick:()=>j("HK"),className:"bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600",children:"\uD83C\uDDED\uD83C\uDDF0 Mock Hong Kong Location"})]}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("button",{onClick:()=>{r(),f("Clear Storage","Local storage cleared","success")},className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"\uD83D\uDDD1️ Clear Local Storage"}),(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600",children:"\uD83D\uDD04 Refresh Page"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\uD83D\uDCCA Test Results"}),0===o.length?(0,s.jsx)("p",{className:"text-gray-500",children:'No tests run yet. Click "Run Full Test Suite" to start.'}):(0,s.jsx)("div",{className:"space-y-2",children:o.map((e,n)=>(0,s.jsxs)("div",{className:"p-3 rounded flex justify-between items-center ".concat("success"===e.status?"bg-green-100 text-green-800":"error"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("strong",{children:[e.test,":"]})," ",e.result]}),(0,s.jsx)("span",{className:"text-sm",children:e.time})]},n))})]}),(0,s.jsxs)("div",{className:"mt-6 bg-gray-100 rounded-lg p-4",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"\uD83D\uDD27 Debug Info"}),(0,s.jsxs)("div",{className:"text-sm font-mono",children:[(0,s.jsxs)("p",{children:["Browser Language: ",navigator.language]}),(0,s.jsxs)("p",{children:["All Languages: ",null===(n=navigator.languages)||void 0===n?void 0:n.join(", ")]}),(0,s.jsxs)("p",{children:["User Agent: ",navigator.userAgent]}),(0,s.jsxs)("p",{children:["Local Storage:"," ",localStorage.getItem("userRegion")||"None"]})]})]})]})})}}},e=>{var n=n=>e(e.s=n);e.O(0,[636,6593,8792],()=>n(13716)),_N_E=e.O()}]);