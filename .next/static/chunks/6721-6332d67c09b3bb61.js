"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6721],{40003:(e,t,l)=>{l.d(t,{A:()=>i});var o=l(95155),r=l(60388),s=l(66766),a=l(22346),n=l(17652);function i(){let e=(0,n.c3)("home.footer"),t={contact:[{name:e("contact"),href:"/customer/contact"}],law:[{name:e("privacy"),href:"/customer/privacy"},{name:e("terms"),href:"/customer/terms"}],social:[{icon:"/images/footer/Facebook.png",href:"https://www.facebook.com/profile.php?id=61578389876952"},{icon:"/images/footer/Instagram.png",href:"https://www.instagram.com/harmoniq_fengshui/"}]};return(0,o.jsx)("footer",{className:"bg-[#004F44] text-gray-300 px-5 md:px-0",style:{fontFamily:"Noto Serif TC, serif"},children:(0,o.jsxs)("div",{className:"container px-4 mx-auto py-25",children:[(0,o.jsxs)("div",{className:"justify-center item-center text-[50px] font-bold text-white text-center mb-10",children:[(0,o.jsx)("h1",{className:"text-white",style:{fontFamily:"Noto Serif TC, serif",fontWeight:400,fontSize:"46px"},children:e("title")}),(0,o.jsx)("p",{className:"mt-2 text-white",style:{fontFamily:"Noto Serif TC, serif",fontWeight:400,fontSize:"24px"},children:e("subtitle")}),(0,o.jsx)(r.N_,{href:"/price",className:"inline-flex items-center justify-center mt-10 transition-colors hover:bg-gray-50",style:{width:"172px",height:"50px",borderRadius:"20px",backgroundColor:"white",border:"1px solid #ccc",color:"#25826C",textDecoration:"none",fontSize:"18px",fontFamily:"Noto Serif TC, serif"},children:e("button")})]}),(0,o.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-5",children:[(0,o.jsxs)("div",{className:"flex gap-12",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"mb-4 text-xl font-semibold text-white",style:{fontFamily:"Noto Serif TC, serif"},children:e("consult")}),(0,o.jsx)("ul",{className:"space-y-2",children:t.contact.map(e=>(0,o.jsx)("li",{children:(0,o.jsx)(r.N_,{href:e.href,className:"text-xl transition-colors hover:text-white",style:{fontFamily:"Noto Serif TC, serif"},children:e.name})},e.name))})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"mb-4 text-xl font-semibold text-white",style:{fontFamily:"Noto Serif TC, serif"},children:e("law")}),(0,o.jsx)("ul",{className:"space-y-2",children:t.law.map(e=>(0,o.jsx)("li",{children:(0,o.jsx)(r.N_,{href:e.href,className:"text-xl transition-colors hover:text-white",style:{fontFamily:"Noto Serif TC, serif"},children:e.name})},e.name))})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"mb-4 text-xl font-semibold text-white min-w-30",style:{fontFamily:"Noto Serif TC, serif"},children:e("focus")}),(0,o.jsx)("div",{className:"flex space-x-4",children:t.social.map(e=>e.href?(0,o.jsx)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:"transition-opacity hover:opacity-80",children:(0,o.jsx)(s.default,{src:e.icon,alt:"",width:30,height:30})},e.icon):(0,o.jsx)(s.default,{src:e.icon,alt:"",width:30,height:30},e.icon))})]})]}),(0,o.jsx)(a.Separator,{className:"mt-7.5"}),(0,o.jsx)("div",{className:"mt-5 font-semibold text-center border-t border-[#004F44] md:mt-10",style:{fontFamily:"Noto Serif TC, serif"},children:(0,o.jsxs)("p",{children:["\xa9 2025 HarmoniQ. ",e("copyright")]})})]})})}},69303:(e,t,l)=>{l.d(t,{ImageProvider:()=>n,l:()=>i});var o=l(95155),r=l(12115);let s=(0,r.createContext)(),a=(e,t,l)=>{let o=e.split(","),r=o[0].match(/:(.*?);/)[1],s=atob(o[1]),a=s.length,n=new Uint8Array(a);for(;a--;)n[a]=s.charCodeAt(a);return new File([n],t,{type:r})};function n(e){let{children:t}=e,[l,n]=(0,r.useState)(null),[i,c]=(0,r.useState)(null),[d,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>((async()=>{if(!d){try{let e=sessionStorage.getItem("uploadPicFileData");if(e){let t=JSON.parse(e);if(!t.timestamp||Date.now()-t.timestamp<36e5){let e=a(t.base64,t.name,t.type),l=URL.createObjectURL(e);c(e),n(l),console.log("ImageContext: File restored from sessionStorage:",t.name),console.log("ImageContext: Preview URL created:",l)}else sessionStorage.removeItem("uploadPicFileData"),console.log("ImageContext: Cleared old file data from sessionStorage")}}catch(e){console.error("ImageContext: Error loading saved image data:",e),sessionStorage.removeItem("uploadPicFileData")}m(!0)}})(),()=>{l&&l.startsWith("blob:")&&URL.revokeObjectURL(l)}),[]);let h=e=>{l&&l.startsWith("blob:")&&URL.revokeObjectURL(l),n(e)};return(0,o.jsx)(s.Provider,{value:{preview:l,setPreview:h,file:i,setFile:e=>{c(e),!e&&l&&h(null)},isInitialized:d},children:t})}function i(){return(0,r.useContext)(s)}},91247:(e,t,l)=>{l.d(t,{A:()=>v});var o=l(95155),r=l(12115),s=l(66766);l(29190);var a=l(35695),n=l(69303),i=l(17652),c=l(45493),d=l(91599),m=l(38543);let h=Array.from({length:100},(e,t)=>1926+t),x=Array.from({length:12},(e,t)=>t+1),f=Array.from({length:31},(e,t)=>t+1),u=Array.from({length:24},(e,t)=>t+1),g={bedroom:"bedroom",livingRoom:"living_room",diningRoom:"dining_room",kitchen:"kitchen",bathroom:"bathroom",studyRoom:"study_room",balcony:"balcony",storageRoom:"storage_room"},p={north:"north",northEast:"northEast",east:"east",center:"center",southEast:"southEast",south:"south",southWest:"southWest",west:"west",northWest:"northWest"},b=e=>new Promise((t,l)=>{let o=new FileReader;o.readAsDataURL(e),o.onload=()=>t(o.result),o.onerror=e=>l(e)}),y=(e,t,l)=>{let o=e.split(","),r=o[0].match(/:(.*?);/)[1],s=atob(o[1]),a=s.length,n=new Uint8Array(a);for(;a--;)n[a]=s.charCodeAt(a);return new File([n],t,{type:r})};function v(e){let{onResult:t}=e,l=(0,i.c3)("upload"),[v,w]=(0,r.useState)(null),[j,N]=(0,r.useState)(null),[S,R]=(0,r.useState)(!1),[C,D]=(0,r.useState)(""),[M,F]=(0,r.useState)(""),[k,I]=(0,r.useState)(""),[A,U]=(0,r.useState)(""),[L,E]=(0,r.useState)(""),[T,O]=(0,r.useState)(""),[z,P]=(0,r.useState)(""),[_,W]=(0,r.useState)(""),[B,J]=(0,r.useState)(""),[V,q]=(0,r.useState)(!1),[H,Q]=(0,r.useState)(!1),[G,K]=(0,r.useState)(null),[X,Y]=(0,r.useState)(!1),Z=(0,r.useRef)(null),$=(0,a.useRouter)(),{setPreview:ee,setFile:et}=(0,n.l)(),{data:el,status:eo}=(0,c.wV)(),er=Object.keys(g),es=Object.keys(p),ea=()=>{try{localStorage.setItem("uploadPicFormData",JSON.stringify({gender:C,year:M,month:k,day:A,hour:L,roomType:T,direction:z,validationError:G})),console.log("Form data saved to localStorage")}catch(e){console.error("Error saving form data:",e)}},en=()=>{try{let e=localStorage.getItem("uploadPicFormData");if(e){let t=JSON.parse(e);D(t.gender||""),F(t.year||""),I(t.month||""),U(t.day||""),E(t.hour||""),O(t.roomType||""),P(t.direction||""),K(t.validationError||null),console.log("Form data loaded from localStorage")}}catch(e){console.error("Error loading form data:",e)}},ei=async e=>{try{if(e){let t={base64:await b(e),name:e.name,size:e.size,type:e.type,lastModified:e.lastModified,timestamp:Date.now()};sessionStorage.setItem("uploadPicFileData",JSON.stringify(t)),console.log("File data saved to sessionStorage:",e.name)}}catch(e){console.error("Error saving file data:",e)}},ec=async()=>{try{let e=sessionStorage.getItem("uploadPicFileData");if(e){let t=JSON.parse(e);if(!t.timestamp||Date.now()-t.timestamp<36e5){let e=y(t.base64,t.name,t.type),l=URL.createObjectURL(e);return w(e),N(l),et(e),ee(l),console.log("File restored from sessionStorage:",t.name),console.log("Preview URL created:",l),!0}sessionStorage.removeItem("uploadPicFileData"),console.log("Cleared old file data from sessionStorage")}}catch(e){console.error("Error loading file data:",e),sessionStorage.removeItem("uploadPicFileData")}return!1},ed=()=>{localStorage.removeItem("uploadPicFormData"),sessionStorage.removeItem("uploadPicFileData"),console.log("Saved data cleared")};async function em(){var e;let t=g[T],o=p[z];if("loading"===eo){m.oR.info(l("checkingAuth")||"Checking authentication...");return}if("unauthenticated"===eo||!(null==el?void 0:null===(e=el.user)||void 0===e?void 0:e.userId)){ea(),v&&await ei(v);let e="/freereport?roomType=".concat(encodeURIComponent(t),"&direction=").concat(encodeURIComponent(o)),r="/auth/login?callbackUrl=".concat(encodeURIComponent(e));m.oR.info(l("redirectingToLogin")||"Please log in to continue..."),$.push(r);return}q(!0);try{let e="".concat(M,"-").concat(k.padStart(2,"0"),"-").concat(A.padStart(2,"0"),"T").concat(L.padStart(2,"0"),":00"),{status:l}=await (0,d.bE)("/api/users/".concat(el.user.userId),{gender:C,birthDateTime:e});0===l?(m.oR.success("保存成功！"),ed(),$.push("/freereport?roomType=".concat(encodeURIComponent(t),"&direction=").concat(encodeURIComponent(o)))):m.oR.error("保存失败！")}catch(e){m.oR.error("保存失败："+e),console.error("Error saving user info:",e)}finally{q(!1)}}(0,r.useEffect)(()=>((async()=>{!X&&(console.log("Initializing component, loading saved data..."),console.log("Session status:",eo),en(),await ec()?console.log("File successfully restored from storage"):console.log("No saved file found"),Y(!0))})(),()=>{j&&j.startsWith("blob:")&&URL.revokeObjectURL(j)}),[]),(0,r.useEffect)(()=>{"loading"!==eo&&X&&(async()=>{v||j||(console.log("Session loaded, rechecking saved file data..."),await ec()&&console.log("File restored after login"))})()},[eo,X,v,j]),(0,r.useEffect)(()=>{X&&(C||M||k||A||L||T||z)&&ea()},[C,M,k,A,L,T,z,G,X]);let eh=e=>new Promise(t=>{let l=document.createElement("img");l.onload=()=>{let e=document.createElement("canvas"),o=e.getContext("2d"),r=Math.min(512/l.width,512/l.height);e.width=l.width*r,e.height=l.height*r,o.drawImage(l,0,0,e.width,e.height);let s=ex(o.getImageData(0,0,e.width,e.height)),a=ef(s);console.log("Room Detection Analysis:",{...s,finalDecision:a?"ROOM DETECTED":"NOT A ROOM",confidence:s.overallScore}),URL.revokeObjectURL(l.src),t(a)},l.onerror=()=>{console.error("Failed to load image for room detection"),URL.revokeObjectURL(l.src),t(!1)},l.src=URL.createObjectURL(e)}),ex=e=>{let{data:t,width:l,height:o}=e;return{wallDetection:eu(e),floorDetection:eg(e),ceilingDetection:ep(e),cornersDetection:eb(e),doorDetection:ev(e),windowDetection:ej(e),lightingAnalysis:eS(e),shadowAnalysis:eR(e),furnitureDetection:eC(e),textureAnalysis:eD(e),colorAnalysis:eF(e),perspectiveAnalysis:ek(e),depthAnalysis:eI(e),scaleAnalysis:eA(e),overallScore:0}},ef=e=>{let t=0,l=0;e.wallDetection.detected&&(t+=25*e.wallDetection.confidence),l+=25,e.floorDetection.detected&&(t+=20*e.floorDetection.confidence),l+=20,e.cornersDetection.detected&&(t+=15*e.cornersDetection.confidence),l+=15,e.doorDetection.detected&&(t+=15*e.doorDetection.confidence),l+=15,e.windowDetection.detected&&(t+=10*e.windowDetection.confidence),l+=10,e.lightingAnalysis.isIndoorLighting&&(t+=10*e.lightingAnalysis.confidence),l+=10,e.shadowAnalysis.hasIndoorShadows&&(t+=8*e.shadowAnalysis.confidence),l+=8,e.furnitureDetection.detected&&(t+=12*e.furnitureDetection.confidence),l+=12,e.textureAnalysis.hasIndoorTextures&&(t+=8*e.textureAnalysis.confidence),l+=8,e.colorAnalysis.hasIndoorColors&&(t+=7*e.colorAnalysis.confidence),l+=7,e.perspectiveAnalysis.hasIndoorPerspective&&(t+=5*e.perspectiveAnalysis.confidence),l+=5,e.depthAnalysis.hasIndoorDepth&&(t+=5*e.depthAnalysis.confidence),e.overallScore=t/(l+=5)*100;let o=e.overallScore>37,r=e.wallDetection.detected||e.floorDetection.detected||e.cornersDetection.detected||e.lightingAnalysis.isIndoorLighting||e.furnitureDetection.detected;return o&&r},eu=e=>{let{data:t,width:l,height:o}=e,r=0,s=0;for(let e=10;e<l-10;e+=8){let a=0,n=null;for(let r=10;r<o-10;r+=8){let o=(r*l+e)*4,i=(t[o]+t[o+1]+t[o+2])/3;null!==n&&30>Math.abs(i-n)&&a++,n=i;let c=t[o];eU(c,t[o+1],t[o+2])&&s++}a>o/8*.6&&r++}let a=0;for(let e=.2*o;e<.8*o;e+=15){let o=0;for(let r=10;r<l-10;r+=10){let s=((e-5)*l+r)*4,a=((e+5)*l+r)*4;s>=0&&a<t.length&&Math.abs((t[s]+t[s+1]+t[s+2])/3-(t[a]+t[a+1]+t[a+2])/3)>25&&o++}o>l/10*.3&&a++}let n=r/(l/8)*.5+s/(l*o/64)*.3+a/10*.2;return{detected:n>.3,confidence:Math.min(n,1),verticalLines:r,wallTextures:s,horizontalBoundaries:a}},eg=e=>{let{data:t,width:l,height:o}=e,r=Math.floor(.6*o),s=0,a=0,n=0;for(let e=r;e<o-5;e+=6)for(let o=5;o<l-5;o+=8){let r=(e*l+o)*4,i=t[r],c=t[r+1],d=t[r+2];eL(i,c,d)&&s++;let m=(e*l+(o+8))*4;m<t.length&&25>Math.abs((i+c+d)/3-(t[m]+t[m+1]+t[m+2])/3)&&a++,n++}let i=s/n*.7+a/n*.3;return{detected:i>.25,confidence:Math.min(2*i,1),floorTextures:s,horizontalPatterns:a}},ep=e=>{let{data:t,width:l,height:o}=e,r=Math.floor(.4*o),s=0,a=0,n=0;for(let e=5;e<r;e+=8)for(let r=5;r<l-5;r+=8){let i=(e*l+r)*4,c=t[i],d=t[i+1],m=t[i+2];eE(c,d,m)&&s++;let h=0;for(let s=-4;s<=4;s+=4)for(let a=-4;a<=4;a+=4){let n=r+s,i=e+a;if(n>=0&&n<l&&i>=0&&i<o){let e=(i*l+n)*4;20>Math.abs((t[e]+t[e+1]+t[e+2])/3-(c+d+m)/3)&&h++}}h>=6&&a++,n++}let i=s/n*.6+a/n*.4;return{detected:i>.2,confidence:Math.min(2.5*i,1),ceilingTextures:s,uniformAreas:a}},eb=e=>{let{data:t,width:l,height:o}=e,r=0;return[{x:0,y:0,w:.3*l,h:.3*o},{x:.7*l,y:0,w:.3*l,h:.3*o},{x:0,y:.7*o,w:.3*l,h:.3*o},{x:.7*l,y:.7*o,w:.3*l,h:.3*o}].forEach(e=>{let s=0;for(let r=0;r<20;r++){let r=e.x+Math.random()*e.w,a=e.y+Math.random()*e.h;r>=5&&r<l-5&&a>=5&&a<o-5&&(s+=ey(t,l,o,Math.floor(r),Math.floor(a)))}s/20>.3&&r++}),{detected:r>=2,confidence:r/4,cornersFound:r}},ey=(e,t,l,o,r)=>{let s=(r*t+o)*4,a=(e[s]+e[s+1]+e[s+2])/3,n=0,i=[];return[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]].forEach(s=>{let[c,d]=s,m=o+3*c,h=r+3*d;if(m>=0&&m<t&&h>=0&&h<l){let l=(h*t+m)*4,o=Math.abs(a-(e[l]+e[l+1]+e[l+2])/3);i.push(o),o>30&&n++}}),n>=4?n/8:0},ev=e=>{let{data:t,width:l,height:o}=e,r=0;for(let e=.1*o;e<.9*o;e+=12)for(let s=10;s<l-40;s+=12)ew(t,l,o,s,e)>.5&&r++;return{detected:r>0,confidence:Math.min(r/3,1),doorShapes:r}},ew=(e,t,l,o,r)=>{if(o+30>=t||r+60>=l)return 0;let s=0,a=0,n=0;for(let l=r;l<r+60;l+=6)for(let i=o;i<o+30;i+=6){let c=(l*t+i)*4,d=(e[c]+e[c+1]+e[c+2])/3;d<80&&s++,(i===o||i===o+30-6||l===r||l===r+60-6)&&d>100&&a++,n++}return s/n*.7+a/(.3*n)*.3},ej=e=>{let{data:t,width:l,height:o}=e,r=0;for(let e=.1*o;e<.7*o;e+=15)for(let s=10;s<l-50;s+=15)eN(t,l,o,s,e)>.4&&r++;return{detected:r>0,confidence:Math.min(r/2,1),windowShapes:r}},eN=(e,t,l,o,r)=>{if(o+50>=t||r+40>=l)return 0;let s=0,a=0;for(let l=r+5;l<r+40-5;l+=6)for(let r=o+5;r<o+50-5;r+=6){let o=(l*t+r)*4;(e[o]+e[o+1]+e[o+2])/3>150&&s++,a++}return s/a},eS=e=>{let{data:t}=e,l=0,o=0,r=0,s=0;for(let e=0;e<t.length;e+=12){let a=(t[e]+t[e+1]+t[e+2])/3;a>180?l++:a<70?o++:r++,s++}let a=l/s,n=o/s,i=r/s,c=a>.05&&a<.4&&n>.1&&n<.5&&i>.3;return{isIndoorLighting:c,confidence:c?.8:.2,brightRatio:a,darkRatio:n,mediumRatio:i}},eR=e=>{let{data:t,width:l,height:o}=e,r=0,s=0,a=0;for(let e=10;e<o-10;e+=10)for(let o=10;o<l-10;o+=10){let n=(e*l+o)*4,i=(t[n]+t[n+1]+t[n+2])/3;if(i<60){r++;let a=(e*l+(o+10))*4;a<t.length&&(t[a]+t[a+1]+t[a+2])/3>i+40&&s++}a++}let n=r/a,i=s/a,c=n>.05&&n<.4&&i>.02;return{hasIndoorShadows:c,confidence:c?.7:.3,shadowRatio:n,transitionRatio:i}},eC=e=>{let{data:t,width:l,height:o}=e,r=0,s=0,a=0;for(let e=.3*o;e<o-20;e+=15)for(let n=20;n<l-20;n+=15){let i=(e*l+n)*4,c=t[i];eT(c,t[i+1],t[i+2])&&s++,eJ(t,l,o,n,e,25,20)&&r++,a++}let n=s/a*.6+r/a*.4;return{detected:n>.15,confidence:Math.min(3*n,1),furnitureColors:s,furnitureShapes:r}},eD=e=>{let{data:t,width:l,height:o}=e,r=0,s=0,a=0;for(let e=10;e<o-10;e+=12)for(let n=10;n<l-10;n+=12){let i=eM(t,l,o,n,e);"smooth"===i?r++:"patterned"===i&&s++,a++}let n=r/a,i=s/a,c=n>.2||i>.1;return{hasIndoorTextures:c,confidence:c?.6:.4,smoothRatio:n,patternedRatio:i}},eM=(e,t,l,o,r)=>{let s=0,a=0,n=[];for(let s=-3;s<=3;s+=3)for(let i=-3;i<=3;i+=3){let c=o+i,d=r+s;if(c>=0&&c<t&&d>=0&&d<l){let l=(d*t+c)*4,o=(e[l]+e[l+1]+e[l+2])/3;n.push(o),a++}}if(a>0){let e=n.reduce((e,t)=>e+t,0)/a;s=n.reduce((t,l)=>t+Math.pow(l-e,2),0)/a}return s<200?"smooth":s>800?"rough":"patterned"},eF=e=>{let{data:t}=e,l=0,o=0,r=0,s=0;for(let e=0;e<t.length;e+=16){let a=t[e],n=t[e+1],i=t[e+2];eO(a,n,i)?l++:ez(a,n,i)?o++:eP(a,n,i)&&r++,s++}let a=l/s,n=o/s,i=r/s,c=a>.3&&i<.3;return{hasIndoorColors:c,confidence:c?.7:.3,neutralRatio:a,warmRatio:n,vibrantRatio:i}},ek=e=>{let{data:t,width:l,height:o}=e,r=0;for(let e=.3*o;e<.7*o;e+=20){let o=0;for(let r=10;r<l-10;r+=10){let s=(e*l+r)*4,a=(e*l+(r+10))*4;a<t.length&&Math.abs((t[s]+t[s+1]+t[s+2])/3-(t[a]+t[a+1]+t[a+2])/3)>25&&o++}o>l/10*.3&&r++}let s=r>=2;return{hasIndoorPerspective:s,confidence:s?.6:.4,horizontalLines:r}},eI=e=>{let{data:t,width:l,height:o}=e,r=0;Math.abs(e_(t,l,o,0,.7*o,l,o)-e_(t,l,o,0,0,l,.3*o))>20&&r++;let s=0;for(let e=.2*o;e<.8*o;e+=25)for(let r=.2*l;r<.8*l;r+=25)eW(t,l,o,r,e)&&s++;s>2&&r++;let a=r>=1;return{hasIndoorDepth:a,confidence:a?.5:.3,depthCues:r}},eA=e=>{let{data:t,width:l,height:o}=e,r=0,s=0;for(let e=20;e<o-40;e+=30)for(let a=20;a<l-40;a+=30){let n=eB(t,l,o,a,e);n>10&&n<.3*l&&r++,s++}let a=r/s,n=a>.3;return{hasAppropriateScale:n,confidence:n?.5:.3,scaleRatio:a}},eU=(e,t,l)=>{let o=(e+t+l)/3,r=Math.max(e,t,l)-Math.min(e,t,l);return o>120&&o<240&&r<40},eL=(e,t,l)=>{let o=e>80&&e<180&&t>60&&t<140&&l>30&&l<100,r=30>Math.abs(e-t)&&30>Math.abs(t-l)&&(e+t+l)/3>100,s=Math.max(e,t,l)-Math.min(e,t,l)>20&&(e+t+l)/3>60;return o||r||s},eE=(e,t,l)=>{let o=Math.max(e,t,l)-Math.min(e,t,l);return(e+t+l)/3>180&&o<30},eT=(e,t,l)=>{let o=e>60&&e<160&&t>40&&t<120&&l>20&&l<80,r=Math.max(e,t,l)-Math.min(e,t,l)>15&&(e+t+l)/3>50,s=e>80&&e<140&&t>50&&t<100&&l>30&&l<70;return o||r||s},eO=(e,t,l)=>{let o=(e+t+l)/3;return 30>Math.max(Math.abs(e-o),Math.abs(t-o),Math.abs(l-o))&&o>60&&o<200},ez=(e,t,l)=>e>t&&e>l&&e>100,eP=(e,t,l)=>Math.max(e,t,l)-Math.min(e,t,l)>60,e_=(e,t,l,o,r,s,a)=>{let n=0,i=0;for(let c=r;c<a;c+=5)for(let r=o;r<s;r+=5)if(r>=0&&r<t&&c>=0&&c<l){let l=(c*t+r)*4;n+=(e[l]+e[l+1]+e[l+2])/3,i++}return i>0?n/i:0},eW=(e,t,l,o,r)=>{let s=0;for(let a=-8;a<=8;a+=4)for(let n=-8;n<=8;n+=4){let i=o+n,c=r+a;if(i>=0&&i<t&&c>=0&&c<l){let l=(c*t+i)*4,a=(r*t+o)*4;Math.abs((e[l]+e[l+1]+e[l+2])/3-(e[a]+e[a+1]+e[a+2])/3)>30&&s++}}return s>8},eB=(e,t,l,o,r)=>{let s=new Set,a=[[o,r]],n=(r*t+o)*4,i=(e[n]+e[n+1]+e[n+2])/3,c=0;for(;a.length>0&&c<100;){let[o,r]=a.pop(),n="".concat(o,",").concat(r);if(s.has(n)||o<0||o>=t||r<0||r>=l)continue;s.add(n);let d=(r*t+o)*4;25>Math.abs((e[d]+e[d+1]+e[d+2])/3-i)&&(c++,a.push([o+1,r],[o-1,r],[o,r+1],[o,r-1]))}return c},eJ=(e,t,l,o,r,s,a)=>{if(o+s>=t||r+a>=l)return!1;let n=0,i=0;for(let l=0;l<s;l+=3){let s=(r*t+(o+l))*4,c=((r+a)*t+(o+l))*4;c<e.length&&(20>Math.abs((e[s]+e[s+1]+e[s+2])/3-(e[c]+e[c+1]+e[c+2])/3)&&n++,i++)}for(let l=0;l<a;l+=3){let a=((r+l)*t+o)*4,c=((r+l)*t+(o+s))*4;c<e.length&&(20>Math.abs((e[a]+e[a+1]+e[a+2])/3-(e[c]+e[c+1]+e[c+2])/3)&&n++,i++)}return i>0&&n/i>.6},eV=async e=>{let t=e.target.files[0];if(t&&("image/jpeg"===t.type||"image/png"===t.type)&&t.size<=0xa00000){Q(!0),K(null);try{let e=await eh(t),o=URL.createObjectURL(t);e?(w(t),N(o),et(t),ee(o),m.oR.success(l("roomDetected"))):(K(l("invalidRoomImage")),w(t),N(o),et(t),ee(o),m.oR.error(l("invalidRoomImage"))),await ei(t),console.log("File uploaded and saved:",t.name)}catch(l){console.error("Room validation error:",l);let e=URL.createObjectURL(t);w(t),N(e),et(t),ee(e),K(null),await ei(t)}Q(!1)}else m.oR.error(l("invalidFileFormat"))};return(0,o.jsxs)("div",{className:"flex flex-col items-center justify-start w-full px-4 py-6 text-center mb-30 sm:px-6 md:px-8 lg:px-0",style:{fontFamily:'"Noto Serif TC", serif'},children:[(0,o.jsx)("h1",{className:"mb-4 text-xl font-normal mt-10 mb-30 text-[#004f44] sm:text-2xl md:text-3xl lg:text-4xl xl:text-5xl leading-tight sm:leading-normal",children:l("title")}),(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center w-full max-w-6xl gap-6 md:flex-row md:items-start lg:gap-8",children:[(0,o.jsxs)("div",{className:"w-full md:flex-1 md:max-w-5xl",children:[(0,o.jsxs)("div",{className:"h-48 sm:h-56 md:h-64 lg:h-80 rounded-lg bg-[#f7fffd] border-[#25826c] border-dashed border-2 box-border flex flex-col items-center justify-center p-4 sm:p-6 md:p-8",children:[H?(0,o.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,o.jsx)("div",{className:"w-8 h-8 border-2 border-[#318161] border-t-transparent rounded-full animate-spin"}),(0,o.jsx)("p",{className:"text-sm text-[#004f44]",children:l("validatingImage")})]}):(0,o.jsx)("label",{className:"flex items-center justify-center w-full h-full cursor-pointer",htmlFor:"file-upload",children:(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center w-full gap-3 sm:gap-4 md:gap-6",children:[(0,o.jsx)(s.default,{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 lg:w-16 lg:h-16",loading:"lazy",width:66,height:66,alt:"",src:"/images/report/materialsymbolsupload.svg"}),(0,o.jsx)("h3",{className:"text-sm font-normal text-center sm:text-base md:text-lg lg:text-xl xl:text-2xl text-[#004f44] px-2",children:l("uploadAction")}),(0,o.jsx)("div",{className:"text-xs text-center sm:text-sm md:text-base lg:text-lg text-[#666] px-2",children:l("fileFormat")}),(0,o.jsx)("button",{type:"button",className:"px-4 py-2 text-sm font-medium text-white transition-all duration-200 bg-transparent border-none rounded-lg cursor-pointer sm:px-6 sm:py-3 md:text-base lg:text-lg bg-gradient-to-r from-[#318161] to-[#318177] hover:scale-105 active:scale-95",onClick:()=>{var e;return null===(e=Z.current)||void 0===e?void 0:e.click()},children:l("browseButton")})]})}),(0,o.jsx)("input",{className:"hidden",type:"file",id:"file-upload",accept:"image/jpeg,image/png",ref:Z,onChange:eV,disabled:H})]}),(0,o.jsx)("div",{className:"mt-3 text-xs text-left sm:text-sm md:text-base text-[#004f44] px-1",children:l("disclaimer")})]}),v&&(0,o.jsxs)("div",{className:"flex flex-col items-center w-full gap-4 mt-4 md:items-end md:w-auto md:mt-0",children:[(0,o.jsxs)("div",{className:"flex items-center gap-3 p-3 border rounded-lg shadow-sm sm:gap-4 ".concat(G?"bg-red-50 border-red-200":"bg-white border-gray-100"),children:[j&&(0,o.jsx)(s.default,{className:"object-cover w-12 h-12 rounded sm:w-14 sm:h-14 md:w-16 md:h-16",loading:"lazy",width:64,height:64,alt:"",src:j,onError:e=>{console.error("Image failed to load:",j),console.log("File object:",v)}}),(0,o.jsxs)("div",{className:"flex flex-col justify-center min-w-0",children:[(0,o.jsx)("div",{className:"text-sm font-medium truncate sm:text-base text-[#004f44] max-w-32 sm:max-w-40",children:v.name}),(0,o.jsxs)("div",{className:"text-xs text-gray-500 sm:text-sm",children:[(v.size/1024/1024).toFixed(2)," MB"]}),G&&(0,o.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[(0,o.jsx)("svg",{className:"flex-shrink-0 w-3 h-3 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,o.jsx)("span",{className:"text-xs font-medium text-red-600 sm:text-sm",children:G})]})]})]}),(0,o.jsx)("button",{onClick:()=>{j&&j.startsWith("blob:")&&URL.revokeObjectURL(j),w(null),N(null),et(null),ee(null),K(null),ed(),Z.current&&(Z.current.value="")},className:"flex items-center justify-center w-8 h-8 transition-colors rounded-full sm:w-10 sm:h-10 ".concat(G?"bg-red-100 hover:bg-red-200":"bg-red-50 hover:bg-red-100"),children:(0,o.jsx)(s.default,{className:"w-4 h-4 sm:w-5 sm:h-5",loading:"lazy",width:20,height:20,alt:l("close"),src:"/images/linemdtrash.png"})})]})]}),v&&!G&&(0,o.jsx)("div",{className:"flex justify-center w-full mt-8 sm:mt-10",children:(0,o.jsx)("button",{type:"button",className:"w-full max-w-xs px-6 py-3 text-base font-medium text-white transition-all duration-200 rounded-lg shadow-lg sm:w-auto sm:px-8 sm:py-4 sm:text-lg bg-gradient-to-r from-[#7BB8A9] to-[#318177] hover:scale-105 hover:shadow-xl active:scale-95",onClick:()=>R(!0),children:l("nextStep")})}),v&&G&&(0,o.jsx)("div",{className:"flex justify-center w-full mt-8 sm:mt-10",children:(0,o.jsxs)("div",{className:"flex items-center max-w-md gap-3 px-4 py-3 text-sm text-red-700 border border-red-200 rounded-lg bg-red-50 sm:text-base",children:[(0,o.jsx)("svg",{className:"flex-shrink-0 w-5 h-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"font-medium",children:l("uploadDifferentImage")}),(0,o.jsx)("p",{className:"mt-1 text-xs text-red-600",children:l("roomImageRequired")})]})]})}),S&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"fixed inset-0 z-40 bg-opacity-30 backdrop-blur-sm",onClick:()=>R(!1)}),(0,o.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,o.jsxs)("div",{className:"relative w-full max-w-md max-h-[90vh] overflow-y-auto bg-white rounded-xl shadow-2xl",children:[(0,o.jsxs)("div",{className:"sticky top-0 z-10 flex items-center justify-between p-4 bg-white border-b rounded-t-xl sm:p-6",children:[(0,o.jsx)("h2",{className:"text-lg font-bold text-center text-[#004f44] sm:text-xl",children:l("modalTitle")}),(0,o.jsx)("button",{className:"text-2xl text-gray-400 transition-colors hover:text-gray-600",onClick:()=>R(!1),"aria-label":l("close"),children:"\xd7"})]}),(0,o.jsxs)("div",{className:"p-4 space-y-4 sm:p-6 sm:space-y-6",children:[(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-left text-[#004f44] sm:text-base",children:l("gender")}),(0,o.jsxs)("select",{className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#318161] focus:border-transparent sm:text-base",value:C,onChange:e=>D(e.target.value),children:[(0,o.jsx)("option",{value:"",children:l("genderSelect")}),(0,o.jsx)("option",{value:"male",children:l("male")}),(0,o.jsx)("option",{value:"female",children:l("female")})]})]}),(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-left text-[#004f44] sm:text-base",children:l("birthDateTime")}),(0,o.jsxs)("div",{className:"grid grid-cols-4 gap-2 sm:gap-3",children:[(0,o.jsxs)("select",{className:"px-2 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#318161] focus:border-transparent sm:text-sm",value:M,onChange:e=>F(e.target.value),children:[(0,o.jsx)("option",{value:"",children:l("year")}),h.map(e=>(0,o.jsx)("option",{value:e,children:e},e))]}),(0,o.jsxs)("select",{className:"px-2 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#318161] focus:border-transparent sm:text-sm",value:k,onChange:e=>I(e.target.value),children:[(0,o.jsx)("option",{value:"",children:l("month")}),x.map(e=>(0,o.jsx)("option",{value:e,children:e},e))]}),(0,o.jsxs)("select",{className:"px-2 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#318161] focus:border-transparent sm:text-sm",value:A,onChange:e=>U(e.target.value),children:[(0,o.jsx)("option",{value:"",children:l("day")}),f.map(e=>(0,o.jsx)("option",{value:e,children:e},e))]}),(0,o.jsxs)("select",{className:"px-2 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#318161] focus:border-transparent sm:text-sm",value:L,onChange:e=>E(e.target.value),children:[(0,o.jsx)("option",{value:"",children:l("hour")}),u.map(e=>(0,o.jsx)("option",{value:e,children:e},e))]})]})]}),(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-left text-[#004f44] sm:text-base",children:l("roomType")}),(0,o.jsxs)("select",{className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#318161] focus:border-transparent sm:text-base",value:T,onChange:e=>O(e.target.value),children:[(0,o.jsx)("option",{value:"",children:l("roomTypeSelect")}),er.map(e=>(0,o.jsx)("option",{value:e,children:l("roomTypes.".concat(e))},e))]})]}),(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-left text-[#004f44] sm:text-base",children:l("direction")}),(0,o.jsxs)("select",{className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#318161] focus:border-transparent sm:text-base",value:z,onChange:e=>P(e.target.value),children:[(0,o.jsx)("option",{value:"",children:l("directionSelect")}),es.map(e=>(0,o.jsx)("option",{value:e,children:l("directions.".concat(e))},e))]})]})]}),(0,o.jsxs)("div",{className:"sticky bottom-0 z-10 p-4 space-y-3 bg-white border-t rounded-b-xl sm:p-6",children:[(0,o.jsx)("button",{className:"w-full py-3 text-base font-bold text-white transition-all duration-200 rounded-lg shadow-lg sm:text-lg bg-gradient-to-r from-[#7BB8A9] to-[#318177] hover:scale-105 hover:shadow-xl active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",onClick:em,disabled:V||"loading"===eo,children:V?l("calculating"):"loading"===eo?l("checkingAuth")||"Checking...":l("startAnalysis")}),(0,o.jsx)("button",{className:"w-full px-3 py-2 text-sm text-gray-500 transition-colors bg-transparent rounded hover:text-gray-700 hover:bg-gray-50",onClick:()=>{R(!1)},children:l("back")})]})]})})]}),B&&(0,o.jsx)("div",{className:"w-full max-w-2xl p-4 mt-6 text-sm text-gray-800 whitespace-pre-line bg-gray-100 rounded-lg sm:text-base",children:B}),V&&(0,o.jsx)("div",{className:"mt-6 text-sm text-blue-500 sm:text-base",children:l("processing")})]})}}}]);