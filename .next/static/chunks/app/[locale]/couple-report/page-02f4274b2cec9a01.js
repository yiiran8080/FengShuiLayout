(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3007],{539:(e,t,n)=>{"use strict";n.d(t,{h:()=>s}),e=n.hmd(e);class s{static getYearPillar(e){let t=(e-4)%10;return{tianGan:this.tianGan[t],diZhi:this.diZhi[(e-4)%12],element:this.wuXing[this.tianGan[t]]}}static getDayPillar(e){let t=new Date("1900-01-01"),n=Math.floor((new Date(e)-t)/864e5),s=n%10;return{tianGan:this.tianGan[s],diZhi:this.diZhi[n%12],element:this.wuXing[this.tianGan[s]]}}static analyzeElementStrength(e,t){var n;let s=new Date().getMonth()+1,a="";return a=s>=3&&s<=5?"春季":s>=6&&s<=8?"夏季":s>=9&&s<=11?"秋季":"冬季",{description:(null===(n=({木:{strong:"春季出生，木旺",weak:"秋季出生，金克木"},火:{strong:"夏季出生，火旺",weak:"冬季出生，水克火"},土:{strong:"四季末出生，土旺",weak:"春季出生，木克土"},金:{strong:"秋季出生，金旺",weak:"夏季出生，火克金"},水:{strong:"冬季出生，水旺",weak:"夏季出生，土克水"}})[t])||void 0===n?void 0:n.strong)||"中等強度",season:a,advice:this.getElementAdvice(t)}}static getElementAdvice(e){return({木:"宜東方發展，忌金屬尖銳物品，多接觸綠色植物",火:"宜南方發展，忌水濕環境，多使用紅色物品",土:"宜中央或西南發展，穩重踏實，多使用黃色物品",金:"宜西方發展，忌火熱環境，多使用白色金屬物品",水:"宜北方發展，忌土燥環境，多使用黑色或藍色物品"})[e]||"根據個人情況調整"}static getPersonalityAnalysis(e){return({木:"性格正直，具有成長性和創造力，但有時過於理想化",火:"性格熱情，具有領導力和行動力，但有時過於急躁",土:"性格穩重，具有包容性和責任感，但有時過於保守",金:"性格堅毅，具有組織力和決斷力，但有時過於固執",水:"性格靈活，具有智慧和適應力，但有時過於多變"})[e]||"性格特質需要進一步分析"}}s.tianGan=["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],s.diZhi=["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],s.wuXing={甲:"木",乙:"木",丙:"火",丁:"火",戊:"土",己:"土",庚:"金",辛:"金",壬:"水",癸:"水",子:"水",丑:"土",寅:"木",卯:"木",辰:"土",巳:"火",午:"火",未:"土",申:"金",酉:"金",戌:"土",亥:"水"},e.exports&&(e.exports={BaziCalculator:s})},32379:(e,t,n)=>{Promise.resolve().then(n.bind(n,50548))},50548:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>V});var s=n(95155),a=n(12115),l=n(35695),i=n(85339),r=n(51976);n(43562),n(16218),n(31623),n(76970),n(47571),n(37895),n(98066),n(71097),n(88903),n(91534);var c=n(60470),o=n(85495);let d=(0,a.createContext)(),m=()=>{let e=(0,a.useContext)(d);if(!e)throw Error("useCoupleAnalysis must be used within a CoupleAnalysisProvider");return e},u=e=>{let{children:t,user1:n,user2:l,specificProblem:i}=e,[r,c]=(0,a.useState)(null),[o,m]=(0,a.useState)(!0),[u,g]=(0,a.useState)(null),[h,x]=(0,a.useState)(null),[p,f]=(0,a.useState)(null),[b,y]=(0,a.useState)({}),[v,j]=(0,a.useState)(null),[N,w]=(0,a.useState)(null),[S,C]=(0,a.useState)(null);return(0,a.useEffect)(()=>{(async()=>{if(!(null==n?void 0:n.birthDateTime)||!(null==l?void 0:l.birthDateTime)){m(!1);return}try{m(!0),console.log("\uD83D\uDD2E Fetching comprehensive couple analysis...");let e=await fetch("/api/couple-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({birthday:n.birthDateTime,birthday2:l.birthDateTime,gender:n.gender||"male",gender2:l.gender||"female",problem:i||"感情關係和諧改善建議",sessionId:"couple-analysis-".concat(Date.now())})});if(!e.ok)throw Error("Analysis request failed: ".concat(e.status));let t=await e.json();if(t.success&&t.data)console.log("✅ Couple analysis completed successfully"),c(t.data),g(null);else throw Error(t.error||"Analysis failed")}catch(e){console.error("❌ Failed to fetch couple analysis:",e),g(e.message),c(null)}finally{m(!1)}})()},[n,l,i]),(0,s.jsx)(d.Provider,{value:{analysisData:r,loading:o,error:u,annualAnalysisCache:h,setAnnualAnalysisCache:x,godAnalysisCache:p,setGodAnalysisCache:f,individualAnalysisCache:b,setIndividualAnalysisCache:y,coupleMingJuCache:v,setCoupleMingJuCache:j,coupleSeasonCache:N,setCoupleSeasonCache:w,coupleCoreSuggestionCache:S,setCoupleCoreSuggestionCache:C,refetch:()=>{c(null),g(null),x(null),f(null),y({}),j(null),w(null),C(null),m(!0)}},children:t})};var g=n(35226),h=n(40003),x=n(19946);(0,x.A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);let p=(0,x.A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);var f=n(82940),b=n.n(f),y=n(7419),v=n.n(y),j=n(25932),N=n(34831);function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"male";try{let n=e;e.includes("T")||e.includes(" ")||(n="".concat(e," 12:00:00"));let s=b()(n).format("YYYY-MM-DD HH:mm:ss"),a=v()(s);a.char8ex(+("female"!==t));let l={year:{stem:a.char8.year.stem.name,stemElement:a.char8.year.stem.e5.name,branch:a.char8.year.branch.name,branchElement:a.char8.year.branch.e5.name,nayin:a.char8.year.takeSound,nayinElement:a.char8.year.takeSoundE5.toString()},month:{stem:a.char8.month.stem.name,stemElement:a.char8.month.stem.e5.name,branch:a.char8.month.branch.name,branchElement:a.char8.month.branch.e5.name,nayin:a.char8.month.takeSound,nayinElement:a.char8.month.takeSoundE5.toString()},day:{stem:a.char8.day.stem.name,stemElement:a.char8.day.stem.e5.name,branch:a.char8.day.branch.name,branchElement:a.char8.day.branch.e5.name,nayin:a.char8.day.takeSound,nayinElement:a.char8.day.takeSoundE5.toString()},hour:{stem:a.char8.hour.stem.name,stemElement:a.char8.hour.stem.e5.name,branch:a.char8.hour.branch.name,branchElement:a.char8.hour.branch.e5.name,nayin:a.char8.hour.takeSound,nayinElement:a.char8.hour.takeSoundE5.toString()}},i={金:0,木:0,水:0,火:0,土:0};Object.values(l).forEach(e=>{e.stemElement&&i[e.stemElement]++,e.branchElement&&i[e.branchElement]++});let r=Object.keys(i).reduce((e,t)=>i[e]>i[t]?e:t),c=Object.entries(i).filter(e=>{let[t,n]=e;return 0===n}).map(e=>{let[t]=e;return t});return{dayMasterElement:l.day.stemElement,dayMasterStem:l.day.stem,lifeElement:l.year.nayinElement,lifeNayin:l.year.nayin,fourPillars:l,elementCounts:i,dominantElement:r,missingElements:c,birthDateTime:s,gender:t,calculationMethod:"lunisolar_unified"}}catch(e){throw console.error("Unified element calculation error:",e),Error("Element calculation failed: ".concat(e.message))}}v().extend(j.t).extend(N.sM);let S=e=>{let{femaleUser:t,maleUser:n,analysisData:l}=e,[i,r]=(0,a.useState)(null),[c,o]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t&&n&&l&&d()},[t,n,l]);let d=async()=>{var e,s,a,i,c;o(!0);try{let c=new AbortController,o=setTimeout(()=>{c.abort(),console.log("⏰ Chart diagnosis API call timed out after 60 seconds")},6e4),d=await fetch("/api/chart-diagnosis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({femaleUser:t,maleUser:n,femaleBazi:null==l?void 0:null===(e=l.female)||void 0===e?void 0:e.bazi,maleBazi:null==l?void 0:null===(s=l.male)||void 0===s?void 0:s.bazi,femalePillars:null==l?void 0:null===(a=l.female)||void 0===a?void 0:a.pillars,malePillars:null==l?void 0:null===(i=l.male)||void 0===i?void 0:i.pillars,requestType:"chart_diagnosis"}),signal:c.signal});if(clearTimeout(o),d.ok){let e=await d.json();r(e)}else r({female:{title:"命局：王水生寅月",content:m(null==l?void 0:l.female,"female")},male:{title:"命局：王水生申月",content:m(null==l?void 0:l.male,"male")},keySymptoms:"您日支「寅」（需情表達）與伴侶日支「申金」沖克，貴水代表您的內在情感需求，渴望溫暖、直接且充滿活力的表達方式；而申金則代表伴侶的理性與克制，偏向於以靜默的方式處理情感。形成「想溝通卻無法順暢」的核心循環，非單純爭吵，而是熱情漸受侵蝕，彼此間的默契與親密度受到挑戰。"})}catch(t){console.error("Chart diagnosis generation failed:",t);let e="正在分析";"AbortError"===t.name?e="分析超時，請稍後重試":(null===(c=t.message)||void 0===c?void 0:c.includes("timeout"))&&(e="請求超時，正在重新嘗試"),r({female:{title:"命局：分析中",content:"".concat(e,"，您的命局特性分析中...")},male:{title:"命局：分析中",content:"".concat(e,"，伴侶的命局特性分析中...")},keySymptoms:"".concat(e,"，關鍵合盤徵象分析中...")})}finally{o(!1)}},m=(e,t)=>{if(!e)return"分析數據準備中...";let n="female"===t?"您":"伴侶";return"".concat(n,"的八字顯示").concat(e.bazi||"特殊命格","，在感情表達上具有獨特的模式。根據當前大運流年（2025乙巳年）的影響，").concat(n,"的情感需求和表達方式可能受到一定程度的影響，需要特別注意溝通方式的調整。")};return c?(0,s.jsx)("div",{className:"w-full p-8 bg-white rounded-[30px] shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-6 h-6 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"生成盤面診斷中..."})]})}):i?(0,s.jsx)("div",{className:"w-full bg-white rounded-[30px] shadow-lg p-8",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("h3",{className:"font-bold text-[#C74772]",style:{fontSize:"30px",fontFamily:"Noto Serif TC, serif"},children:"女方"}),(0,s.jsx)("div",{className:"px-4 py-2 bg-white border-2 border-[#C74772] rounded-full",children:(0,s.jsx)("span",{className:"text-sm font-medium text-[#C74772]",children:i.female.title})})]}),(0,s.jsx)("div",{className:"p-4 bg-gray-100 rounded-lg",children:(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-800",children:i.female.content})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("h3",{className:"font-bold text-[#3263C4]",style:{fontSize:"30px",fontFamily:"Noto Serif TC, serif"},children:"男方"}),(0,s.jsx)("div",{className:"px-4 py-2 bg-white border-2 border-[#3263C4] rounded-full",children:(0,s.jsx)("span",{className:"text-sm font-medium text-[#3263C4]",children:i.male.title})})]}),(0,s.jsx)("div",{className:"p-4 bg-gray-100 rounded-lg",children:(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-800",children:i.male.content})})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("div",{className:"px-4 py-2 bg-white border-2 border-[#C74772] rounded-full",children:(0,s.jsx)("span",{className:"text-[20px] font-bold text-[#C74772]",style:{fontFamily:"Noto Serif TC, serif"},children:"關鍵合盤徵象"})})}),(0,s.jsx)("div",{className:"p-6 bg-gray-100 rounded-lg",children:(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-800",children:i.keySymptoms})})]})]})}):null},C=e=>{var t;let{femaleUser:n,maleUser:l,analysisData:i}=e,[r,c]=(0,a.useState)(null),[o,d]=(0,a.useState)(!1);(0,a.useEffect)(()=>{n&&l&&i&&m()},[n,l,i]);let m=async()=>{d(!0),console.log("\uD83D\uDD25 Starting Emergency Feng Shui generation...",{femaleUser:null==n?void 0:n.name,maleUser:null==l?void 0:l.name,hasAnalysisData:!!i});try{var e,t,s,a;let r=new AbortController,o=setTimeout(()=>{r.abort(),console.log("⏰ Feng Shui API call timed out after 60 seconds")},6e4),d={femaleUser:n,maleUser:l,femaleBazi:null==i?void 0:null===(e=i.female)||void 0===e?void 0:e.bazi,maleBazi:null==i?void 0:null===(t=i.male)||void 0===t?void 0:t.bazi,femalePillars:null==i?void 0:null===(s=i.female)||void 0===s?void 0:s.pillars,malePillars:null==i?void 0:null===(a=i.male)||void 0===a?void 0:a.pillars,requestType:"emergency_feng_shui"};console.log("\uD83D\uDCE4 Sending request body:",d);let m=await fetch("/api/emergency-feng-shui",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d),signal:r.signal});if(clearTimeout(o),console.log("\uD83D\uDCE5 Response status:",m.status,m.ok),m.ok){let e=await m.json();console.log("✅ Received API data:",e),c(e)}else console.log("API response not OK, status:",m.status),c({recommendations:[{title:"臥室東側放置銅製擺件",description:"在臥室東側放置小型銅製龍鳳擺件或金屬風鈴，能調和金木相剋的能量，增強感情穩定性，每日清晨整理一次。",color:"#B08D57"},{title:"客廳點燃粉色蠟燭",description:"每晚7-9點在客廳點燃粉色或暖黃色蠟燭30分鐘，營造溫馨氛圍，粉色屬火能溫暖感情，促進深度溝通交流。",color:"#C4839F"},{title:"床頭擺放紅色靠枕",description:"在床頭放置紅色或粉色抱枕，激活愛情能量，紅色屬火能溫暖雙方感情，建議選用絲質或棉質材料效果更佳。",color:"#7B8B5C"}]})}catch(e){console.error("Emergency Feng Shui generation failed:",e),c({recommendations:[{title:"臥室擺放金屬擺件",description:"在臥室東側放置小型銅製飾品或金屬風鈴，能調和五行能量，增強感情穩定性，建議每晚睡前整理一次，保持金屬表面光亮。",color:"#B08D57"},{title:"床頭點燃暖色蠟燭",description:"每晚點燃暖黃色蠟燭約30分鐘，營造溫馨氛圍，暖光能柔化彼此情緒，促進深度溝通，建議使用天然蜂蠟蠟燭效果更佳。",color:"#C4839F"},{title:"客廳西南角鋪紅毯",description:"在客廳西南方向鋪設小塊紅色或暖色地毯，激活坤土能量，增強家庭和諧與包容心，紅色屬火能溫暖感情氣場。",color:"#7B8B5C"}]})}finally{d(!1)}};return o?(0,s.jsx)("div",{className:"w-full p-8 bg-white rounded-[30px] shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-6 h-6 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"生成風水急救方案中..."})]})}):r?(0,s.jsxs)("div",{className:"w-full bg-white rounded-[30px] shadow-lg p-8",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)("h3",{className:"font-bold text-[#C74772]",style:{fontSize:"42px",fontFamily:"Noto Serif TC, serif"},children:"72小時內行動方案"})}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:null===(t=r.recommendations)||void 0===t?void 0:t.map((e,t)=>(0,s.jsxs)("div",{className:"space-y-3 bg-[#EFEFEF] p-4 rounded-lg",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("div",{className:"inline-block px-4 py-2 text-lg font-medium text-white rounded-full",style:{background:"linear-gradient(135deg, #C74772 0%, #D09900 100%)",fontFamily:"Noto Sans TC, sans-serif"},children:e.title})}),(0,s.jsx)("div",{className:"p-4 ",children:(0,s.jsx)("p",{className:"leading-relaxed text-gray-800 text-md",style:{fontFamily:"Noto Sans TC, sans-serif"},children:e.description})})]},t))})]}):null},E=e=>{var t;let{femaleUser:n,maleUser:l,analysisData:i}=e,[r,c]=(0,a.useState)(null),[o,d]=(0,a.useState)(!1);(0,a.useEffect)(()=>{n&&l&&i&&m()},[n,l,i]);let m=async()=>{d(!0),console.log("\uD83D\uDC95 Starting Restart Chemistry generation...",{femaleUser:null==n?void 0:n.name,maleUser:null==l?void 0:l.name,hasAnalysisData:!!i});try{var e,t,s,a;let r=new AbortController,o=setTimeout(()=>{r.abort(),console.log("⏰ Chemistry API call timed out after 60 seconds")},6e4),d={femaleUser:n,maleUser:l,femaleBazi:null==i?void 0:null===(e=i.female)||void 0===e?void 0:e.bazi,maleBazi:null==i?void 0:null===(t=i.male)||void 0===t?void 0:t.bazi,femalePillars:null==i?void 0:null===(s=i.female)||void 0===s?void 0:s.pillars,malePillars:null==i?void 0:null===(a=i.male)||void 0===a?void 0:a.pillars,requestType:"restart_chemistry"};console.log("\uD83D\uDCE4 Sending chemistry request body:",d);let m=await fetch("/api/restart-chemistry",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d),signal:r.signal});if(clearTimeout(o),console.log("\uD83D\uDCE5 Chemistry response status:",m.status,m.ok),m.ok){let e=await m.json();console.log("✅ Received chemistry API data:",e),c(e)}else console.log("Chemistry API response not OK, status:",m.status),c({iceBreakers:[{title:"雙人能量流轉茶會",steps:["選擇帶有花香（木元素）的茶葉，搭配紅色茶具（火元素）","在客廳東南方位佈置溫馨茶席，點燃暖色蠟燭","泡茶時輪流分享當天最溫暖的一個時刻"],principle:"運用木生火→火生土的能量循環，針對你們八字中的沉寂能量進行溫和激活",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"五行音波共振舞",steps:["女方選金屬音質（鐘聲/鋼琴曲），男方選水屬性音樂（流水聲）","交叉播放不同元素音樂，隨音樂自由擺動身體","每首歌結束後擁抱10秒，感受彼此能量"],principle:"以金生水→水生木的循環，化解你們八字配置中的能量阻滯，重啟情感流動",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"星光願力投射劇場",steps:["用暖黃燈光（火）與陶土燭台（土）佈置陽台或房間","準備願景便利貼，各自寫下對未來3個月的期待","輪流演出自己的願景，另一人扮演支持者角色"],principle:"運用火土相生破解八字中水過旺的懷舊傾向，創造前進動力與穩定基礎",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"}],generalAdvice:"基於你們的八字配置，建議增加「元素體驗日」活動，調整表達方式為正向溝通模式，並建立每日「五行擊掌」儀式來促進能量流動。重點在於打破沉悶模式，重建互動默契，讓感情重新煥發活力與溫暖。"})}catch(e){console.error("Restart Chemistry generation failed:",e),c({iceBreakers:[{title:"溫馨茶會時光",steps:["選擇花香茶葉配紅色茶具，營造木火相生氛圍","在客廳東南方佈置茶席，點燃暖色蠟燭","泡茶過程中輪流分享當日溫暖時刻"],principle:"根據八字分析，運用木生火能量流轉，化解你們關係中的沉寂狀態",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"音樂共振療癒",steps:["分別選擇金屬音（鋼琴）與水聲音樂（流水）","交替播放，隨節拍自然擺動身體","每首歌後擁抱，感受彼此能量交流"],principle:"以金生水→水生木循環，針對你們八字配置進行能量調和與激活",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"願景劇場體驗",steps:["用暖燈與陶土蠟燭佈置空間（火土相生）","寫下未來期待，製作願景便利貼","輪流表演願景，伴侶扮演支持角色"],principle:"運用火土能量破解八字中過度懷舊傾向，創造積極前進動力",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"}],generalAdvice:"根據你們的八字特質，建議建立規律的元素體驗活動，改善溝通表達方式，透過五行能量平衡儀式來重啟感情默契。重點是打破現有沉悶模式，創造新的互動機會，讓關係重新充滿活力與溫暖連結。"})}finally{d(!1)}};return o?(0,s.jsx)("div",{className:"w-full p-8 bg-white rounded-[30px] shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-6 h-6 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"生成重啟默契方案中..."})]})}):r?(0,s.jsxs)("div",{className:"w-full bg-white rounded-[30px] shadow-lg p-8",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)("h3",{className:"font-bold text-[#C74772]",style:{fontSize:"42px",fontFamily:"Noto Serif TC, serif"},children:"破冰儀式建議"})}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 mb-8 lg:grid-cols-3",children:null===(t=r.iceBreakers)||void 0===t?void 0:t.map((e,t)=>{var n;return(0,s.jsxs)("div",{className:"space-y-4 bg-[#EFEFEF] p-6 rounded-lg",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("div",{className:"inline-block px-6 py-3 text-base font-bold text-white rounded-full",style:{background:e.gradient,fontFamily:"Noto Serif TC, serif"},children:e.title})}),(0,s.jsx)("div",{className:"space-y-3",children:null===(n=e.steps)||void 0===n?void 0:n.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex items-center justify-center flex-shrink-0 w-6 h-6 mt-1 mr-3 text-sm font-bold text-white rounded-full",style:{background:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},children:t+1}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-800",style:{fontFamily:"Noto Sans TC, sans-serif"},children:e})]},t))}),(0,s.jsx)("div",{className:"p-3 mt-4 border-red-400 rounded-lg bg-gradient-to-r from-red-50 to-yellow-50",children:(0,s.jsx)("p",{className:"text-xs font-medium text-center text-red-700",style:{fontFamily:"Noto Sans TC, sans-serif"},children:e.principle})})]},t)})}),(0,s.jsx)("div",{className:"p-6 border border-gray-200 rounded-lg bg-gradient-to-r from-gray-50 to-blue-50",children:(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-700",style:{fontFamily:"Noto Sans TC, sans-serif"},children:r.generalAdvice})})]}):null},F=e=>{var t;let{femaleUser:n,maleUser:l,analysisData:i}=e,[r,c]=(0,a.useState)(null),[o,d]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=!0;return n&&l&&i&&e&&m(),()=>{e=!1}},[n,l,i]);let m=async()=>{var e,t,s,a,r;d(!0),console.log("⭐ Starting Star Chart Guidance generation...",{femaleUser:null==n?void 0:n.name,maleUser:null==l?void 0:l.name,hasAnalysisData:!!i});try{let r={femaleUser:n,maleUser:l,femaleBazi:null==i?void 0:null===(e=i.female)||void 0===e?void 0:e.bazi,maleBazi:null==i?void 0:null===(t=i.male)||void 0===t?void 0:t.bazi,femalePillars:null==i?void 0:null===(s=i.female)||void 0===s?void 0:s.pillars,malePillars:null==i?void 0:null===(a=i.male)||void 0===a?void 0:a.pillars,requestType:"star_chart_guidance"};console.log("\uD83D\uDCE4 Sending star chart request body:",r);let o=await fetch("/api/star-chart-guidance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(console.log("\uD83D\uDCE5 Star chart response status:",o.status,o.ok),o.ok){let e=await o.json();console.log("✅ Received star chart API data:",e),c(e)}else console.log("Star chart API response not OK, status:",o.status),c({guidances:[{title:"遷移宮聯動",analysis:"女方丙午火時柱與男方庚子水時柱形成水火既濟格局，火暖寒水創造強烈吸引力，但子午相沖易導致時差煩躁與溝通延遲。",impact:"通訊時間差異容易引發誤解，火急水緩的節奏不同造成情感表達錯位。",solution:"建議選擇午時（11-13點）或戌時（19-21點）進行重要溝通，避開子時深夜通話。",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"夫妻宮信號",analysis:"女方寅木日支渴望溫暖表達與情感滋養，男方申金月支偏向理性克制與邏輯思維，寅申相沖形成情感需求的根本差異。",impact:"視頻通話中容易因表達方式差異產生爭吵，木氣敏感遇金氣直接易受傷。",solution:"建議通話前先進行文字預熱，女方表達更簡潔，男方回應更溫暖，避開申時（15-17點）敏感時段。",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"關鍵法則",analysis:"雙方星盤呈現火水木金的複雜互動，既有相生吸引也有相沖挑戰，核心問題在於溝通節奏與表達方式的差異。",impact:"溝通障礙主要源於時間選擇不當與情感表達模式不匹配，需要精準的時機把握。",solution:"利用木氣日（周四）進行深度交流，避開金水日（周六）討論敏感話題，雙方協調表達強度與回應溫度。",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"}],keyPrinciples:"根據你們的星盤配置，火水相濟帶來激情但需要調和節奏，木金相沖要求精準時機選擇。建議女方在表達時更加柔和漸進，男方在回應時更加溫暖主動。選擇合適的溝通時段與表達方式，化沖突為互補，讓星盤能量為感情服務而非製造障礙。"})}catch(e){console.error("Star Chart Guidance generation failed:",e);"AbortError"===e.name?console.log("⚠️ Star Chart API call was aborted"):null===(r=e.message)||void 0===r||r.includes("timeout"),c({guidances:[{title:"時柱能量分析",analysis:"根據你們的時柱配置，存在火水相遇的強烈化學反應，這種對比創造吸引力但也帶來溝通節奏的差異。",impact:"不同的生理時鐘與表達習慣容易造成溝通時機錯失，影響情感交流的深度與效果。",solution:"建議選擇雙方都精神狀態良好的時段進行深度對話，避開疲憊或情緒低潮期。",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"情感宮位解讀",analysis:"日支月支的互動顯示你們在情感表達與接受方式上存在根本性差異，需要更多的理解與適應。",impact:"表達方式的不匹配可能導致情感傳遞失真，產生不必要的誤解與爭執。",solution:"學習對方的情感語言，調整自己的表達方式，用對方能理解的方式傳達愛意。",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"和諧共振法則",analysis:"你們的星盤配置既有互補優勢也有沖突挑戰，關鍵在於如何發揮優勢化解劣勢。",impact:"未善用星盤優勢會讓溝通變得困難，但正確運用則能讓感情更加深厚穩固。",solution:"根據每日五行能量調整溝通策略，在適合的時機討論重要話題，避開容易產生衝突的時段。",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"}],keyPrinciples:"星盤指引的核心在於順應天時地利人和，了解彼此的能量週期與表達特質。建議在溝通中保持彈性，善用星象優勢，化解天然衝突，讓宇宙能量成為你們感情的助力而非阻力。"})}finally{d(!1)}};return o?(0,s.jsx)("div",{className:"w-full p-8 bg-white rounded-[30px] shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-6 h-6 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"生成星盤指引中..."})]})}):r?(0,s.jsxs)("div",{className:"w-full bg-white rounded-[30px] shadow-lg p-8",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)("h3",{className:"font-bold text-[#C74772]",style:{fontSize:"42px",fontFamily:"Noto Serif TC, serif"},children:"宮位能量解析"})}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 mb-8 lg:grid-cols-3",children:null===(t=r.guidances)||void 0===t?void 0:t.map((e,t)=>(0,s.jsxs)("div",{className:"space-y-4 bg-[#EFEFEF] p-6 rounded-lg",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("div",{className:"inline-block px-6 py-3 text-base font-bold text-white rounded-full",style:{background:e.gradient,fontFamily:"Noto Serif TC, serif"},children:e.title})}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex items-center justify-center flex-shrink-0 w-6 h-6 mt-1 mr-3 text-xs font-bold text-white rounded-full",style:{background:"linear-gradient(135deg, #8B5A8C 0%, #6B4423 100%)"},children:"析"}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-800",style:{fontFamily:"Noto Sans TC, sans-serif"},children:e.analysis})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex items-center justify-center flex-shrink-0 w-6 h-6 mt-1 mr-3 text-xs font-bold text-white rounded-full",style:{background:"linear-gradient(135deg, #C74772 0%, #8B1538 100%)"},children:"影"}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-800",style:{fontFamily:"Noto Sans TC, sans-serif"},children:e.impact})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex items-center justify-center flex-shrink-0 w-6 h-6 mt-1 mr-3 text-xs font-bold text-white rounded-full",style:{background:"linear-gradient(135deg, #D09900 0%, #B87503 100%)"},children:"解"}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-800",style:{fontFamily:"Noto Sans TC, sans-serif"},children:e.solution})]})]})]},t))}),(0,s.jsxs)("div",{className:"p-6 border border-purple-200 rounded-lg bg-gradient-to-r from-purple-50 to-amber-50",children:[(0,s.jsxs)("div",{className:"flex items-center mb-3",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-8 h-8 mr-3 rounded-full bg-gradient-to-r from-purple-500 to-amber-500",children:(0,s.jsx)("span",{className:"text-sm font-bold text-white",children:"★"})}),(0,s.jsx)("h4",{className:"text-lg font-bold text-purple-700",style:{fontFamily:"Noto Serif TC, serif"},children:"核心指引法則"})]}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-700 ml-11",style:{fontFamily:"Noto Sans TC, sans-serif"},children:r.keyPrinciples})]})]}):null},A=e=>{var t;let{femaleUser:n,maleUser:l,analysisData:i}=e,[r,c]=(0,a.useState)(null),[o,d]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=!0;return n&&l&&i&&e&&m(),()=>{e=!1}},[n,l,i]);let m=async()=>{var e,t,s,a,r;d(!0),console.log("✦ Starting Feng Shui Transformation generation...",{femaleUser:null==n?void 0:n.name,maleUser:null==l?void 0:l.name,hasAnalysisData:!!i});try{let r={femaleUser:n,maleUser:l,femaleBazi:null==i?void 0:null===(e=i.female)||void 0===e?void 0:e.bazi,maleBazi:null==i?void 0:null===(t=i.male)||void 0===t?void 0:t.bazi,femalePillars:null==i?void 0:null===(s=i.female)||void 0===s?void 0:s.pillars,malePillars:null==i?void 0:null===(a=i.male)||void 0===a?void 0:a.pillars,requestType:"feng_shui_transformation"};console.log("\uD83D\uDCE4 Sending feng shui transformation request body:",r);let o=await fetch("/api/feng-shui-transformation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(console.log("\uD83D\uDCE5 Feng shui transformation response status:",o.status,o.ok),o.ok){let e=await o.json();console.log("✅ Received feng shui transformation API data:",e),c(e)}else console.log("Feng shui transformation API response not OK, status:",o.status),c({transformations:[{title:"臥室能量淨化佈局",steps:["在床頭兩側各放置白水晶簇，每週用流水沖洗5分鐘淨化","更換寢具為淺米色或淡粉色系，材質選用天然棉麻","每晚睡前點燃檀香木線香15分鐘（注意通風）"],principle:"透過水晶淨化負能量，暖色系寢具增強情感流動，檀香木屬火能溫暖關係氣場，適合多數情侶快速改善睡眠品質與親密感",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"客廳明堂引氣法",steps:["在客廳東南方位放置圓葉綠植（如金錢樹），每週二澆水9滴","電視櫃上方懸掛雙鯉魚戲珠圖（魚頭朝向室內）","茶几常年擺放陶瓷果盤（需保持有新鮮水果）"],principle:"東方屬木助情緣發展，圓葉植物聚氣，雙鯉魚象徵成雙成對，陶瓷土元素穩定關係，水果木氣生發創造生機流動",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"廚房水火既濟陣",steps:["灶台旁貼紅色防油貼紙（尺寸需為3的倍數）","水槽與灶台間放置黃色隔熱墊（材質選陶土或石材）","每日燒開水時加入3片新鮮薄荷葉"],principle:"紅色加強火元素能量，黃色土元素調和水火相剋，薄荷木氣疏通氣場，特別針對容易因生活瑣事爭執的情侶關係",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"玄關貴人引動局",steps:["門內側鋪設灰色地墊（下埋五帝錢複製品）","鞋櫃頂部放置雙數水晶天鵝擺件（頭部朝向大門）","每週五更換鮮花（避開帶刺品種）"],principle:"玄關為氣場入口，灰色地墊穩定氣場，水晶天鵝提升貴人運，定期更換鮮花保持生機，整體提升感情運勢",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"}],actionPrinciple:"本方案以「木火通明」為主軸（木生火增強熱情），輔以土元素穩定（陶瓷/石材調和）、金水元素為輔（淨化與流通）。透過居家四大關鍵區域的氣場聯動，可在7日內感知情緒緩和，21天形成良性能量循環，特別適合需要加強溝通與信任基礎的情侶關係。"})}catch(e){console.error("Feng Shui Transformation generation failed:",e);"AbortError"===e.name||null===(r=e.message)||void 0===r||r.includes("timeout"),c({transformations:[{title:"臥室和諧能量場",steps:["在床頭放置成對的粉水晶，增強愛情運勢","使用暖色系床單（粉紅、淺黃），提升溫暖氛圍","每晚點燃薰衣草精油，促進情感交流"],principle:"根據你們的八字配置，需要增強火土元素來平衡過旺的金水，創造溫暖穩定的感情基礎",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"客廳溝通增進陣",steps:["在客廳中央放置圓形茶几，促進能量流動","四角各放一盆綠植，啟動木氣生發","牆上掛暖色系畫作，激活火元素"],principle:"木生火的循環增強溝通能量，圓形茶几象徵圓滿，化解你們關係中的尖銳衝突",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"廚房財運情運雙修法",steps:["在廚房東側放置黃色花朵（如向日葵）","使用木質餐具，增強木火相生","共同下廚時播放輕快音樂"],principle:"廚房屬火，配合木元素可以生旺財運與感情，讓你們在共同活動中增進默契",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"}],actionPrinciple:"這些風水調整針對你們的八字特質設計，重點在於平衡五行能量，創造有利於感情發展的環境氣場。建議優先從臥室開始調整，再逐步完善其他空間，持續執行將看到明顯的關係改善效果。"})}finally{d(!1)}};return o?(0,s.jsx)("div",{className:"w-full p-8 bg-white rounded-[30px] shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-6 h-6 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"生成風水轉化方案中.."})]})}):r?(0,s.jsxs)("div",{className:"w-full bg-white rounded-[30px] shadow-lg p-8",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)("h3",{className:"font-bold text-[#C74772]",style:{fontSize:"42px",fontFamily:"Noto Serif TC, serif"},children:"行動方案"})}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 mb-8 lg:grid-cols-2",children:null===(t=r.transformations)||void 0===t?void 0:t.map((e,t)=>{var n;return(0,s.jsxs)("div",{className:"space-y-4 bg-[#EFEFEF] p-6 rounded-lg",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{className:"inline-block px-6 py-3 text-base font-bold text-white rounded-full",style:{background:e.gradient,fontFamily:"Noto Serif TC, serif"},children:["✦ ",e.title]})}),(0,s.jsx)("div",{className:"space-y-3",children:null===(n=e.steps)||void 0===n?void 0:n.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex items-center justify-center flex-shrink-0 w-6 h-6 mt-1 mr-3 text-sm font-bold text-white rounded-full",style:{background:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},children:t+1}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-800",style:{fontFamily:"Noto Sans TC, sans-serif"},children:e})]},t))}),(0,s.jsx)("div",{className:"p-3 mt-4 border-l-4 border-orange-400 rounded-lg bg-gradient-to-r from-orange-50 to-yellow-50",children:(0,s.jsx)("p",{className:"text-xs font-medium text-center text-orange-700",style:{fontFamily:"Noto Sans TC, sans-serif"},children:e.principle})})]},t)})}),(0,s.jsxs)("div",{className:"p-6 border rounded-lg bg-gradient-to-r from-amber-50 to-orange-50 border-amber-200",children:[(0,s.jsxs)("div",{className:"flex items-center mb-3",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-8 h-8 mr-3 rounded-full bg-gradient-to-r from-amber-500 to-orange-500",children:(0,s.jsx)("span",{className:"text-sm font-bold text-white",children:"✦"})}),(0,s.jsx)("h4",{className:"text-lg font-bold text-amber-700",style:{fontFamily:"Noto Serif TC, serif"},children:"轉化原理"})]}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-700 ml-11",style:{fontFamily:"Noto Sans TC, sans-serif"},children:r.actionPrinciple})]})]}):null},D=e=>{var t;let{femaleUser:n,maleUser:l,analysisData:i}=e,[r,c]=(0,a.useState)(null),[o,d]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=!0;return n&&l&&i&&e&&m(),()=>{e=!1}},[n,l,i]);let m=async()=>{var e,t,s,a,r;d(!0),console.log("\uD83D\uDCAB Starting Relationship Method generation...",{femaleUser:null==n?void 0:n.name,maleUser:null==l?void 0:l.name,hasAnalysisData:!!i});try{let r={femaleUser:n,maleUser:l,femaleBazi:null==i?void 0:null===(e=i.female)||void 0===e?void 0:e.bazi,maleBazi:null==i?void 0:null===(t=i.male)||void 0===t?void 0:t.bazi,femalePillars:null==i?void 0:null===(s=i.female)||void 0===s?void 0:s.pillars,malePillars:null==i?void 0:null===(a=i.male)||void 0===a?void 0:a.pillars,requestType:"relationship_method"};console.log("\uD83D\uDCE4 Sending relationship method request body:",r);let o=await fetch("/api/relationship-method",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(console.log("\uD83D\uDCE5 Relationship method response status:",o.status,o.ok),o.ok){let e=await o.json();console.log("✅ Received relationship method API data:",e),c(e)}else console.log("Relationship method API response not OK, status:",o.status),c({dailyRituals:[{title:"晨光能量同頻儀式",steps:["每日清晨6:30-7:00，面向東方站立3分鐘，深呼吸調息","輪流分享昨夜夢境或今日期待，時間各限2分鐘","以雙手交握結束，默念「木氣生發，愛意流轉」三次"],principle:"利用晨光木氣上升時刻，透過金生水→水生木的能量循環，調和你們八字中的沉寂氣場，重啟一日活力",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"午後土金平衡茶禪",steps:["下午3-4點選用陶瓷茶具（土），沖泡白茶或烏龍（金氣茶品）","無言靜坐品茶5分鐘，感受彼此存在能量","輪流說出對方今日一個優點，用「我感謝你...」開頭"],principle:"午後土金時段最適合穩定關係能量，透過土生金→金生水循環，化解你們過度理性的溝通模式",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"夜晚水火調和儀式",steps:["睡前點燃紅色蠟燭（火元素），旁邊放置水晶球（水元素）","相視而坐，輪流說出今日最困擾與最開心的事各一件","以溫暖擁抱結束，心中默念「水火既濟，情深意長」"],principle:"夜晚水氣旺盛配合火光，形成水火既濟卦象，專門針對你們八字能量沉寂核心進行深度調和",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"}],communicationAdvice:"基於你們的八字分析，建議增加「元素感受日」活動（每週選一天專注體驗某種五行元素），調整表達方式為「先讚美後建議」模式，建立每晚「感恩三件事」分享習慣。重點是透過規律儀式打破能量沉寂，用溫和方式重建情感連結，讓關係在穩定中逐步升溫。"})}catch(e){console.error("Relationship Method generation failed:",e);"AbortError"===e.name||null===(r=e.message)||void 0===r||r.includes("timeout"),c({dailyRituals:[{title:"清晨共鳴儀式",steps:["每日早晨面向東方，一起深呼吸調息3分鐘","輪流分享夢境或當日期待，各限時2分鐘","雙手相握默念正向話語，啟動一日能量"],principle:"運用清晨木氣上升，透過金生水能量循環，調和八字中的沉寂氣場，重啟關係活力",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"午後靜心茶會",steps:["下午時光使用陶瓷茶具沖泡淡雅茶品","靜坐品茶5分鐘，感受彼此能量交流","分享對方優點，用感謝話語表達"],principle:"午後土金時段穩定關係能量，土生金循環化解過度理性溝通，增進感情溫度",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"夜晚和諧儀式",steps:["睡前點燃蠟燭營造溫暖氛圍","分享當日感受，包含困擾與開心事項","溫暖擁抱結束，心念感恩話語"],principle:"夜晚水火調和，形成既濟格局，針對能量沉寂核心進行深度平衡調整",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"}],communicationAdvice:"根據八字特質，建議建立「元素體驗日」（每週專注一種五行元素），採用「先肯定後建議」的溝通模式，養成每晚感恩分享習慣。透過規律儀式化解能量沉寂，用溫和方式重建情感連結，在穩定基礎上逐步提升關係溫度。"})}finally{d(!1)}};return o?(0,s.jsx)("div",{className:"w-full p-8 bg-white rounded-[30px] shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-6 h-6 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"生成相處心法中.."})]})}):r?(0,s.jsxs)("div",{className:"w-full bg-white rounded-[30px] shadow-lg p-8",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)("h3",{className:"font-bold text-[#C74772]",style:{fontSize:"42px",fontFamily:"Noto Serif TC, serif"},children:"關係升級提示"})}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 mb-8 lg:grid-cols-3",children:null===(t=r.dailyRituals)||void 0===t?void 0:t.map((e,t)=>{var n;return(0,s.jsxs)("div",{className:"space-y-4 bg-[#EFEFEF] p-6 rounded-lg",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{className:"inline-block px-6 py-3 text-base font-bold text-white rounded-full",style:{background:e.gradient,fontFamily:"Noto Serif TC, serif"},children:["▸ ",e.title]})}),(0,s.jsx)("div",{className:"space-y-3",children:null===(n=e.steps)||void 0===n?void 0:n.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex items-center justify-center flex-shrink-0 w-6 h-6 mt-1 mr-3 text-sm font-bold text-white rounded-full",style:{background:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},children:t+1}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-800",style:{fontFamily:"Noto Sans TC, sans-serif"},children:e})]},t))}),(0,s.jsx)("div",{className:"p-3 mt-4 border-red-400 rounded-lg bg-gradient-to-r from-red-50 to-yellow-50",children:(0,s.jsx)("p",{className:"text-xs font-medium text-center text-red-700",style:{fontFamily:"Noto Sans TC, sans-serif"},children:e.principle})})]},t)})})]}):null},k=e=>{let{femaleUser:t,maleUser:n,analysisData:l}=e,[i,r]=(0,a.useState)(null),[c,o]=(0,a.useState)(!1),[d,m]=(0,a.useState)("fiveElements");(0,a.useEffect)(()=>{let e=!0;return t&&n&&l&&e&&u(),()=>{e=!1}},[t,n,l]);let u=async()=>{o(!0),console.log("\uD83D\uDD0D Starting Key Analysis generation...",{femaleUser:null==t?void 0:t.name,maleUser:null==n?void 0:n.name,hasAnalysisData:!!l});try{var e,s,a,i;let c={femaleUser:t,maleUser:n,femaleBazi:null==l?void 0:null===(e=l.female)||void 0===e?void 0:e.bazi,maleBazi:null==l?void 0:null===(s=l.male)||void 0===s?void 0:s.bazi,femalePillars:null==l?void 0:null===(a=l.female)||void 0===a?void 0:a.pillars,malePillars:null==l?void 0:null===(i=l.male)||void 0===i?void 0:i.pillars,requestType:"key_analysis"};console.log("\uD83D\uDCE4 Sending key analysis request body:",c);let o=await fetch("/api/key-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(console.log("\uD83D\uDCE5 Key analysis response status:",o.status,o.ok),o.ok){let e=await o.json();console.log("✅ Received key analysis API data:",e),r(e)}else console.log("Key analysis API response not OK, status:",o.status),r({fiveElementsCompatibility:{female:{dayMaster:"壬水",description:"您的八字以壬水日主為核心，具有靈活變通的特質。命中若缺木元素，在感情中可能顯得過於理性或缺乏溫暖表達。建議透過增加綠色植物、木質傢具等方式補充木氣，有助提升溫柔包容力。您的感性一面需要透過藝術創作或自然接觸來喚醒，這樣能讓伴侶感受到更多情感層次。"},male:{dayMaster:"癸水",description:"您以癸水日主為命格基礎，天性溫和內斂，富有同情心。八字中若木氣充足（如甲木透干），能有效疏通土性的僵局，為關係帶來創造力與靈活性。您在感情中扮演調和者角色，善於化解矛盾。建議保持這種平衡特質，同時在關鍵時刻展現更多主導力，讓伴侶感受到您的堅定支持。"},overallEnergy:"火土強 vs. 金水旺",complementarity:"金水調和火土，形成流通",essence:"能量互補而非不平衡",icons:{female:"\uD83C\uDF0A",male:"\uD83D\uDCA7",compatibility:"⚖️"}},spouseStarStatus:{userStatus:"女方夫星：若正官為戊土且坐寅木長生位（如戊寅日），象徵配偶具成長性與責任感，在事業與家庭間能找到平衡。若逢天乙貴人（如乙木），更強化婚姻穩定性，代表伴侶能在關鍵時刻提供智慧指導。這種配置顯示您的伴侶具有長期發展潛力，且能在關係中承擔應有責任。",partnerConfiguration:"男方妻星：正財為己土卻與日支未土相刑（如己未日），可能在價值觀與金錢使用上產生摩擦，特別是對於生活品質標準的不同看法。然而，若女方八字帶酉金（如乙酉時），金能通關土刑，將原本的衝突轉化為互助動力。這種配置需要雙方在財務規劃上多溝通，建立共同目標。",analysis:"整體而言，你們的夫妻星配置顯示雙方都具備長期承諾的特質，男方的責任感與女方的理財能力可以形成良好互補。需要注意的是在價值觀磨合期要保持耐心，透過五行調和的方式（如共同參與土元素活動，或在居家環境中加入金屬元素）來緩解潛在摩擦。",recommendation:"建議加強土元素穩定性，在家中西南方位放置陶瓷擺件，同時減少相刑影響，可透過金元素調和，如佩戴白色或金屬飾品。"},attentionNeededConfigurations:{potentialIssues:["食神制殺導致要求過高","劫財旺影響金錢觀念","水過旺容易情緒波動"],description:"易放大矛盾，但視為可調整的能量點",adjustmentApproach:"通過五行調和平衡能量流動"}})}catch(e){console.error("Key Analysis generation failed:",e),r({fiveElementsCompatibility:{female:{dayMaster:"壬水",description:"您的八字以壬水日主為核心，具有靈活變通的特質。命中若缺木元素，在感情中可能顯得過於理性或缺乏溫暖表達。建議透過增加綠色植物、木質傢具等方式補充木氣，有助提升溫柔包容力。您的感性一面需要透過藝術創作或自然接觸來喚醒，這樣能讓伴侶感受到更多情感層次。"},male:{dayMaster:"癸水",description:"您以癸水日主為命格基礎，天性溫和內斂，富有同情心。八字中若木氣充足（如甲木透干），能有效疏通土性的僵局，為關係帶來創造力與靈活性。您在感情中扮演調和者角色，善於化解矛盾。建議保持這種平衡特質，同時在關鍵時刻展現更多主導力，讓伴侶感受到您的堅定支持。"},overallEnergy:"火土強 vs. 金水旺",complementarity:"金水調和火土，形成流通",essence:"能量互補而非不平衡",icons:{female:"\uD83C\uDF0A",male:"\uD83D\uDCA7",compatibility:"⚖️"}},spouseStarStatus:{userStatus:"女方夫星：若正官為戊土且坐寅木長生位（如戊寅日），象徵配偶具成長性與責任感，在事業與家庭間能找到平衡。若逢天乙貴人（如乙木），更強化婚姻穩定性，代表伴侶能在關鍵時刻提供智慧指導。這種配置顯示您的伴侶具有長期發展潛力，且能在關係中承擔應有責任。",partnerConfiguration:"男方妻星：正財為己土卻與日支未土相刑（如己未日），可能在價值觀與金錢使用上產生摩擦，特別是對於生活品質標準的不同看法。然而，若女方八字帶酉金（如乙酉時），金能通關土刑，將原本的衝突轉化為互助動力。這種配置需要雙方在財務規劃上多溝通，建立共同目標。",analysis:"整體而言，你們的夫妻星配置顯示雙方都具備長期承諾的特質，男方的責任感與女方的理財能力可以形成良好互補。需要注意的是在價值觀磨合期要保持耐心，透過五行調和的方式（如共同參與土元素活動，或在居家環境中加入金屬元素）來緩解潛在摩擦。",recommendation:"建議加強土元素穩定性，在家中西南方位放置陶瓷擺件，同時減少相刑影響，可透過金元素調和，如佩戴白色或金屬飾品。"},attentionNeededConfigurations:{potentialIssues:["食神制殺導致要求過高","劫財旺影響金錢觀念","水過旺容易情緒波動"],description:"易放大矛盾，但視為可調整的能量點",adjustmentApproach:"通過五行調和平衡能量流動"}})}finally{o(!1)}};return c?(0,s.jsx)("div",{className:"w-full p-8 bg-white rounded-[30px] shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-6 h-6 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"生成關鍵分析中..."})]})}):i?(0,s.jsx)("div",{className:"w-full bg-white rounded-[30px] shadow-lg p-8",children:(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("div",{className:"flex justify-center gap-10 mb-6 space-x-8",children:[{id:"fiveElements",label:"五行互補性",image:"/images/report/fengshui.png",selectedBg:"bg-gradient-to-r from-green-400 to-blue-500",unselectedBg:"bg-[#EFEFEF]"},{id:"spouseStar",label:"夫星狀態",image:"/images/report/star.png",selectedBg:"bg-gradient-to-r from-yellow-400 to-orange-500",unselectedBg:"bg-[#EFEFEF]"},{id:"attention",label:"需注意的配置",image:"/images/report/personal-2.png",selectedBg:"bg-[#A53860]",unselectedBg:"bg-[#EFEFEF]"}].map(e=>(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:"w-20 h-20 rounded-full flex items-center justify-center mb-3 cursor-pointer transition-all duration-300 ".concat(d===e.id?e.selectedBg:e.unselectedBg),onClick:()=>m(e.id),children:(0,s.jsx)("img",{src:e.image,alt:e.label,className:"w-10 h-10 transition-all duration-300 ".concat(d===e.id?"filter brightness-0 invert":"")})}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.label})]},e.id))}),"fiveElements"===d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 mb-6 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"p-6 border border-pink-200 rounded-lg bg-gradient-to-r from-pink-50 to-red-50",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h4",{className:"font-bold text-[#C74772] text-xl",style:{fontFamily:"Noto Serif TC, serif"},children:"女方"}),(0,s.jsx)("div",{className:"px-4 py-2 bg-white border-2 border-[#C74772] rounded-full",children:(0,s.jsx)("span",{className:"text-sm font-medium text-[#C74772]",children:i.fiveElementsCompatibility.female.dayMaster})})]}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-700",style:{fontFamily:"Noto Sans TC, sans-serif"},children:i.fiveElementsCompatibility.female.description})]}),(0,s.jsxs)("div",{className:"p-6 border border-blue-200 rounded-lg bg-gradient-to-r from-blue-50 to-indigo-50",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h4",{className:"font-bold text-[#C74772] text-xl",style:{fontFamily:"Noto Serif TC, serif"},children:"男方"}),(0,s.jsx)("div",{className:"px-4 py-2 bg-white border-2 border-[#C74772] rounded-full",children:(0,s.jsx)("span",{className:"text-sm font-medium text-[#C74772]",children:i.fiveElementsCompatibility.male.dayMaster})})]}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-700",style:{fontFamily:"Noto Sans TC, sans-serif"},children:i.fiveElementsCompatibility.male.description})]})]}),(0,s.jsxs)("div",{className:"p-6 border rounded-lg bg-gradient-to-r from-amber-50 to-yellow-50 border-amber-200",children:[(0,s.jsx)("h5",{className:"mb-3 text-lg font-bold text-amber-700",children:"能量互補分析"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"整體能量："}),i.fiveElementsCompatibility.overallEnergy]}),(0,s.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"互補性："}),i.fiveElementsCompatibility.complementarity]}),(0,s.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"本質："}),i.fiveElementsCompatibility.essence]})]})]})]}),"spouseStar"===d&&(0,s.jsx)("div",{className:"p-6 border border-purple-200 rounded-lg bg-gradient-to-r from-purple-50 to-indigo-50",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-purple-700",children:"用戶配置："}),(0,s.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:i.spouseStarStatus.userStatus})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-purple-700",children:"伴侶配置："}),(0,s.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:i.spouseStarStatus.partnerConfiguration})]}),(0,s.jsx)("div",{className:"p-4 bg-white border border-purple-100 rounded-lg",children:(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-700",children:i.spouseStarStatus.analysis})})]})}),"attention"===d&&(0,s.jsx)("div",{className:"p-6 border border-red-200 rounded-lg bg-gradient-to-r from-red-50 to-orange-50",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"mb-3 font-medium text-red-700",children:"潛在細節："}),(0,s.jsx)("div",{className:"space-y-2",children:i.attentionNeededConfigurations.potentialIssues.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-2 h-2 mt-2 mr-3 bg-red-500 rounded-full"}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:e})]},t))})]}),(0,s.jsxs)("div",{className:"p-4 bg-white border border-red-100 rounded-lg",children:[(0,s.jsx)("p",{className:"mb-2 text-sm leading-relaxed text-gray-700",children:i.attentionNeededConfigurations.description}),(0,s.jsxs)("p",{className:"text-sm font-medium text-red-600",children:["調整方式：",i.attentionNeededConfigurations.adjustmentApproach]})]})]})})]})}):null},T=e=>{var t,n,l,i,r,c,o,d,m,u,g,h;let{femaleUser:x,maleUser:p,analysisData:f}=e,[b,y]=(0,a.useState)(null),[v,j]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=!0;return x&&p&&f&&e&&N(),()=>{e=!1}},[x,p,f]);let N=async()=>{j(!0),console.log("\uD83C\uDFAF Starting Targeted Suggestions generation...",{femaleUser:null==x?void 0:x.name,maleUser:null==p?void 0:p.name,hasAnalysisData:!!f});try{var e,t,n,s;let a={femaleUser:x,maleUser:p,femaleBazi:null==f?void 0:null===(e=f.female)||void 0===e?void 0:e.bazi,maleBazi:null==f?void 0:null===(t=f.male)||void 0===t?void 0:t.bazi,femalePillars:null==f?void 0:null===(n=f.female)||void 0===n?void 0:n.pillars,malePillars:null==f?void 0:null===(s=f.male)||void 0===s?void 0:s.pillars,requestType:"targeted_suggestions"};console.log("\uD83D\uDCE4 Sending targeted suggestions request body:",a);let l=await fetch("/api/targeted-suggestions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(console.log("\uD83D\uDCE5 Targeted suggestions response status:",l.status,l.ok),l.ok){let e=await l.json();console.log("✅ Received targeted suggestions API data:",e),y(e)}else console.log("Targeted suggestions API response not OK, status:",l.status),y(w())}catch(e){console.error("Targeted Suggestions generation failed:",e),y(w())}finally{j(!1)}},w=()=>({elementBalance:{title:"增強特定元素平衡（如土元素穩定官星）",description:"提供實用方法（如佩戴黃玉手鏈，或在臥室放陶瓷暖光燈）",methods:[{icon:"\uD83D\uDC8E",title:"佩戴黃玉手鏈",description:"選擇天然黃玉材質，增強土元素能量，穩定官星配置，建議戴在左手以接收正面能量。"},{icon:"\uD83C\uDFEE",title:"臥室陶瓷暖光燈",description:"在臥室西南方（土位）放置陶瓷材質的暖光燈具，每晚點亮30分鐘以上，強化土氣穩定性。"}]},communicationTransformation:{title:"轉化溝通模式",description:"當能量過旺時，用互補方式疏導（如共同烹飪溫性食物，中和寒涼）",methods:[{icon:"\uD83C\uDF72",title:"共同烹飪溫性食物",description:"定期一起準備薑汁紅糖茶、桂圓紅棗湯等溫性食材，在烹飪過程中增進溝通，以食物的溫和屬性中和情緒的寒涼。"},{icon:"\uD83C\uDF31",title:"協調五行活動",description:"根據雙方八字特點選擇平衡活動，如土旺者適合園藝，水旺者適合書法，互相參與對方擅長的領域。"}]},anchorRitual:{title:"心錨儀式",description:"推薦每日行動，如雙手按小腹默念肯定語（如'土厚載物，水火既濟'），強化包容力",methods:[{icon:"\uD83D\uDE4F",title:"晨間冥想儀式",description:"每日清晨雙手輕按小腹（丹田位置），緩慢深呼吸，默念'土厚載物，水火既濟'三遍，建立內在穩定感。"},{icon:"\uD83D\uDCAB",title:"睡前肯定語",description:"就寢前進行相同動作，改念'包容如海，穩如泰山'，強化對伴侶的理解與接納能力。"}]},energyValidationCase:{title:"能量印證案例",description:"分享類似配置案例（如女火土旺/男金水旺夫妻），經過調整後轉化為正面成果",caseStudy:{configuration:"女火土旺 / 男金水旺",initialChallenge:"初期因五行差異導致溝通模式不同，女方直接熱情，男方內斂理性，容易產生誤解。",adjustmentProcess:"透過居家佈置調整（客廳增加金屬風鈴、臥室放置綠色植物）以及行為調和（女方學習傾聽技巧、男方表達情感需求），逐步建立互補節奏。",positiveOutcome:"六個月後，男方的理性思維幫助女方事業決策更加穩健，事業營收提升40%；女方的熱情活力激發男方創意靈感，共同開發的項目獲得市場認可。",keyInsight:"將五行差異轉化為創造力，而非對立力量。"}}});return v?(0,s.jsx)("div",{className:"w-full p-8 bg-white rounded-[30px] shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-6 h-6 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"生成針對性建議中..."})]})}):b?(0,s.jsxs)("div",{className:"w-full bg-[#F5F5F5] rounded-[30px] shadow-lg p-8",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)("div",{className:"flex items-center mb-4",children:(0,s.jsx)("h3",{className:"font-bold text-[#C74772]",style:{fontSize:"42px",fontFamily:"Noto Serif TC, serif"},children:'破除"克"的焦慮'})})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 mb-8 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"bg-[#A5385C] rounded-[20px] p-6 text-white",children:[(0,s.jsx)("h4",{className:"mb-3 text-lg font-bold",style:{fontFamily:"Noto Serif TC, serif"},children:(null==b?void 0:null===(t=b.elementBalance)||void 0===t?void 0:t.title)||"增強特定元素平衡"}),(0,s.jsx)("p",{className:"mb-4 text-sm opacity-90",children:(null==b?void 0:null===(n=b.elementBalance)||void 0===n?void 0:n.description)||"提供實用方法增強元素平衡"}),(0,s.jsx)("div",{className:"space-y-3",children:(null==b?void 0:null===(i=b.elementBalance)||void 0===i?void 0:null===(l=i.methods)||void 0===l?void 0:l.map((e,t)=>(0,s.jsx)("div",{className:"p-3 text-black bg-white rounded-lg bg-opacity-20",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("span",{className:"mr-2 text-lg",children:(null==e?void 0:e.icon)||"\uD83D\uDC8E"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"mb-1 text-sm font-medium",children:(null==e?void 0:e.title)||"建議方法"}),(0,s.jsx)("p",{className:"text-xs leading-relaxed opacity-90",children:(null==e?void 0:e.description)||"具體實施建議"})]})]})},t)))||[]})]}),(0,s.jsxs)("div",{className:"bg-[#A5385C] rounded-[20px] p-6 text-white",children:[(0,s.jsx)("h4",{className:"mb-3 text-lg font-bold",style:{fontFamily:"Noto Serif TC, serif"},children:(null==b?void 0:null===(r=b.communicationTransformation)||void 0===r?void 0:r.title)||"轉化溝通模式"}),(0,s.jsx)("p",{className:"mb-4 text-sm opacity-90",children:(null==b?void 0:null===(c=b.communicationTransformation)||void 0===c?void 0:c.description)||"當能量過旺時，用互補方式疏導"}),(0,s.jsx)("div",{className:"space-y-3",children:(null==b?void 0:null===(d=b.communicationTransformation)||void 0===d?void 0:null===(o=d.methods)||void 0===o?void 0:o.map((e,t)=>(0,s.jsx)("div",{className:"p-3 text-black bg-white rounded-lg bg-opacity-20",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("span",{className:"mr-2 text-lg",children:(null==e?void 0:e.icon)||"\uD83C\uDF72"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"mb-1 text-sm font-medium",children:(null==e?void 0:e.title)||"溝通方法"}),(0,s.jsx)("p",{className:"text-xs leading-relaxed opacity-90",children:(null==e?void 0:e.description)||"具體溝通建議"})]})]})},t)))||[]})]}),(0,s.jsxs)("div",{className:"bg-[#A5385C] rounded-[20px] p-6 text-white",children:[(0,s.jsx)("h4",{className:"mb-3 text-lg font-bold",style:{fontFamily:"Noto Serif TC, serif"},children:(null==b?void 0:null===(m=b.anchorRitual)||void 0===m?void 0:m.title)||"心錨儀式"}),(0,s.jsx)("p",{className:"mb-4 text-sm opacity-90",children:(null==b?void 0:null===(u=b.anchorRitual)||void 0===u?void 0:u.description)||"每日雙手按小腹默念肯定語，強化包容力"}),(0,s.jsx)("div",{className:"space-y-3",children:(null==b?void 0:null===(h=b.anchorRitual)||void 0===h?void 0:null===(g=h.methods)||void 0===g?void 0:g.map((e,t)=>(0,s.jsx)("div",{className:"p-3 text-black bg-white rounded-lg bg-opacity-20",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("span",{className:"mr-2 text-lg",children:(null==e?void 0:e.icon)||"\uD83D\uDE4F"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"mb-1 text-sm font-medium",children:(null==e?void 0:e.title)||"心錨方法"}),(0,s.jsx)("p",{className:"text-xs leading-relaxed opacity-90",children:(null==e?void 0:e.description)||"具體儀式建議"})]})]})},t)))||[]})]})]})]}):null},B=e=>{var t,n,l;let{user1:i,user2:r,specificProblem:c}=e,{analysisData:o}=m(),[d,u]=(0,a.useState)(null),[g,h]=(0,a.useState)(!1),[x,f]=(0,a.useState)(null),b=(null==i?void 0:i.gender)==="female"?i:r,y=(null==i?void 0:i.gender)==="male"?i:r,v=(e,t)=>{var n;if(!(null==e?void 0:e.dayMasterElement)||!(null==t?void 0:t.dayMasterElement))return 75;let s=e.dayMasterElement,a=t.dayMasterElement;return(null===(n=({金:{金:70,木:40,水:85,火:35,土:80},木:{金:40,木:75,水:80,火:85,土:45},水:{金:85,木:80,水:70,火:30,土:50},火:{金:35,木:85,水:30,火:75,土:80},土:{金:80,木:45,水:50,火:80,土:70}})[s])||void 0===n?void 0:n[a])||60},j=(0,a.useMemo)(()=>{var e;if(null==o?void 0:null===(e=o.compatibility)||void 0===e?void 0:e.score){let e=parseInt(o.compatibility.score);return console.log("✅ Using context score (BEST approach):",e),e}if((null==b?void 0:b.birthDateTime)&&(null==y?void 0:y.birthDateTime))try{let e=w(b.birthDateTime,b.gender),t=w(y.birthDateTime,y.gender),n=v(e,t);return console.log("⚠️ Using calculated score (fallback):",n),n}catch(e){return console.error("Error calculating compatibility:",e),75}return console.log("❌ Using ultimate fallback score"),78},[b,y,null==o?void 0:null===(t=o.compatibility)||void 0===t?void 0:t.score]),N=e=>{if(!e)return"未提供";try{let t=new Date(e);return"".concat(t.getFullYear(),"年").concat(String(t.getMonth()+1).padStart(2,"0"),"月").concat(String(t.getDate()).padStart(2,"0"),"日").concat(String(t.getHours()).padStart(2,"0"),":").concat(String(t.getMinutes()).padStart(2,"0"))}catch(t){return e}};(0,a.useEffect)(()=>{c&&f(B(c))},[c]),(0,a.useEffect)(()=>{b&&y&&c&&P()},[b,y,c]);let B=e=>{if(!e)return null;let t=e.toLowerCase();return(console.log("\uD83D\uDD0D Categorizing problem:",e),console.log("\uD83D\uDD0D Problem lowercase:",t),t.includes("冷戰")||t.includes("降溫")||t.includes("疏遠")||t.includes("冷淡")||t.includes("感情淡")||t.includes("不理我"))?{category:"emotion_cooling",categoryName:"感情降溫類",color:"bg-pink-100 border-pink-300 text-pink-800",icon:"Heart"}:t.includes("異地")||t.includes("長距離")||t.includes("工作")||t.includes("家庭")||t.includes("父母")||t.includes("朋友")&&!t.includes("男朋友")&&!t.includes("女朋友")||t.includes("環境")||t.includes("壓力")?(console.log("\uD83D\uDCCD Matched 特殊情境類"),{category:"special_situation",categoryName:"特殊情境類",color:"bg-blue-100 border-blue-300 text-blue-800",icon:"Globe"}):t.includes("說錯話")||t.includes("話術")||t.includes("溝通")||t.includes("誤會")||t.includes("爭吵")||t.includes("口角")||t.includes("吵架")||t.includes("禁忌")?(console.log("\uD83D\uDCCD Matched 禁忌破解話術"),{category:"taboo_breaking",categoryName:"禁忌破解話術",color:"bg-purple-100 border-purple-300 text-purple-800",icon:"Shield"}):{category:"emotion_cooling",categoryName:"感情降溫類",color:"bg-pink-100 border-pink-300 text-pink-800",icon:"Heart"}},P=async()=>{h(!0);try{let e=await fetch("/api/couple-specific-problem-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({femaleUser:b,maleUser:y,specificProblem:c})});if(e.ok){let t=await e.json();u(t)}else try{let t=await e.json();if(t.female&&t.male)u(t);else throw Error("No valid data in response")}catch(t){throw Error("HTTP ".concat(e.status,": ").concat(e.statusText))}}catch(e){console.error("Analysis generation failed:",e),u({error:!0,message:"分析失敗: ".concat(e.message,". 請檢查網路連接或稍後重試。"),female:{birthDate:N(b.birthDateTime),bazi:"計算失敗",description:"無法生成分析，請稍後重試",pillars:["計算中...","計算中...","計算中...","計算中..."]},male:{birthDate:N(y.birthDateTime),bazi:"計算失敗",description:"無法生成分析，請稍後重試",pillars:["計算中...","計算中...","計算中...","計算中..."]}})}finally{h(!1)}};return g?(0,s.jsx)("div",{className:"w-full p-8 bg-white rounded-lg shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"正在分析您的專屬問題..."})]})}):(null==d?void 0:d.error)?(0,s.jsx)("div",{className:"w-full p-8 bg-white rounded-lg shadow-lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 text-red-500",children:(0,s.jsx)(p,{className:"w-full h-full"})}),(0,s.jsx)("h3",{className:"mb-2 text-lg font-semibold text-red-800",children:"分析失敗"}),(0,s.jsx)("p",{className:"mb-4 text-gray-600",children:d.message}),(0,s.jsx)("button",{onClick:()=>{u(null),P()},className:"px-6 py-2 text-white bg-pink-500 rounded-lg hover:bg-pink-600",children:"重新分析"})]})}):(0,s.jsxs)("div",{className:"w-full space-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-6 p-6 lg:flex-row",children:[(0,s.jsx)("div",{className:"flex items-center justify-center py-8 lg:w-1/3",children:(0,s.jsx)("div",{className:"relative",children:(0,s.jsxs)("div",{className:"relative w-80 h-80",children:[(0,s.jsxs)("svg",{className:"transform -rotate-90 w-80 h-80",viewBox:"0 0 100 100",children:[(0,s.jsx)("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"6"}),(0,s.jsx)("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"url(#gradient)",strokeWidth:"6",strokeLinecap:"round",strokeDasharray:"".concat(251.2*j/100," 251.2"),className:"transition-all duration-1000 ease-out"}),(0,s.jsx)("defs",{children:(0,s.jsxs)("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,s.jsx)("stop",{offset:"0%",stopColor:"#ec4899"}),(0,s.jsx)("stop",{offset:"50%",stopColor:"#f97316"}),(0,s.jsx)("stop",{offset:"100%",stopColor:"#eab308"})]})})]}),(0,s.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,s.jsx)("span",{className:"font-bold text-8xl text-amber-600",children:j}),(0,s.jsx)("span",{className:"mt-2 text-lg font-medium text-gray-600",children:(e=>e>=80?"優秀配對":e>=70?"良好配對":e>=60?"穩定配對":"需要努力")(j)})]})]})})}),(0,s.jsx)("div",{className:"flex flex-col gap-6 lg:w-2/3",children:d&&(0,s.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-[30px] shadow-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"px-6 py-4 bg-gradient-to-r from-pink-100 to-purple-100",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-bold text-[#C74772]",style:{fontSize:"36px",fontFamily:"Noto Serif TC, serif"},children:"您的八字"}),(0,s.jsx)("div",{className:"px-3 py-1 bg-white border-2 border-[#C74772] rounded-full",children:(0,s.jsx)("span",{className:"text-sm text-[#C74772]",children:d.female.birthDate})})]})}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:null===(n=d.female.pillars)||void 0===n?void 0:n.map((e,t)=>(0,s.jsx)("div",{className:"px-3 py-1 bg-white border border-[#DeaB20] rounded-full",children:(0,s.jsx)("span",{className:"text-sm font-medium text-[#6F5100]",children:e})},t))})}),(0,s.jsx)("div",{className:"text-sm leading-relaxed text-gray-700",children:d.female.description})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-[30px] shadow-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"px-6 py-4 bg-gradient-to-r from-blue-100 to-indigo-100",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-bold text-[#C74772]",style:{fontSize:"36px",fontFamily:"Noto Serif TC, serif"},children:"伴侶八字"}),(0,s.jsx)("div",{className:"px-3 py-1 bg-white border-2 border-[#C74772] rounded-full",children:(0,s.jsx)("span",{className:"text-sm text-[#C74772]",children:d.male.birthDate})})]})}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:null===(l=d.male.pillars)||void 0===l?void 0:l.map((e,t)=>(0,s.jsx)("div",{className:"px-3 py-1 bg-white border border-[#DeaB20] rounded-full",children:(0,s.jsx)("span",{className:"text-sm font-medium text-[#6F5100]",children:e})},t))})}),(0,s.jsx)("div",{className:"text-sm leading-relaxed text-gray-700",children:d.male.description})]})]})]})})]}),c&&x&&(0,s.jsx)("div",{className:"p-1 mb-8 rounded-full",style:{background:"linear-gradient(45deg, #b4003c, #d09900)"},children:(0,s.jsx)("div",{className:"p-2 bg-white rounded-full",children:(0,s.jsx)("div",{className:"flex items-center justify-center gap-4 align-center",children:(0,s.jsxs)("div",{className:"flex-1 text-center",children:[(0,s.jsx)("div",{className:"flex items-center justify-center gap-2 mb-2",children:(0,s.jsxs)("h3",{className:"text-lg font-bold text-gray-800",children:["問題類型：",x.categoryName]})}),(0,s.jsx)("div",{className:"p-2",children:(0,s.jsx)("p",{className:"leading-relaxed text-[#515151] text-3xl text-center",children:c})})]})})})}),(()=>{if(!x||!d)return null;let{category:e}=x;return"emotion_cooling"===e?(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("h2",{className:"font-bold text-[#374A37]",style:{fontSize:"36px",fontFamily:"Noto Serif TC, serif"},children:"盤面診斷"})}),(0,s.jsx)(S,{femaleUser:b,maleUser:y,analysisData:d}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("h2",{className:"font-bold text-[#374A37]",style:{fontSize:"36px",fontFamily:"Noto Serif TC, serif"},children:"風水急救"})}),(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(C,{femaleUser:b,maleUser:y,analysisData:d})}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("h2",{className:"font-bold text-[#374A37]",style:{fontSize:"36px",fontFamily:"Noto Serif TC, serif"},children:"重啟默契"})}),(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(E,{femaleUser:b,maleUser:y,analysisData:d})})]}):"special_situation"===e?(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("h2",{className:"font-bold text-[#374A37]",style:{fontSize:"36px",fontFamily:"Noto Serif TC, serif"},children:"星盤指引"})}),(0,s.jsx)(F,{femaleUser:b,maleUser:y,analysisData:d}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("h2",{className:"font-bold text-[#374A37]",style:{fontSize:"36px",fontFamily:"Noto Serif TC, serif"},children:"風水轉化"})}),(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(A,{femaleUser:b,maleUser:y,analysisData:d})}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("h2",{className:"font-bold text-[#374A37]",style:{fontSize:"36px",fontFamily:"Noto Serif TC, serif"},children:"相處心法"})}),(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(D,{femaleUser:b,maleUser:y,analysisData:d})})]}):"taboo_breaking"===e?(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("h2",{className:"font-bold text-[#374A37]",style:{fontSize:"36px",fontFamily:"Noto Serif TC, serif"},children:"關鍵分析"})}),(0,s.jsx)(k,{femaleUser:b,maleUser:y,analysisData:d}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("h2",{className:"font-bold text-[#374A37]",style:{fontSize:"36px",fontFamily:"Noto Serif TC, serif"},children:"針對性建議"})}),(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(T,{femaleUser:b,maleUser:y,analysisData:d})}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("h2",{className:"font-bold text-[#374A37]",style:{fontSize:"36px",fontFamily:"Noto Serif TC, serif"},children:"重啟默契"})}),(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(E,{femaleUser:b,maleUser:y,analysisData:d})})]}):null})()]})};var P=n(539),I=n(49509);let M=I.env.DEEPSEEK_API_KEY||I.env.API_KEY;class O{static async callDeepSeekAPI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n,s,a;let l=await fetch("https://api.deepseek.com/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(M)},body:JSON.stringify({model:"deepseek-chat",messages:e,max_tokens:t.maxTokens||800,temperature:t.temperature||.7,stream:!1})});if(!l.ok)throw Error("DeepSeek API error: ".concat(l.status," ").concat(l.statusText));let i=await l.json();return(null===(a=i.choices)||void 0===a?void 0:null===(s=a[0])||void 0===s?void 0:null===(n=s.message)||void 0===n?void 0:n.content)||""}catch(e){return console.error("DeepSeek API call failed:",e),null}}static async generateWorkAnalysis(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return await this.generatePersonalAnalysis(e,"工作",t)}static async generateFinanceAnalysis(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return await this.generatePersonalAnalysis(e,"財運",t)}static async generateHealthAnalysis(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return await this.generatePersonalAnalysis(e,"健康",t)}static async generateRelationshipAnalysis(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return await this.generatePersonalAnalysis(e,"人際關係",t)}static async generateChildrenAnalysis(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return await this.generatePersonalAnalysis(e,"子女",t)}static async generateFateAnalysis(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return await this.generatePersonalAnalysis(e,"因緣",t)}static async generateLoveAnalysis(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return await this.generatePersonalAnalysis(e,"感情",t)}static async generateCoupleAnalysis(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=e.getFullYear(),a=t.getFullYear(),l=this.calculateBazi(e),i=this.calculateBazi(t),r=this.calculateElement(s),c=this.calculateElement(a),o="\uD83D\uDD2E 風鈴看了你們的生日，發現你們的緣分很特別呢！\uD83D\uDC95\n\n";o+="**1. 命盤速讀**\n",o+="\uD83D\uDC68 男方：".concat(l.year," ").concat(l.month," ").concat(l.day," ").concat(l.hour," (").concat(r,"命)\n"),o+="\uD83D\uDC69 女方：".concat(i.year," ").concat(i.month," ").concat(i.day," ").concat(i.hour," (").concat(c,"命)\n"),o+="配對類型：".concat(this.getCoupleType(r,c),"\n"),o+="緣分指數：".concat(this.getCompatibilityScore(r,c),"%\n\n"),o+="**2. 契合度分析**\n";let d=this.getCompatibilityAnalysis(r,c);o+="五行互動：".concat(d.interaction,"\n"),o+="性格配對：".concat(d.personality,"\n"),o+="相處建議：".concat(d.advice,"\n\n");try{let s=await this.generateCoupleAIAnalysis(e,t,r,c,n);s?o+=s:o+=this.getFallbackCoupleAnalysis(r,c,n)}catch(e){console.error("AI generation failed:",e),o+=this.getFallbackCoupleAnalysis(r,c,n),o+=this.getCoupleReportRecommendations()}return o}static async generatePersonalAnalysis(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=e.getFullYear();e.getMonth(),e.getDate();let a=this.calculateBazi(e),l=this.calculateElement(s),i=this.getCategoryConfig(t),r="\uD83D\uDD2E 風鈴看了你的生日，發現你有很特別的".concat(t,"潛質呢！").concat(i.emoji,"\n\n");r+="**1. 命盤速讀**\n",r+="八字：".concat(a.year," ").concat(a.month," ").concat(a.day," ").concat(a.hour,"\n"),r+="五行屬性：".concat(l,"命\n"),r+="".concat(i.palace,"：").concat(this.getPalaceStar(l,t),"\n"),r+="   - 關鍵格局：\n",r+="     ".concat(this.getKeyPattern(l,s),"\n\n");try{let s=await this.generatePersonalAIAnalysis(e,l,t,n);s?r+=s:r+=this.getFallbackPersonalAnalysis(l,t,n)}catch(e){console.error("AI generation failed:",e),r+=this.getFallbackPersonalAnalysis(l,t,n),r+=this.getReportRecommendations(t)}return r}static async generatePersonalAIAnalysis(e,t,n,s){let a=e.getFullYear(),l=e.getMonth()+1,i=e.getDate(),r=new Date().getFullYear(),c=new Date().getMonth()+1,o=r-a,d=this.getCategoryConfig(n),m="你是專業的風水師「風鈴」，請根據以下信息生成個人化的".concat(n,"分析：\n\n用戶信息：\n- 出生日期：").concat(a,"年").concat(l,"月").concat(i,"日\n- 五行屬性：").concat(t,"命\n- 當前年齡：").concat(o,"歲\n- 當前時間：").concat(r,"年").concat(c,"月\n- 具體問題：").concat(s||"無特定問題","\n\n請生成以下三個部分的內容，要求個人化、具體、實用：\n\n**2. 年度預警**\n根據").concat(t,"命在").concat(r,"年的").concat(n,"運勢，提供：\n- 成就星：").concat(d.achievementGuide,"\n- 小人煞：").concat(d.obstacleGuide,"\n\n**3. ").concat(d.analysisTitle,"**\n根據").concat(t,"命特質，分析用戶最近").concat(n,"狀況和未來3-6個月趨勢，要具體描述：\n- ").concat(d.recentSituation,"\n- ").concat(d.futureTrend,"\n- ").concat(d.personalAdvantage,"\n\n**4. ").concat(d.adviceTitle,"**\n根據").concat(t,"命提供3個具體可行的").concat(n,"建議：\n- ").concat(d.advicePoint1,"\n- ").concat(d.advicePoint2,"\n- ").concat(d.advicePoint3,"\n\n**5. \uD83D\uDCA1 專屬問題解析**\n").concat(s?"針對你的具體問題「".concat(s,"」，根據").concat(t,"命特質提供：\n- 問題核心分析（為什麼會遇到這個問題）\n- 初步解決方向（2-3個可行建議）\n- \uD83C\uDFAF關鍵時機：").concat(t,"命最適合在【當前月份】開始行動\n- 風鈴溫馨提醒：想要詳細的解決步驟、專屬時辰表和風水佈局圖嗎？解鎖詳細報告，讓問題迎刃而解！✨"):"根據你目前的".concat(n,"狀況，風鈴發現：\n- 一個即將到來的重要轉機（與").concat(t,"命特質相關）\n- 需要在【未來2個月】特別把握的關鍵時期\n- ⚡機會窗口：錯過這次要等下個季度\n- 風鈴溫馨提醒：想知道具體日期、詳細行動計劃和專屬風水佈局嗎？解鎖詳細報告，把握最佳時機！✨"),"\n\n要求：\n1. 使用風鈴可愛親切的語調\n2. 內容要具體實用，不要空泛\n3. 根據五行特質個人化\n4. 考慮當前時間因素\n5. 每部分控制在2-3行內\n6. 使用emoji增加親和力\n7. Point 5要讓用戶感受到價值但留有懸念，引導解鎖詳細報告");return await this.callDeepSeekAPI([{role:"system",content:"你是風鈴，一個專業但親切可愛的風水師。你的回答要專業、個人化，同時保持輕鬆友好的語調。"},{role:"user",content:m}],{maxTokens:1400,temperature:.8})}static async generateCoupleAIAnalysis(e,t,n,s,a){let l=e.getFullYear(),i=t.getFullYear(),r=e.getMonth()+1,c=t.getMonth()+1,o=e.getDate(),d=t.getDate(),m=new Date().getFullYear(),u=new Date().getMonth()+1,g="你是專業的風水師「風鈴」，請根據以下信息生成個人化的合婚配對分析：\n\n雙方信息：\n- 男方：".concat(l,"年").concat(r,"月").concat(o,"日，").concat(n,"命，").concat(m-l,"歲\n- 女方：").concat(i,"年").concat(c,"月").concat(d,"日，").concat(s,"命，").concat(m-i,"歲\n- 當前時間：").concat(m,"年").concat(u,"月\n- 具體問題：").concat(a||"無特定問題","\n\n請生成以下部分的內容，要求個人化、具體、實用：\n\n**3. 星盤指引**\n根據雙方八字星盤分析，提供：\n- 遷移宮聯動：雙方感情發展的流年變化和關鍵時期\n- 夫妻宮信號：目前婚姻宮位的能量狀態和未來6個月趨勢\n- 關鍵法則：基於星盤配置的3個核心感情維護要點\n\n**4. 配對分析**\n根據").concat(n,"命和").concat(s,"命的配對特質，分析：\n- 你們最近的相處狀況和互動模式\n- 未來3-6個月的感情發展趨勢\n- 雙方性格優勢如何互補\n- 需要注意的磨合點\n\n**5. 簡單的感情風水建議**\n根據雙方五行提供3個具體可行的風水建議：\n- 居家環境佈置建議\n- 約會地點和活動選擇\n- 穿著配色和配飾建議\n\n**6. \uD83D\uDC95 專屬感情解析**\n").concat(a?"針對你們的具體問題「".concat(a,"」，根據").concat(n,"命和").concat(s,"命配對分析：\n- 問題背後的深層原因（五行角度分析）\n- 改善關係的初步方向（2-3個建議）\n- \uD83D\uDC92重要時機：你們在【當前季節】最適合深化關係\n- 風鈴溫馨提醒：想要詳細的感情改善計劃、吉日選擇和專屬佈局方案嗎？解鎖詳細報告，讓愛情開花結果！\uD83D\uDC95"):"根據你們的配對特質，風鈴發現：\n- 一個即將影響感情走向的關鍵轉折點\n- 【未來3個月】內的重要感情發展機會\n- ⏰黃金期：錯過這次高峰期要等半年\n- 風鈴溫馨提醒：想知道具體進展時間表、求婚吉日和增進感情的風水秘訣嗎？解鎖詳細報告，把握愛情最佳時機！\uD83D\uDC95","\n\n要求：\n1. 使用風鈴可愛親切的語調\n2. 內容要具體實用，針對雙方配對特質\n3. 考慮五行相生相剋關係\n4. 考慮當前時間因素\n5. 每部分控制在3-4行內\n6. 使用emoji增加親和力\n7. Point 5要讓用戶感受到價值但留有懸念，引導解鎖詳細報告");return await this.callDeepSeekAPI([{role:"system",content:"你是風鈴，一個專業但親切可愛的風水師。你的回答要專業、個人化，同時保持輕鬆友好的語調。"},{role:"user",content:g}],{maxTokens:1500,temperature:.8})}static getCategoryConfig(e){let t={工作:{emoji:"\uD83D\uDCBC",palace:"事業宮主星",analysisTitle:"你的工作運勢分析",adviceTitle:"簡單的工作風水建議",achievementGuide:"具體的突破領域和時機（例如：將星：X季主導專案）",obstacleGuide:"具體的防範對象和建議（例如：指背：遠離[生肖]同事）",recentSituation:"最近可能遇到的工作情況",futureTrend:"未來幾個月的發展機會",personalAdvantage:"個人優勢和需要注意的地方",advicePoint1:"辦公環境佈置",advicePoint2:"座位方向選擇",advicePoint3:"穿著配色建議"},財運:{emoji:"\uD83D\uDCB0",palace:"財帛宮主星",analysisTitle:"你的財運分析",adviceTitle:"簡單的招財風水建議",achievementGuide:"具體的財運突破期和投資時機（例如：天財星：X季投資機會）",obstacleGuide:"具體的破財防範和理財建議（例如：劫財煞：避免[類型]投資）",recentSituation:"最近的財務狀況和收入變化",futureTrend:"未來幾個月的財運機會",personalAdvantage:"理財優勢和需要注意的地方",advicePoint1:"居家財位佈置",advicePoint2:"錢包和配件選擇",advicePoint3:"投資理財時機"},健康:{emoji:"\uD83C\uDF3F",palace:"疾厄宮主星",analysisTitle:"你的健康運勢分析",adviceTitle:"簡單的養生風水建議",achievementGuide:"具體的健康提升期和調養時機（例如：藥師星：X季養生期）",obstacleGuide:"具體的健康注意事項和預防建議（例如：病符：注意[部位]保養）",recentSituation:"最近的身體狀況和能量變化",futureTrend:"未來幾個月的健康趨勢",personalAdvantage:"體質優勢和需要注意的地方",advicePoint1:"居家環境佈置",advicePoint2:"飲食和作息調整",advicePoint3:"運動和養生方式"},人際關係:{emoji:"\uD83E\uDD1D",palace:"交友宮主星",analysisTitle:"你的人際運勢分析",adviceTitle:"簡單的人際風水建議",achievementGuide:"具體的人脈擴展期和社交時機（例如：天德星：X季貴人運）",obstacleGuide:"具體的人際防範和溝通建議（例如：口舌煞：避免與[類型]人衝突）",recentSituation:"最近的人際互動和關係變化",futureTrend:"未來幾個月的社交機會",personalAdvantage:"社交優勢和需要注意的地方",advicePoint1:"社交場合佈置",advicePoint2:"溝通方式和態度",advicePoint3:"穿著和配飾建議"},子女:{emoji:"\uD83D\uDC76",palace:"子女宮主星",analysisTitle:"你的子女運勢分析",adviceTitle:"簡單的子女風水建議",achievementGuide:"具體的子女緣分和教育時機（例如：天喜星：X季懷孕機會）",obstacleGuide:"具體的子女教養和健康注意（例如：刑沖：注意[年齡]階段）",recentSituation:"最近與子女的相處和教育狀況",futureTrend:"未來幾個月的親子關係發展",personalAdvantage:"教養優勢和需要注意的地方",advicePoint1:"兒童房間佈置",advicePoint2:"親子互動方式",advicePoint3:"教育和成長環境"},因緣:{emoji:"\uD83D\uDD2E",palace:"遷移宮主星",analysisTitle:"你的因緣運勢分析",adviceTitle:"簡單的因緣風水建議",achievementGuide:"具體的機會出現和貴人時機（例如：天乙星：X季貴人相助）",obstacleGuide:"具體的阻礙化解和因緣建議（例如：孤辰：主動參與[活動]）",recentSituation:"最近的機會和人際因緣變化",futureTrend:"未來幾個月的因緣發展",personalAdvantage:"因緣優勢和需要注意的地方",advicePoint1:"居家氣場佈置",advicePoint2:"社交活動參與",advicePoint3:"心態和行為調整"},感情:{emoji:"\uD83D\uDC95",palace:"夫妻宮主星",analysisTitle:"你的感情運勢分析",adviceTitle:"簡單的感情風水建議",achievementGuide:"具體的桃花期和戀愛時機（例如：紅鸞星：X季桃花運）",obstacleGuide:"具體的感情阻礙和化解建議（例如：孤鸞：多參與[類型]活動）",recentSituation:"最近的感情狀況和情感變化",futureTrend:"未來幾個月的感情發展",personalAdvantage:"感情優勢和需要注意的地方",advicePoint1:"居家桃花位佈置",advicePoint2:"約會和相處方式",advicePoint3:"穿著和魅力提升"}};return t[e]||t["工作"]}static getPalaceStar(e,t){var n;return"工作"===t?this.getCareerStar(e):(null===(n=({財運:{金:"武曲星（正財穩健）",木:"天機星（偏財機智）",水:"太陰星（理財智慧）",火:"太陽星（財運亨通）",土:"天府星（聚財有方）"},健康:{金:"太白星（肺金強健）",木:"歲德星（肝木調和）",水:"北斗星（腎水充足）",火:"南極星（心火旺盛）",土:"中宮星（脾土和順）"},人際關係:{金:"天德星（正義人緣）",木:"文昌星（智慧交友）",水:"天乙星（貴人相助）",火:"福德星（熱情魅力）",土:"天梁星（穩重可靠）"},子女:{金:"天喜星（子女緣深）",木:"文曲星（教育有方）",水:"天姚星（親子和諧）",火:"紅鸞星（子女活潑）",土:"天倉星（養育豐厚）"},因緣:{金:"天乙貴人（高貴因緣）",木:"月德貴人（智慧因緣）",水:"太極貴人（神秘因緣）",火:"天德貴人（光明因緣）",土:"福德貴人（福氣因緣）"},感情:{金:"紅鸞星（正緣桃花）",木:"天喜星（成長之愛）",水:"咸池星（浪漫情緣）",火:"天姚星（熱情如火）",土:"天倉星（穩定長久）"}})[t])||void 0===n?void 0:n[e])||"紫微星"}static getCoupleType(e,t){let n={金水:"金水相生，智慧財富",水金:"金水相生，智慧財富",水木:"水木相生，成長滋養",木水:"水木相生，成長滋養",木火:"木火相生，熱情創意",火木:"木火相生，熱情創意",火土:"火土相生，溫暖穩定",土火:"火土相生，溫暖穩定",土金:"土金相生，踏實富足",金土:"土金相生，踏實富足",金金:"同氣連枝，理性默契",木木:"雙木並茂，共同成長",水水:"水乳交融，心靈相通",火火:"雙火燎原，激情四射",土土:"厚德載物，穩如泰山"};return n[e+t]||n[t+e]||"特殊配對，需要磨合"}static getCompatibilityScore(e,t){let n={金水:92,水金:92,水木:88,木水:88,木火:90,火木:90,火土:87,土火:87,土金:89,金土:89,金金:82,木木:78,水水:85,火火:75,土土:80,金木:65,木金:65,木土:68,土木:68,土水:62,水土:62,水火:70,火水:70,火金:67,金火:67};return n[e+t]||n[t+e]||70}static getCompatibilityAnalysis(e,t){let n=this.getCompatibilityScore(e,t);return n>=85?{interaction:"五行相生，能量互補增強 ✨",personality:"性格特質高度契合，相處融洽",advice:"保持現有互動模式，適度給彼此空間"}:n>=75?{interaction:"五行同類，理解默契度高 \uD83E\uDD1D",personality:"思維模式相似，容易產生共鳴",advice:"適時增加新鮮感，避免過於平淡"}:{interaction:"五行相剋，需要磨合調和 ⚖️",personality:"性格差異較大，但可以互補成長",advice:"多溝通理解，學會欣賞彼此不同特質"}}static getFallbackPersonalAnalysis(e,t,n){let s="",a=this.getCategoryConfig(t);s+="**2. 年度預警**\n";let l=this.getYearlyForecast(e,new Date().getFullYear(),t);return s+="   - 成就星：".concat(l.achievement,"\n"),s+="   - 小人煞：".concat(l.obstacle,"\n\n"),s+="**3. ".concat(a.analysisTitle,"**\n"),s+=this.getCategoryFortune(e,t,new Date().getFullYear(),new Date().getMonth()+1)+"\n\n",s+="**4. ".concat(a.adviceTitle,"**\n"),this.getCategoryFengShuiAdvice(e,t).forEach(e=>{s+="• ".concat(e,"\n")}),s+="\n",s+="**5. \uD83D\uDCA1 專屬問題解析**\n",n?(s+="針對你的具體問題「".concat(n,"」：\n"),s+="• 問題核心：".concat(this.getSpecificCategoryAdvice(e,t,n),"\n"),s+="• 初步建議：".concat(this.getBasicSolution(e,t),"\n"),s+="• \uD83C\uDFAF關鍵時機：".concat(e,"命最適合在當前時期採取行動\n"),s+="• 風鈴溫馨提醒：想要詳細行動計劃、專屬時辰表和風水佈局圖嗎？解鎖詳細報告，問題迎刃而解！✨\n"):(s+="根據你的".concat(t,"狀況，風鈴發現：\n"),s+="• 關鍵機會：".concat(this.getOpportunityHint(e,t),"\n"),s+="• 注意事項：".concat(this.getCautionHint(e,t),"\n"),s+="• ⚡機會窗口：錯過當前時期要等下個季度\n",s+="• 風鈴溫馨提醒：想知道具體時間安排和專屬指導方案嗎？解鎖詳細報告，把握最佳時機！✨\n"),s+="\n"}static getFallbackCoupleAnalysis(e,t,n){let s="";return s+="**3. 配對分析**\n",s+=this.getCoupleAnalysisDetail(e,t)+"\n\n",s+="**4. 簡單的感情風水建議**\n",this.getCoupleFengShuiAdvice(e,t).forEach(e=>{s+="• ".concat(e,"\n")}),s+="\n",s+="**5. \uD83D\uDC95 專屬感情解析**\n",n?(s+="針對你們的具體問題「".concat(n,"」：\n"),s+="• 問題分析：".concat(this.getSpecificCoupleAdvice(e,t,n),"\n"),s+="• 改善方向：".concat(this.getCoupleImprovementHint(e,t),"\n"),s+="• \uD83D\uDC92重要時機：你們最適合在當前季節深化關係\n",s+="• 風鈴溫馨提醒：想要詳細改善計劃、吉日選擇和專屬佈局嗎？解鎖詳細報告，讓愛情開花結果！\uD83D\uDC95\n"):(s+="根據你們的配對特質：\n",s+="• 關鍵優勢：".concat(this.getCoupleStrengthHint(e,t),"\n"),s+="• 發展機會：".concat(this.getCoupleOpportunityHint(e,t),"\n"),s+="• ⏰黃金期：錯過當前高峰期要等半年\n",s+="• 風鈴溫馨提醒：想知道具體時間表、求婚吉日和增進感情的風水秘訣嗎？解鎖詳細報告，把握愛情最佳時機！\uD83D\uDC95\n"),s+="\n"}static getFallbackAnalysis(e,t){return this.getFallbackPersonalAnalysis(e,"工作",t)}static calculateBazi(e){let t=e.getFullYear(),n=e.getMonth()+1;e.getDate();let s=P.h.getYearPillar(t),a=P.h.getDayPillar(e),l=this.getMonthPillar(t,n),i=this.getHourPillar();return{year:"".concat(s.tianGan).concat(s.diZhi),month:"".concat(l.tianGan).concat(l.diZhi),day:"".concat(a.tianGan).concat(a.diZhi),hour:"".concat(i.tianGan).concat(i.diZhi),yearElement:s.element,dayElement:a.element}}static getMonthPillar(e,t){return{tianGan:P.h.tianGan[(12*e+t)%10],diZhi:P.h.diZhi[t-1]}}static getHourPillar(){return{tianGan:"戊",diZhi:"辰"}}static calculateElement(e){return["金","木","水","火","土"][e%5]}static getCareerStar(e){return({金:"武曲星（財官雙美）",木:"天機星（智慧謀略）",水:"太陰星（感性智慧）",火:"太陽星（領導光芒）",土:"天府星（穩重權威）"})[e]||"紫微星"}static getKeyPattern(e,t){let n=new Date().getFullYear(),s=n-t,a={金:{strength:s%2==0?"身強":"身弱",god:"用神：土（印星生身，穩固根基）",timing:"大運節點：".concat(n,"年處").concat(this.getCurrentLuck(e),"大運")},木:{strength:s%2==0?"身強":"身弱",god:"用神：水（生發之源，智慧流動）",timing:"大運節點：".concat(n,"年處").concat(this.getCurrentLuck(e),"大運")},水:{strength:s%2==0?"身強":"身弱",god:"用神：金（源頭活水，財源滾滾）",timing:"大運節點：".concat(n,"年處").concat(this.getCurrentLuck(e),"大運")},火:{strength:s%2==0?"身強":"身弱",god:"用神：木（薪火相傳，生生不息）",timing:"大運節點：".concat(n,"年處").concat(this.getCurrentLuck(e),"大運")},土:{strength:s%2==0?"身強":"身弱",god:"用神：火（溫暖調候，生機盎然）",timing:"大運節點：".concat(n,"年處").concat(this.getCurrentLuck(e),"大運")}}[e];return"".concat(a.strength,"（").concat(this.getStrengthReason(e),"）\n     ").concat(a.god,"\n     ").concat(a.timing)}static getStrengthReason(e){return({金:"日主庚金生秋月，金旺當令",木:"日主甲木生春月，木旺得時",水:"日主壬水生冬月，水旺司權",火:"日主丙火生夏月，火旺得勢",土:"日主戊土生季末，土旺得地"})[e]||"五行平衡"}static getCurrentLuck(e){return({金:"己未",木:"甲寅",水:"壬子",火:"丙午",土:"戊辰"})[e]}static getYearlyForecast(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"工作";new Date().getMonth();let s={工作:{金:{achievement:"將星：秋季主導重要專案（9-11月突破期）",obstacle:"指背煞：遠離屬虎同事，避免背後議論"},木:{achievement:"文昌星：春季創意大爆發（3-5月靈感期）",obstacle:"小耗煞：遠離屬猴上司，防範資源爭奪"},水:{achievement:"智慧星：冬季策略規劃（12-2月佈局期）",obstacle:"六害煞：遠離屬蛇同事，避免合作衝突"},火:{achievement:"權威星：夏季領導展現（6-8月發光期）",obstacle:"劫財煞：遠離屬豬同事，防範利益糾紛"},土:{achievement:"貴人星：四季交替轉機（3/6/9/12月關鍵期）",obstacle:"華蓋煞：遠離屬龍同事，避免孤立無援"}},財運:{金:{achievement:"天財星：秋季投資收益（9-11月理財期）",obstacle:"劫財煞：避免高風險投資，謹慎借貸"},木:{achievement:"進財星：春季事業成長（3-5月收入期）",obstacle:"破財煞：遠離投機生意，穩健理財"},水:{achievement:"偏財星：冬季意外之財（12-2月機會期）",obstacle:"耗財煞：控制消費慾望，避免浪費"},火:{achievement:"正財星：夏季正職加薪（6-8月收穫期）",obstacle:"散財煞：避免衝動消費，理性理財"},土:{achievement:"聚財星：四季穩定累積（定期投資佳）",obstacle:"損財煞：避免擔保借貸，保守為上"}},健康:{金:{achievement:"藥師星：秋季調養肺部（9-11月養生期）",obstacle:"病符煞：注意呼吸系統，避免感冒"},木:{achievement:"長生星：春季肝膽調理（3-5月養肝期）",obstacle:"刑傷煞：注意筋骨保養，避免外傷"},水:{achievement:"延年星：冬季腎水補充（12-2月進補期）",obstacle:"衰弱煞：注意腰腎保暖，規律作息"},火:{achievement:"活力星：夏季心血管強化（6-8月運動期）",obstacle:"火旺煞：控制情緒起伏，避免上火"},土:{achievement:"穩健星：四季脾胃調理（規律飲食佳）",obstacle:"濕重煞：注意脾胃保養，避免濕氣"}},人際關係:{金:{achievement:"天德星：秋季貴人相助（9-11月社交期）",obstacle:"孤星煞：主動參與聚會，避免獨處"},木:{achievement:"人緣星：春季友誼開花（3-5月交友期）",obstacle:"口舌煞：謹慎言辭，避免爭論"},水:{achievement:"智慧星：冬季深度交流（12-2月談心期）",obstacle:"暗害煞：防範小人背後，謹慎交友"},火:{achievement:"魅力星：夏季人氣爆棚（6-8月聚會期）",obstacle:"衝突煞：控制脾氣，包容他人"},土:{achievement:"信任星：四季建立深交（長期友誼佳）",obstacle:"固執煞：保持開放心態，聆聽建議"}},子女:{金:{achievement:"天喜星：秋季懷孕機會（9-11月受孕期）",obstacle:"刑沖煞：注意青春期管教，避免衝突"},木:{achievement:"文曲星：春季教育成效（3-5月學習期）",obstacle:"叛逆煞：耐心溝通，避免強硬管教"},水:{achievement:"智慧星：冬季親子溝通（12-2月談心期）",obstacle:"冷漠煞：增加陪伴時間，關注情感"},火:{achievement:"活力星：夏季親子活動（6-8月遊樂期）",obstacle:"急躁煞：控制情緒，耐心教導"},土:{achievement:"慈愛星：四季穩定教養（持續陪伴佳）",obstacle:"溺愛煞：適度管教，培養獨立"}},因緣:{金:{achievement:"天乙星：秋季貴人出現（9-11月機遇期）",obstacle:"孤辰煞：主動社交，參與活動"},木:{achievement:"月德星：春季機會萌發（3-5月發展期）",obstacle:"阻滯煞：耐心等待，不急於求成"},水:{achievement:"太極星：冬季神奇際遇（12-2月轉機期）",obstacle:"迷茫煞：保持清醒，明辨是非"},火:{achievement:"光明星：夏季機會顯現（6-8月行動期）",obstacle:"衝動煞：三思而後行，避免草率"},土:{achievement:"福德星：四季福氣累積（持續行善佳）",obstacle:"執著煞：順其自然，不強求結果"}},感情:{金:{achievement:"紅鸞星：秋季正緣桃花（9-11月戀愛期）",obstacle:"孤鸞煞：主動社交，參與聚會"},木:{achievement:"天喜星：春季愛情萌芽（3-5月甜蜜期）",obstacle:"三刑煞：避免三角關係，專一感情"},水:{achievement:"咸池星：冬季浪漫邂逅（12-2月緣分期）",obstacle:"流霞煞：提防爛桃花，理性選擇"},火:{achievement:"天姚星：夏季熱情如火（6-8月激情期）",obstacle:"桃花劫：控制情緒，避免衝動"},土:{achievement:"天倉星：四季感情穩定（長久關係佳）",obstacle:"固情煞：適度變化，保持新鮮感"}}};return(s[n]||s["工作"])[e]||{achievement:"吉星高照：適時把握機會",obstacle:"小心謹慎：避免小人作祟"}}static getCareerFortune(e,t,n){return new Date().getFullYear(),new Date().getMonth(),({金:"金命的你最近工作運勢呈現穩中有升的趨勢。過去幾個月可能在職場上遇到一些決策挑戰，但你的理性分析能力幫助你渡過難關。接下來的3-6個月，特別是秋季期間，會有重要的升遷或項目機會出現。建議你主動爭取管理職位，你的領導才能將得到充分發揮。",木:"木命的你創意能量充沛，最近在工作上可能產生了很多新想法，但執行上還需要更多耐心。春季是你的旺季，創新項目容易獲得認可。未來幾個月要特別注意與團隊的溝通協調，你的成長性思維將為公司帶來新的發展方向。",水:"水命的你善於變通，最近工作環境的變化對你來說反而是機會。你的適應能力讓你在團隊中備受重視。接下來要把握溝通協調的角色，你的智慧和靈活性將幫助解決很多複雜問題。冬季期間運勢特別旺盛。",火:"火命的你行動力強，最近在工作上展現出很強的執行力，但要注意控制急躁情緒。夏季是你的發光期，領導魅力會吸引更多合作機會。接下來幾個月適合推動重要項目，你的熱情將感染整個團隊。",土:"土命的你做事穩重，最近可能感覺工作進展較慢，但你的堅持正在累積重要成果。你的可靠性讓上司對你信任有加。接下來的發展重點是建立長期規劃，你的穩定特質將成為職場上的重要資產。"})[e]||"你的工作運勢整體穩定，適合積極規劃未來發展。"}static getWorkFengShuiAdvice(e){return({金:["辦公桌放置白色水晶球或金屬擺件，增強決策力","座位選擇西方或西北方，背靠實牆面朝開闊空間","多穿白色、金色、銀色服裝，提升權威氣場"],木:["辦公桌左側放綠色植物（如富貴竹、綠蘿），激發創意","座位朝向東方或東南方，接受朝陽正能量","使用木質文具和綠色系辦公用品，保持成長活力"],水:["辦公桌上放小型流水擺設或藍色水晶，提升智慧","座位面向北方，保持思維清晰流暢","多用藍色、黑色文具，穿深色系服裝增強專業感"],火:["辦公桌南側放紅色擺件或向陽植物，增強領導氣場","座位朝南背北，充分吸收陽光能量","適量使用紅色、橙色辦公用品，激發行動力"],土:["辦公桌中央放黃色水晶或陶瓷擺件，穩固根基","選擇四角穩固的辦公桌椅，營造安全感","多用黃色、棕色系用品，穿大地色系服裝增強可靠感"]})[e]||["保持辦公環境整潔有序","座位背後要有靠山（牆面或櫃子）","桌上適量放置綠色植物"]}static getSpecificWorkAdvice(e,t){let n=t.toLowerCase();return n.includes("升職")||n.includes("加薪")||n.includes("晉升")?this.getPromotionAdvice(e):n.includes("跳槽")||n.includes("轉工")||n.includes("換工作")?this.getJobChangeAdvice(e):n.includes("同事")||n.includes("上司")||n.includes("人際")?this.getWorkRelationshipAdvice(e):n.includes("創業")||n.includes("生意")?this.getBusinessAdvice(e):this.getGeneralWorkAdvice(e)}static getPromotionAdvice(e){return({金:"你的領導氣質明顯，建議主動承擔更多責任，展現決策能力。最佳時機在秋季，準備好你的成果展示。",木:"發揮你的創新優勢，提出有建設性的改進方案。春季是最佳申請期，要有耐心等待成長機會。",水:"善用你的溝通協調能力，成為團隊中不可缺少的橋樑。適合在冬季提出升職申請。",火:"你的執行力是最大優勢，積極推動重要項目的完成。夏季期間運勢最旺，把握機會表現。",土:"穩扎穩打累積成果，讓你的可靠性得到充分認可。四季交替時期都是好時機。"})[e]||"持續努力，機會自然來臨。"}static getJobChangeAdvice(e){return({金:"適合轉向管理職或需要決策力的工作，金融、法律、製造業都是好選擇。",木:"創意產業、教育、環保等成長性行業最適合你的發展。",水:"貿易、服務業、媒體傳播等需要溝通的行業能發揮你的優勢。",火:"銷售、娛樂、科技等充滿活力的行業最適合你的特質。",土:"建築、房地產、農業、金融等穩定行業符合你的性格。"})[e]||"選擇適合自己特質的行業最重要。"}static getWorkRelationshipAdvice(e){return({金:"以誠待人，用你的公正態度贏得信任，但要學會適度的靈活變通。",木:"發揮你的包容性，幫助團隊成長，但要注意不要過於理想化。",水:"善用你的溝通天賦，成為各方的協調者，但要堅持自己的原則。",火:"控制情緒起伏，用你的熱情感染他人，但要學會傾聽不同意見。",土:"發揮你的穩定作用，成為團隊的定海神針，但要更主動表達想法。"})[e]||"真誠溝通是解決人際問題的關鍵。"}static getBusinessAdvice(e){return({金:"適合投資型或製造業創業，要充分發揮你的管理和決策優勢。",木:"創新科技或教育服務最適合，要保持學習心態和成長思維。",水:"貿易或服務業創業機會大，要善用你的人脈和溝通能力。",火:"娛樂、餐飲或行銷相關最適合，要控制擴張節奏避免過於激進。",土:"傳統行業或房地產較穩妥，要做好長期規劃和風險控制。"})[e]||"選擇熟悉的領域，循序漸進發展最安全。"}static getGeneralWorkAdvice(e){return({金:"發揮你的領導天賦，在決策和管理方面多下功夫。",木:"保持學習成長的心態，在創新和發展方面尋找突破。",水:"善用你的溝通協調能力，在團隊合作中發揮重要作用。",火:"控制好節奏，用你的行動力推動工作進展。",土:"穩步前進，在穩定中尋求突破和發展機會。"})[e]||"根據自己的特質，發揮最大優勢。"}static getCategoryFortune(e,t,n,s){let a={工作:this.getCareerFortune(e,n,s),財運:this.getFinanceFortune(e,n,s),健康:this.getHealthFortune(e,n,s),人際關係:this.getRelationshipFortune(e,n,s),子女:this.getChildrenFortune(e,n,s),因緣:this.getFateFortune(e,n,s),感情:this.getLoveFortune(e,n,s)};return a[t]||a["工作"]}static getFinanceFortune(e,t,n){return({金:"金命的你理財觀念務實，最近可能在投資理財方面更加謹慎。你的分析能力幫助你避開了一些風險，接下來的秋季期間是你的財運旺季。建議關注穩健型投資，你的理性判斷將帶來穩定收益。避免過於保守，適度的投資能增加財富累積。",木:"木命的你財運呈現成長趨勢，最近可能有新的收入來源或投資機會出現。你的學習能力讓你能快速掌握理財知識，春季是你的財運高峰期。未來幾個月適合長期投資規劃，你的成長性思維將帶來可觀回報。",水:"水命的你財運變化靈活，最近可能在資金流動方面有新的規劃。你的適應能力讓你能在市場變化中找到機會，冬季期間財運特別旺盛。建議關注流動性投資，你的靈活性將幫助抓住短期獲利機會。",火:"火命的你財運行動力強，最近可能在賺錢方面有積極的表現。你的執行力讓你能快速把握投資時機，夏季是你的財運爆發期。接下來適合積極理財，但要注意控制風險，避免衝動投資。",土:"土命的你財運穩健，最近可能感覺財富累積較慢，但你的堅持正在建立穩固的財務基礎。你的穩重讓你避開了很多投資陷阱，接下來的發展重點是長期規劃，你的穩定特質將成為財富增長的重要資產。"})[e]||"你的財運整體穩定，適合積極規劃理財策略。"}static getHealthFortune(e,t,n){return({金:"金命的你體質較為敏感，最近可能需要特別注意呼吸系統和皮膚的保養。你的自律性幫助你維持良好的作息習慣，秋季是你的養生關鍵期。建議多做深呼吸運動，你的理性態度將幫助建立健康的生活方式。",木:"木命的你生命力旺盛，最近可能感覺精力充沛，但要注意肝膽和筋骨的保養。你的活力讓你能保持積極的運動習慣，春季是你的健康提升期。建議多接觸大自然，你的成長性特質將帶來身心的全面發展。",水:"水命的你體質偏寒，最近可能需要注意保暖和腎臟的調養。你的智慧讓你能找到適合的養生方法，冬季期間要特別注意保健。建議多喝溫水、適度進補，你的適應能力將幫助調節體質平衡。",火:"火命的你精力旺盛，最近可能容易上火或情緒激動，需要注意心血管和情緒的調節。你的活力讓你喜歡運動健身，夏季要注意避免過度勞累。建議保持平和心態，你的熱情將轉化為健康的動力。",土:"土命的你體質穩定，最近可能需要注意脾胃的調理和體重管理。你的規律性讓你能維持穩定的健康狀態，四季都適合養生調理。建議注意飲食平衡，你的穩健特質將成為長期健康的保障。"})[e]||"你的健康運勢整體良好，保持規律作息最重要。"}static getRelationshipFortune(e,t,n){return({金:"金命的你人際關係講求公平正義，最近可能在朋友圈中扮演仲裁者的角色。你的公正態度贏得他人信任，秋季是你的社交旺季。建議主動參與團體活動，你的領導魅力將吸引志同道合的朋友。",木:"木命的你人緣很好，最近可能結識了一些有趣的新朋友。你的包容性讓你能與不同類型的人相處，春季是你的交友高峰期。建議多參與學習型聚會，你的成長性思維將帶來有價值的人脈。",水:"水命的你善於溝通，最近可能在人際關係中發揮了重要的協調作用。你的智慧讓你能化解很多人際衝突，冬季期間人際運勢特別旺盛。建議深化現有友誼，你的真誠將建立長久的信任關係。",火:"火命的你個性熱情，最近可能因為你的活力而成為朋友圈的焦點。你的魅力讓你容易結交新朋友，夏季是你的人氣爆發期。建議控制情緒起伏，用你的正能量感染周圍的人。",土:"土命的你人際關係穩定，最近可能更加重視深層的友誼關係。你的可靠性讓朋友都願意向你求助，四季都適合維護現有人脈。建議更主動表達關心，你的真誠將深化所有人際關係。"})[e]||"你的人際運勢穩定，真誠溝通是關鍵。"}static getChildrenFortune(e,t,n){return({金:"金命的你對子女教育很有規劃，最近可能在教育方式上有新的思考。你的理性態度幫助建立明確的教育目標，秋季是親子關係的重要時期。建議多聆聽孩子的想法，你的公正性將贏得子女的尊敬。",木:"木命的你與子女關係融洽，最近可能發現孩子的新才能或興趣。你的包容性讓孩子能自由發展，春季是教育成效顯現的時期。建議陪伴孩子探索新事物，你的成長性思維將啟發子女的潛能。",水:"水命的你很懂得與子女溝通，最近可能通過深度對話更了解孩子的內心。你的智慧讓你能給予適當的指導，冬季期間親子關係特別和諧。建議增加情感交流時間，你的理解力將建立深厚的親子關係。",火:"火命的你對子女充滿熱情，最近可能在親子活動上很積極。你的活力讓孩子感受到滿滿的愛，夏季是親子互動的黃金期。建議控制期待值，用你的熱情激發孩子的興趣而非壓力。",土:"土命的你給予子女穩定的愛，最近可能更注重孩子的品格教育。你的穩重讓孩子有安全感，四季都適合進行深度的親子教育。建議保持耐心和包容，你的穩定性將成為子女成長的重要支柱。"})[e]||"你與子女的關係整體和諧，用心陪伴最重要。"}static getFateFortune(e,t,n){return({金:"金命的你最近因緣際遇偏向高品質的人事物，可能會遇到一些有影響力的貴人。你的正直態度吸引了志同道合的人，秋季是重要機會出現的時期。建議保持開放心態，你的品格將為你帶來意想不到的好機緣。",木:"木命的你因緣呈現成長性發展，最近可能有學習或發展的新機會出現。你的求知欲吸引了很多學習資源，春季是因緣萌發的關鍵期。建議積極參與成長型活動，你的進步心將帶來豐富的人生體驗。",水:"水命的你因緣變化多樣，最近可能有意外的際遇或轉機。你的適應力讓你能把握各種機會，冬季期間因緣特別神奇。建議保持靈活心態，你的智慧將幫助識別真正有價值的機緣。",火:"火命的你因緣充滿活力，最近可能因為積極行動而創造了新的機會。你的熱情感染了周圍的人，夏季是因緣爆發的時期。建議把握當下機會，你的行動力將開創全新的人生可能性。",土:"土命的你因緣深厚穩定，最近可能有長期性的重要機會出現。你的誠信態度建立了良好的口碑，四季都有持續的好因緣。建議珍惜既有關係，你的穩重將累積深厚的福德因緣。"})[e]||"你的因緣運勢整體良好，誠心待人將帶來好機緣。"}static getLoveFortune(e,t,n){return({金:"金命的你感情觀較為理性，最近可能在愛情中尋求更深層的精神契合。你的真誠態度吸引了品質不錯的桃花，秋季是正緣出現的重要時期。建議保持真實自我，你的品格將吸引真正適合的人。",木:"木命的你感情充滿成長性，最近可能與伴侶在共同學習中增進感情。你的包容性讓感情關係很和諧，春季是愛情開花結果的時期。建議多創造共同體驗，你的成長性思維將帶來美好的愛情故事。",水:"水命的你感情豐富細膩，最近可能通過深度溝通讓感情更進一步。你的理解力讓伴侶感到被珍視，冬季期間愛情運勢特別旺盛。建議多表達內心感受，你的真誠將建立深厚的情感連結。",火:"火命的你感情熱烈直接，最近可能因為你的魅力而吸引了很多關注。你的熱情讓愛情充滿激情，夏季是桃花大爆發的時期。建議學會耐心經營，你的真心將點燃美好的愛情火花。",土:"土命的你感情踏實穩重，最近可能更重視感情的長期發展。你的穩定性讓伴侶很有安全感，四季都適合深化感情關係。建議增加浪漫元素，你的真誠將建立堅固持久的愛情基礎。"})[e]||"你的感情運勢穩定，真心相待是愛情的基礎。"}static getCategoryFengShuiAdvice(e,t){let n={工作:this.getWorkFengShuiAdvice(e),財運:this.getFinanceFengShuiAdvice(e),健康:this.getHealthFengShuiAdvice(e),人際關係:this.getRelationshipFengShuiAdvice(e),子女:this.getChildrenFengShuiAdvice(e),因緣:this.getFateFengShuiAdvice(e),感情:this.getLoveFengShuiAdvice(e)};return n[t]||n["工作"]}static getFinanceFengShuiAdvice(e){return({金:["財位（東南方）放置白色水晶或金屬聚寶盆，增強財運磁場","使用金色、白色錢包，裡面放置整齊鈔票和紅色小紙條","每月初一十五在財位點香祈福，感謝財神護佑"],木:["財位放置綠色植物（如發財樹、富貴竹），激活生財能量","使用綠色、棕色錢包，裡面放置生長中的種子象徵錢財增長","定期整理財務文件，保持理財環境清潔有序"],水:["財位放置小型流水裝置或藍色水晶，促進財富流動","使用藍色、黑色錢包，避免紅色以免財水相沖","每週清潔錢包和銀行卡，保持財運流動順暢"],火:["財位南側放置紅色擺件或向陽植物，激發賺錢動力","使用紅色、紫色錢包，但避免過於鮮豔防止散財","在家中點燃檀香或使用精油，營造積極的財運氛圍"],土:["財位中央放置黃色水晶或陶瓷聚寶盆，穩固財富根基","使用黃色、棕色厚實錢包，象徵財富穩固累積","定期清理家中雜物，保持財運通道暢通無阻"]})[e]||["保持財位整潔，定期清理雜物","使用質感好的錢包，避免破損","培養良好的理財習慣和記帳習慣"]}static getHealthFengShuiAdvice(e){return({金:["臥室西方放置白色水晶或金屬風鈴，調和肺金能量","多穿白色、淺色衣物，避免過於厚重的服裝","保持室內空氣流通，定期更換寢具維持清潔"],木:["房間東方放置綠色植物或木質傢具，增強肝木活力","多穿綠色、自然色系服裝，使用天然材質用品","每天早晨面向東方做深呼吸，吸收朝陽正能量"],水:["房間北方放置水培植物或藍色擺件，滋養腎水","多穿深色、藍色系服裝，保持身體溫暖","睡前泡腳或洗溫水澡，促進血液循環"],火:["房間南方放置紅色擺件或向陽植物，平衡心火","適量使用紅色服飾，但避免全身過於鮮豔","保持規律作息，避免熬夜影響心血管健康"],土:["房間中央保持整潔，放置黃色或陶瓷擺件穩定脾土","多穿大地色系、舒適寬鬆的服裝","注意飲食規律，三餐定時定量保養脾胃"]})[e]||["保持居住環境整潔舒適","維持規律的作息時間","根據體質選擇適合的運動方式"]}static getRelationshipFengShuiAdvice(e){return({金:["客廳西方擺放成對的白色或金屬裝飾品，增強人際和諧","參加聚會時穿著白色、金色系服裝，提升領導魅力","送禮選擇精緻的金屬或白色物品，展現品味"],木:["家中東方放置綠色植物或木質圓桌，促進友誼成長","社交場合穿著自然色系，使用木質或竹製飾品","多在戶外或綠意環境中與朋友聚會交流"],水:["客廳北方放置流水擺設或藍色裝飾，促進溝通流暢","參與社交時穿著藍色、黑色系服裝，展現智慧氣質","選擇水邊或安靜的咖啡廳作為約會談心場所"],火:["客廳南方放置成對的紅色或明亮裝飾品，增強人氣","社交場合適量使用紅色配飾，但避免過於張揚","選擇明亮、熱鬧的環境進行聚會和交流"],土:["客廳中央放置圓形地毯或黃色抱枕，營造溫馨氛圍","穿著大地色系、質感穩重的服裝，展現可靠形象","選擇溫馨舒適的家庭式餐廳作為聚會場所"]})[e]||["保持真誠友善的態度","主動參與各種社交活動","學會聆聽和包容不同觀點"]}static getChildrenFengShuiAdvice(e){return({金:["兒童房西方放置白色學習桌椅，培養專注和邏輯思維","為孩子選擇金屬或白色文具，提升學習效率","建立明確的作息時間表，培養孩子的自律性"],木:["兒童房東方放置書桌和綠色植物，促進智慧成長","使用木質玩具和自然材質用品，培養親近自然的心性","多帶孩子到戶外活動，在大自然中學習成長"],水:["兒童房北方設置閱讀角落，放置藍色書櫃或擺件","鼓勵孩子多喝水，使用藍色或深色學習用品","培養孩子的想像力和創造力，多進行親子對話"],火:["兒童房南方放置明亮的學習燈具，激發學習熱情","適量使用紅色或明亮色彩裝飾，但避免過於刺激","鼓勵孩子參與體育活動，培養積極正面的性格"],土:["兒童房中央保持整潔，使用黃色或大地色系裝飾","為孩子準備舒適穩固的學習環境和質感好的用品","注重品格教育，培養孩子的責任感和同理心"]})[e]||["為孩子創造溫馨安全的成長環境","保持耐心和愛心進行教育","尊重孩子的個性發展和興趣愛好"]}static getFateFengShuiAdvice(e){return({金:["家中西方設置祈福空間，放置白色蠟燭或金屬法器","穿著整潔得體，展現高品質的個人形象","保持正直善良的品格，以德行吸引好因緣"],木:["家中東方放置常青植物，象徵因緣不斷成長","多參與學習成長類活動，在求知中遇見貴人","保持開放包容的心態，歡迎新的人事物進入生活"],水:["家中北方放置流水或水晶球，促進因緣流動","保持靈活變通的處事態度，隨緣不強求","多行善積德，用智慧和慈悲心累積福德因緣"],火:["家中南方放置明亮燈具，照亮人生道路","積極主動參與各種活動，用熱情創造機會","保持正面樂觀的態度，用光明能量吸引好緣分"],土:["家中中央保持整潔神聖，設置感恩祈福的空間","踏實做人做事，用誠信建立良好的人生基礎","珍惜既有的人際關係，深耕長期的情感連結"]})[e]||["保持善良正直的品格","積極參與有意義的活動","以誠待人，廣結善緣"]}static getLoveFengShuiAdvice(e){return({金:["臥室西南方（桃花位）放置成對的白色玫瑰或金屬裝飾","穿著優雅的白色、粉色系服裝，展現高貴氣質","保持理性和感性的平衡，用真誠吸引真愛"],木:["桃花位放置粉色花朵或綠色植物，催旺桃花運","穿著自然色系、有質感的服裝，展現親和力","多在自然環境中約會，讓愛情在成長中深化"],水:["桃花位放置水培植物或粉色水晶，增強浪漫氣息","穿著藍色、紫色系優雅服裝，展現神秘魅力","培養深度溝通的能力，用心靈契合建立真愛"],火:["桃花位放置紅色或粉色鮮花，點燃愛情火花","適量使用紅色、粉色配飾，但避免過於濃烈","保持熱情但學會溫柔，用真心感動對方"],土:["桃花位放置成對的黃色或粉色擺件，穩固愛情基礎","穿著溫暖的大地色系服裝，展現可靠魅力","注重細節和承諾，用穩定的愛建立長久關係"]})[e]||["保持真實自然的個性魅力","培養良好的溝通和相處技巧","用心經營感情，珍惜每個相遇"]}static getCoupleAnalysisDetail(e,t){let n={金水:"你們是理性與智慧的完美結合。".concat(e,"命的穩重理性正好平衡了").concat(t,"命的靈活變通，最近你們在溝通協調方面表現得很好。接下來幾個月，你們的關係會更加和諧，").concat(e,"命提供安全感，").concat(t,"命帶來新鮮感。建議多進行深度對話，你們的理性溝通將建立更深厚的信任基礎。"),水木:"你們是滋養與成長的美好配對。".concat(e,"命的智慧滋養著").concat(t,"命的成長夢想，最近你們在共同學習和發展方面很有默契。未來幾個月，你們會在互相支持中獲得成長，").concat(e,"命的靈活性幫助").concat(t,"命適應變化，").concat(t,"命的積極性帶動").concat(e,"命前進。"),木火:"你們是創意與熱情的完美融合。".concat(e,"命的創新思維點燃了").concat(t,"命的行動熱情，最近你們在追求夢想方面很有共識。接下來的時間裡，你們會在共同努力中實現目標，").concat(e,"命提供方向，").concat(t,"命提供動力，是很有發展潛力的組合。"),火土:"你們是激情與穩定的互補配對。".concat(e,"命的熱情活力與").concat(t,"命的穩重踏實形成很好的平衡，最近你們在生活規劃方面配合得很好。未來幾個月，").concat(e,"命會學會更多耐心，").concat(t,"命會增加更多活力，相互調節讓關係更加和諧。"),土金:"你們是穩固與精準的理想組合。".concat(e,"命的踏實基礎支撐著").concat(t,"命的理性規劃，最近你們在建立共同目標方面很有共識。接下來的發展中，你們會在穩中求進，").concat(e,"命提供安全感，").concat(t,"命提供方向感，是能夠長久發展的配對。"),金金:"你們是理性與理性的默契組合。雙方都很重視邏輯和規劃，最近在決策方面很有共識，但要注意增加感性的溝通。未來幾個月要學會表達情感，適度的浪漫會讓你們的關係更加溫馨。",木木:"你們是成長與成長的共振配對。雙方都很有上進心和學習精神，最近在共同發展方面很有動力，但要注意保持個人特色。接下來要學會欣賞差異，在相似中找到獨特性。",水水:"你們是智慧與智慧的深度結合。雙方都很善於溝通和理解，最近在心靈交流方面很有默契，但要注意增加行動力。未來要學會付諸實際行動，讓美好的想法變成現實。",火火:"你們是熱情與熱情的激烈碰撞。雙方都很有活力和行動力，最近在追求目標方面很有衝勁，但要注意控制情緒衝突。接下來要學會輪流領導，避免同時爆發造成摩擦。",土土:"你們是穩定與穩定的堅固組合。雙方都很踏實和可靠，最近在建立安全感方面很有成就，但要注意增加生活情趣。未來要學會創造驚喜，在穩定中保持新鮮感。"};return n[e+t]||n[t+e]||"你們的配對很特別，需要更多的理解和磨合，但正是這種差異讓你們能夠互相學習成長。"}static getCoupleFengShuiAdvice(e,t){let n=this.getCompatibilityScore(e,t);return n>=85?["共同居住空間以".concat(this.getCoupleMainColor(e,t),"為主色調，增強和諧能量"),"約會選擇".concat(this.getCoupleLocation(e,t),"，讓你們的能量更加契合"),"雙方可穿著互補色系：".concat(e,"命適合").concat(this.getElementColor(e),"，").concat(t,"命適合").concat(this.getElementColor(t))]:n>=75?["居家空間使用中性色調搭配各自喜好的顏色，維持和諧平衡","定期安排不同類型的約會活動，滿足雙方的不同需求","配飾選擇能增進溝通的物品，如對戒、情侶手鍊等增強連結"]:["居住環境多使用柔和的暖色調，緩解五行相剋的衝突","選擇大自然環境約會，讓自然能量調和你們的差異","雙方都需要學習對方五行的特質，穿著可互換對方代表色增進理解"]}static getCoupleMainColor(e,t){let n={金:"白色或淺色",木:"綠色或自然色",水:"藍色或深色",火:"紅色或暖色",土:"黃色或大地色"};return this.isGenerative(e,t)?"".concat(n[e],"和").concat(n[t],"的和諧搭配"):"溫馨的米白色或淺粉色"}static getCoupleLocation(e,t){let n={金:"咖啡廳、藝廊、音樂廳等精緻場所",木:"公園、森林、植物園等自然環境",水:"湖邊、海邊、溫泉等水域景點",火:"陽光充足的戶外、運動場、遊樂園",土:"溫馨的家庭餐廳、傳統建築、鄉村景點"};return"".concat(n[e],"或").concat(n[t])}static getElementColor(e){return({金:"白色、金色、銀色系",木:"綠色、棕色、自然色系",水:"藍色、黑色、深色系",火:"紅色、橙色、暖色系",土:"黃色、米色、大地色系"})[e]||"任何自己喜歡的顏色"}static isGenerative(e,t){return[["金","水"],["水","木"],["木","火"],["火","土"],["土","金"]].some(n=>n[0]===e&&n[1]===t||n[0]===t&&n[1]===e)}static getSpecificCategoryAdvice(e,t,n){switch(t){case"工作":return this.getSpecificWorkAdvice(e,n);case"財運":return this.getSpecificFinanceAdvice(e,n);case"健康":return this.getSpecificHealthAdvice(e,n);case"人際關係":return this.getSpecificRelationshipAdvice(e,n);case"子女":return this.getSpecificChildrenAdvice(e,n);case"因緣":return this.getSpecificFateAdvice(e,n);case"感情":return this.getSpecificLoveAdvice(e,n);default:return this.getGeneralWorkAdvice(e)}}static getSpecificFinanceAdvice(e,t){let n=t.toLowerCase();return n.includes("投資")||n.includes("理財")?this.getInvestmentAdvice(e):n.includes("存錢")||n.includes("儲蓄")?this.getSavingAdvice(e):n.includes("賺錢")||n.includes("收入")?this.getIncomeAdvice(e):this.getGeneralFinanceAdvice(e)}static getSpecificHealthAdvice(e,t){let n=t.toLowerCase();return n.includes("減肥")||n.includes("瘦身")?this.getWeightLossAdvice(e):n.includes("養生")||n.includes("保養")?this.getWellnessAdvice(e):n.includes("睡眠")||n.includes("失眠")?this.getSleepAdvice(e):this.getGeneralHealthAdvice(e)}static getSpecificRelationshipAdvice(e,t){let n=t.toLowerCase();return n.includes("朋友")||n.includes("交友")?this.getFriendshipAdvice(e):n.includes("同事")||n.includes("職場")?this.getWorkRelationshipAdvice(e):n.includes("家人")||n.includes("親情")?this.getFamilyAdvice(e):this.getGeneralRelationshipAdvice(e)}static getSpecificChildrenAdvice(e,t){let n=t.toLowerCase();return n.includes("教育")||n.includes("學習")?this.getEducationAdvice(e):n.includes("懷孕")||n.includes("生育")?this.getPregnancyAdvice(e):n.includes("親子")||n.includes("溝通")?this.getParentChildAdvice(e):this.getGeneralChildrenAdvice(e)}static getSpecificFateAdvice(e,t){let n=t.toLowerCase();return n.includes("機會")||n.includes("機遇")?this.getOpportunityAdvice(e):n.includes("貴人")||n.includes("幫助")?this.getBenefactorAdvice(e):n.includes("轉運")||n.includes("改運")?this.getLuckChangeAdvice(e):this.getGeneralFateAdvice(e)}static getSpecificLoveAdvice(e,t){let n=t.toLowerCase();return n.includes("桃花")||n.includes("脫單")?this.getPeachBlossomAdvice(e):n.includes("結婚")||n.includes("婚姻")?this.getMarriageAdvice(e):n.includes("復合")||n.includes("挽回")?this.getReconciliationAdvice(e):this.getGeneralLoveAdvice(e)}static getSpecificCoupleAdvice(e,t,n){let s=n.toLowerCase();return s.includes("結婚")||s.includes("婚姻")?this.getCoupleMarriageAdvice(e,t):s.includes("相處")||s.includes("溝通")?this.getCoupleHarmonyAdvice(e,t):s.includes("吵架")||s.includes("衝突")?this.getCoupleConflictAdvice(e,t):this.getGeneralCoupleAdvice(e,t)}static getInvestmentAdvice(e){return({金:"適合穩健型投資，關注金融、科技類股票或基金。",木:"適合成長型投資，關注新興行業和環保概念。",水:"適合靈活型投資，可考慮外匯或流動性較高的工具。",火:"適合積極型投資，但要控制風險避免過度激進。",土:"適合保守型投資，定期定額和房地產是好選擇。"})[e]||"根據自己的風險承受能力選擇適合的投資方式。"}static getSavingAdvice(e){return"".concat(e,"命的你適合制定長期儲蓄計劃，發揮你的特質優勢。")}static getIncomeAdvice(e){return"".concat(e,"命的你可以考慮發揮專業特長，開拓多元收入來源。")}static getGeneralFinanceAdvice(e){return"".concat(e,"命的你理財要發揮自身優勢，保持穩健策略。")}static getWeightLossAdvice(e){return"".concat(e,"命的你適合循序漸進的健康方式，配合適當運動。")}static getWellnessAdvice(e){return"".concat(e,"命的你要注重身心平衡，保持規律的養生習慣。")}static getSleepAdvice(e){return"".concat(e,"命的你要建立良好作息，創造適合的睡眠環境。")}static getGeneralHealthAdvice(e){return"".concat(e,"命的你要根據體質特點，選擇適合的保健方式。")}static getFriendshipAdvice(e){return"".concat(e,"命的你要發揮個人魅力，主動參與社交活動。")}static getFamilyAdvice(e){return"".concat(e,"命的你要多關心家人，保持溫馨的家庭關係。")}static getGeneralRelationshipAdvice(e){return"".concat(e,"命的你要真誠待人，建立良好的人際關係。")}static getEducationAdvice(e){return"".concat(e,"命的你適合因材施教，培養孩子的獨特才能。")}static getPregnancyAdvice(e){return"".concat(e,"命的你要保持身心健康，為迎接新生命做好準備。")}static getParentChildAdvice(e){return"".concat(e,"命的你要耐心溝通，建立親密的親子關係。")}static getGeneralChildrenAdvice(e){return"".concat(e,"命的你要用愛心陪伴，給孩子最好的成長環境。")}static getOpportunityAdvice(e){return"".concat(e,"命的你要保持敏銳觀察，積極把握人生機會。")}static getBenefactorAdvice(e){return"".concat(e,"命的你要廣結善緣，真誠待人將得到貴人相助。")}static getLuckChangeAdvice(e){return"".concat(e,"命的你要保持正面心態，用實際行動改善運勢。")}static getGeneralFateAdvice(e){return"".concat(e,"命的你要順應自然，把握當下創造美好因緣。")}static getPeachBlossomAdvice(e){return"".concat(e,"命的你要提升個人魅力，主動參與社交活動增加桃花運。")}static getMarriageAdvice(e){return"".concat(e,"命的你要認真經營感情，為美好的婚姻關係做好準備。")}static getReconciliationAdvice(e){return"".concat(e,"命的你要真誠反省，用行動證明改變的決心。")}static getGeneralLoveAdvice(e){return"".concat(e,"命的你要保持真實自我，用心經營美好的感情關係。")}static getCoupleMarriageAdvice(e,t){return"".concat(e,"命和").concat(t,"命的組合很有潛力，建議多溝通建立共同目標。")}static getCoupleHarmonyAdvice(e,t){return"".concat(e,"命要理解").concat(t,"命的特質，互相包容將讓關係更和諧。")}static getCoupleConflictAdvice(e,t){return"".concat(e,"命和").concat(t,"命都要冷靜溝通，尊重彼此差異化解衝突。")}static getGeneralCoupleAdvice(e,t){return"".concat(e,"命和").concat(t,"命要互相理解，發揮各自優勢共同成長。")}static getBasicSolution(e,t){return({工作:"".concat(e,"命適合在穩定的環境中發展，建議先完善基礎技能"),財運:"".concat(e,"命的你要穩健理財，避免高風險投資"),健康:"".concat(e,"命需要注意作息規律，多休息少熬夜"),感情:"".concat(e,"命要真誠待人，用行動表達關心"),人際關係:"".concat(e,"命適合主動社交，展現友善態度"),子女:"".concat(e,"命要用愛心陪伴，建立良好溝通"),因緣:"".concat(e,"命要保持正面心態，廣結善緣")})[t]||"".concat(e,"命的你要保持平衡，順應自然發展")}static getOpportunityHint(e,t){return({工作:"".concat(e,"命在秋季容易有突破機會"),財運:"".concat(e,"命適合在穩定期投資理財"),健康:"".concat(e,"命要把握調養身體的好時機"),感情:"".concat(e,"命的桃花運在人際活動中較旺"),人際關係:"".concat(e,"命容易在工作環境中遇到貴人"),子女:"".concat(e,"命與孩子的互動會有特殊收獲"),因緣:"".concat(e,"命要把握身邊的善緣機會")})[t]||"".concat(e,"命要敏銳觀察身邊機會")}static getCautionHint(e,t){return({工作:"".concat(e,"命要留意職場人際關係"),財運:"".concat(e,"命要謹慎處理金錢問題"),健康:"".concat(e,"命要注意身體警訊"),感情:"".concat(e,"命要避免情緒化溝通"),人際關係:"".concat(e,"命要真誠待人避免誤會"),子女:"".concat(e,"命要耐心引導不可急躁"),因緣:"".concat(e,"命要保持善念避免負面情緒")})[t]||"".concat(e,"命要保持理性判斷")}static getCoupleImprovementHint(e,t){return"".concat(e,"命和").concat(t,"命要增進溝通，建立共同目標")}static getCoupleStrengthHint(e,t){return"".concat(e,"命的穩定特質能平衡").concat(t,"命的特性")}static getCoupleOpportunityHint(e,t){return"".concat(e,"命和").concat(t,"命在秋冬季節感情容易升溫")}static getReportRecommendations(e){let t={工作:"工作",財運:"財運",健康:"健康",感情:"感情",人際關係:"人際關係",子女:"子女",因緣:"因緣"}[e]||"運勢";return"\n\n───────────────────\n\uD83D\uDC8E **想要更深入的分析嗎？**\n根據你的狀況，風鈴為你推薦：\n\n**1️⃣ 一份關於".concat(t,"的詳細報告** 價值$38\n深入分析你的").concat(t,"運勢，提供具體建議和改善方案\n\n**2️⃣ 一份綜合命理報告** 價值$88\n全面的八字命盤分析，包含各方面運勢預測\n\n**3️⃣ 一份居家佈局報告** 價值$188\n用居家佈局增強運勢，打造專屬風水空間\n\n請回覆「1」、「2」或「3」選擇你想要的報告～")}static getCoupleReportRecommendations(){return"\n\n───────────────────\n\uD83D\uDC8E **想要更深入的分析嗎？**\n根據你們的狀況，風鈴為你們推薦：\n\n**1️⃣ 一份關於合盤的詳細報告** 價值$88\n深入分析你們的感情配對度，提供具體建議和改善方案\n\n**2️⃣ 一份綜合命理報告** 價值$88\n全面的八字命盤分析，包含各方面運勢預測\n\n**3️⃣ 一份居家佈局報告** 價值$188\n用居家佈局增強運勢，打造專屬風水空間\n\n請回覆「1」、「2」或「3」選擇你想要的報告～"}}let _=e=>{let{user:t,analysisData:n,gender:l,colorScheme:r,userAnalysis:c}=e,{individualAnalysisCache:o,setIndividualAnalysisCache:d}=m(),[u,g]=(0,a.useState)(null),[h,x]=(0,a.useState)(null),[p,f]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e="".concat(null==t?void 0:t.birthDateTime,"_").concat(l);if(o[e]){console.log("\uD83D\uDCCB Using cached individual analysis for ".concat(l));let t=o[e];g(t.baziData),x(t.analysis),f(!1);return}(async()=>{if(!(null==t?void 0:t.birthDateTime)){f(!1);return}try{let e=new Date(t.birthDateTime),n=O.calculateBazi(e);g(n);let s=null;try{let e=new AbortController,a=setTimeout(()=>{e.abort(),console.log("⏰ Individual analysis API call for ".concat(l," timed out after 45 seconds"))},45e3),i=await fetch("/api/individual-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({birthDateTime:t.birthDateTime,dominantElement:(null==c?void 0:c.dominantElement)||n.yearElement,category:"感情",specificQuestion:"請以專業、結構化的方式分析".concat(l,"的八字特性，包含：\n1. 性格特性：").concat((null==c?void 0:c.dominantElement)||n.yearElement,"命的核心性格特質\n2. 主要優勢：在感情關係中的3個主要個人優勢（如：溝通能力強、責任心重、善於理解他人等個人特質，不要包含風水建議或外在建議）\n3. 發展建議：3個具體的感情發展建議（可包含行為建議、溝通方式、注意事項等）\n請避免使用角色扮演、表情符號或過於口語化的表達方式，保持專業分析風格。主要優勢請聚焦於個人內在特質，發展建議可包含具體行動指導。"),gender:l}),signal:e.signal});if(clearTimeout(a),i.ok){let e=await i.json();s=b(e.aiAnalysis,n)}else console.log("API call failed, using basic analysis")}catch(e){"AbortError"===e.name?console.log("⏰ Individual analysis API call for ".concat(l," was aborted due to timeout")):console.log("AI analysis failed, using basic analysis:",e)}let a=s||y(n,c);x(a);let i="".concat(null==t?void 0:t.birthDateTime,"_").concat(l);d(e=>({...e,[i]:{baziData:n,analysis:a}})),console.log("\uD83D\uDCBE Cached individual analysis for ".concat(l)),f(!1)}catch(e){console.error("Error generating individual analysis:",e),f(!1)}})()},[t,c,l]);let b=(e,t)=>{if(console.log("\uD83D\uDD0D Parsing AI analysis for ".concat(l,":"),e),!e||"string"!=typeof e)return console.log("⚠️ Invalid AI text, using basic analysis"),{characteristics:v(t),strengths:j(t),suggestions:N(t),pillarsAnalysis:w(t)};let n=e.replace(/✨|🌙|💖|🎯|🔍|💡|🌱|～|~|唷|啦|哦|呢|⚠️|🌸|💑|💞|💧/g,"").replace(/風鈴[^。！？]*[。！？]/g,"").replace(/叮鈴鈴.*$/g,"").replace(/解鎖.*報告.*$/gm,"").replace(/嗨～.*風水師.*～/g,"").replace(/以上分析基於.*$/gm,"").split(/[。！？\n]/).filter(e=>e.trim()&&e.length>10),s="",a=[],i=[],r="";for(let e=0;e<n.length;e++){let t=n[e].trim();if(!t||t.includes("風鈴")||t.includes("解鎖")||t.includes("專屬")||t.includes("偷偷告訴")||t.includes("小人煞")||t.includes("桃花位")||t.includes("約會方式")||t.includes("約會秘訣")||t.includes("魅力提升")||t.includes("居家桃花位")||t.includes("佩戴")||t.includes("放置")||t.includes("客廳")||t.includes("東南")||t.includes("粉水晶")||t.includes("綠植")||t.includes("換水")||t.includes("藍色飾品")||t.includes("水克火")||t.includes("玻璃花瓶")||t.includes("鮮花")||t.includes("珍珠飾品")||t.includes("薄荷香包")||t.includes("流年氣場")||t.match(/^\*{1,3}\d+\./)||t.length<10)continue;if(t.includes("特性")||t.includes("性格")||t.includes("個性")||t.includes("問題核心")){r="characteristics";let e=t.replace(/.*特性|.*性格|.*個性|.*問題核心[：:]*/,"").replace(/^[：:]+/,"").trim();e.length>10&&(s+=e+" ");continue}if(t.includes("優勢")||t.includes("長處")||t.includes("強項")||t.includes("成就")){r="strengths";continue}if(t.includes("建議")||t.includes("注意")||t.includes("發展")||t.includes("解決方向")){r="suggestions";continue}let l=t.replace(/^[*•\-\d\.①②③]+\s*/,"").replace(/^[：:]+/,"").trim();if(l.length>10){let e=l.includes("時機")||l.includes("解鎖")||l.includes("佩戴")||l.includes("放置")||l.includes("客廳")||l.includes("東南")||l.includes("選擇")||l.includes("水邊")||l.includes("散步")||l.includes("傾聽")||l.includes("幽默")||l.includes("藍色系")||l.includes("衣著")||l.includes("週三")||l.includes("戶外活動")||l.includes("氣場")||l.includes("溪流")||l.includes("工作壓力")||l.includes("書店")||l.includes("咖啡廳");switch(r){case"characteristics":l.includes("時機")||l.includes("時辰")||l.includes("閃耀")||(s+=l+" ");break;case"strengths":!e&&(l.includes("能力")||l.includes("才能")||l.includes("優點")||l.includes("特質")||l.includes("長處")||l.includes("強項"))?a.push(l):e&&i.push(l);break;case"suggestions":l.includes("時機")||l.includes("解鎖")||!(l.length>15)||i.push(l);break;default:!s&&l.length>20&&!l.includes("時機")&&!l.includes("解鎖")&&(l.includes("性格")||l.includes("特質")||l.includes("命"))&&(s+=l+" ")}}}let c=s.trim()||v(t),o=a.length>0?a.slice(0,3):[],d=i.length>0?i.slice(0,3):[];return 0===o.length&&(o=j(t)),0===d.length&&(d=N(t)),console.log("✅ Parsed analysis for ".concat(l,":"),{characteristics:c.substring(0,100)+"...",strengthsCount:o.length,suggestionsCount:d.length}),{characteristics:c,strengths:o,suggestions:d,pillarsAnalysis:w(t)}},y=(e,t)=>({characteristics:(null==t?void 0:t.characteristics)||v(e),strengths:j(e),suggestions:N(e),pillarsAnalysis:w(e)}),v=e=>({金:"具有堅毅果決的性格，重信守義，善於分析判斷。做事有條理，追求完美，但有時過於挑剔。",木:"性格積極進取，富有創意和想象力。善於成長和適應，具有仁慈之心，但有時缺乏耐性。",水:"機智靈活，善於變通和適應環境。直覺敏銳，善於觀察，但有時過於敏感或情緒化。",火:"熱情開朗，富有魅力和感染力。積極主動，善於表達，但有時過於急躁或衝動。",土:"踏實穩重，值得信賴。有責任心，善於照顧他人，但有時過於保守或固執。"})[e.yearElement]||"性格特質分析中...",j=e=>({金:["決策能力強，能在關係中提供穩定支持","有領導才能，善於處理感情中的實際問題","注重細節，對伴侶的需求觀察入微"],木:["創新能力強，為關係注入新鮮活力","適應力佳，能靈活應對感情變化","有成長潛力，願意為愛情持續進步"],水:["溝通能力佳，善於表達內心感受","直覺敏銳，能察覺伴侶的情緒變化","善於變通，在關係中懂得適時退讓"],火:["感染力強，能帶動伴侶的積極情緒","積極進取，為關係發展提供動力","善於表達，能讓對方感受到愛意"],土:["穩定可靠，是伴侶可以依靠的支柱","有責任心，對感情認真負責","善於協調，能化解關係中的矛盾"]})[e.yearElement]||["具備獨特的感情優勢，值得深入發掘"],N=e=>({金:["在感情中保持開放心態，接納對方的不同想法","增強靈活性，避免過於固執己見","培養耐心，給予關係更多時間發展"],木:["加強專注力，避免在感情中三心二意","培養持續性，為長期關係做好準備","注重實際行動，用行動證明愛意"],水:["增強穩定性，避免情緒波動影響關係","培養決斷力，在重要時刻能做出明確選擇","加強目標設定，與伴侶共同規劃未來"],火:["培養冷靜思考，避免衝動傷害感情","增強持續力，保持對關係的長期投入","注重細節處理，關注伴侶的小需求"],土:["增強變通能力，在關係中保持適度彈性","培養創新思維，為感情注入新鮮元素","擴展視野，與伴侶一起探索更廣闊的世界"]})[e.yearElement]||["持續在感情中自我完善，創造更美好的關係"],w=e=>({年柱:{title:"年柱-".concat(e.year),subtitle:S(e.year,"年"),description:C(e.year,"年","祖業根基，早年環境")},月柱:{title:"月柱-".concat(e.month),subtitle:S(e.month,"月"),description:C(e.month,"月","父母宮位，中年發展")},日柱:{title:"日柱-".concat(e.day),subtitle:S(e.day,"日"),description:C(e.day,"日","自身性格，配偶關係")},時柱:{title:"時柱-".concat(e.hour),subtitle:S(e.hour,"時"),description:C(e.hour,"時","子女宮位，晚年運勢")}}),S=(e,t)=>({年:"祖業基礎，早年環境影響深遠",月:"父母影響，成長期性格形成",日:"本命特質，核心性格展現",時:"未來發展，晚年運勢趨向"})[t]+"（".concat(e,"）"),C=(e,t,n)=>{let s=e.charAt(0);return"".concat(n,"：").concat({木:"生機勃勃，具有成長和創新的能力",火:"熱情活躍，具有領導和表達的天賦",土:"穩重踏實，具有包容和協調的特質",金:"堅毅果決，具有分析和執行的能力",水:"靈活變通，具有智慧和適應的本領"}[({甲:"木",乙:"木",丙:"火",丁:"火",戊:"土",己:"土",庚:"金",辛:"金",壬:"水",癸:"水"})[s]||"土"],"，").concat(e,"組合顯示良好的發展潛力。")};return p?(0,s.jsx)("div",{className:"p-6 mb-6 bg-white rounded-lg shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsxs)("span",{className:"ml-3 text-gray-600",children:["分析",l,"八字中..."]})]})}):u&&h?(0,s.jsxs)("div",{className:"bg-white rounded-[30px] shadow-md p-8 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,s.jsx)("h3",{className:"text-4xl font-bold ".concat("pink"===r?"text-[#C74772]":"text-[#4A90E2]"),style:{fontFamily:"Noto Serif TC"},children:l}),(0,s.jsx)("div",{className:"px-6 py-2 rounded-full border-2 ".concat("pink"===r?"border-[#C74772] text-[#C74772]":"border-[#4A90E2] text-[#4A90E2]"),children:(0,s.jsx)("span",{className:"text-lg font-medium",style:{fontFamily:"Noto Sans HK"},children:t.birthDateTime})})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4 mb-8 md:grid-cols-2 lg:grid-cols-4",children:Object.entries(h.pillarsAnalysis).map(e=>{let[t,n]=e;return(0,s.jsxs)("div",{className:"overflow-hidden bg-gray-100 rounded-lg",children:[(0,s.jsxs)("div",{className:"p-4 text-center text-white ".concat("pink"===r?"bg-[#C74772]":"bg-[#4A90E2]"),children:[(0,s.jsx)("h4",{className:"text-lg font-bold",style:{fontFamily:"Noto Sans HK"},children:t}),(0,s.jsx)("p",{className:"text-sm opacity-90",style:{fontFamily:"Noto Sans HK"},children:n.title.split("-")[1]})]}),(0,s.jsxs)("div",{className:"p-4 bg-gray-100",children:[(0,s.jsx)("p",{className:"mb-2 text-sm leading-relaxed text-gray-700",style:{fontFamily:"Noto Sans HK"},children:n.subtitle}),(0,s.jsx)("p",{className:"text-xs leading-relaxed text-gray-600",style:{fontFamily:"Noto Sans HK"},children:n.description})]})]},t)})}),(0,s.jsxs)("div",{className:"rounded-[20px] p-6 ".concat("pink"===r?"bg-pink-50":"bg-blue-50"),children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("div",{className:"inline-block px-4 py-2 border-2 border-[#C74772] rounded-full mb-4",children:(0,s.jsxs)("h4",{className:"text-lg font-semibold text-[#C74773]",style:{fontFamily:"Noto Sans HK"},children:[l,null==c?void 0:c.elementType,"特性"]})})}),(0,s.jsx)("div",{className:"p-4 mb-4 bg-white rounded-lg",children:(0,s.jsx)("p",{className:"text-base leading-relaxed text-black",style:{fontFamily:"Noto Sans HK"},children:h.characteristics})}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"p-4 bg-white rounded-lg",children:[(0,s.jsx)("h5",{className:"mb-3 text-lg font-semibold text-gray-800",style:{fontFamily:"Noto Sans HK"},children:"主要優勢："}),(0,s.jsx)("ul",{className:"space-y-2",children:h.strengths.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-center gap-3 text-sm text-gray-700",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("pink"===r?"bg-[#C74772]":"bg-[#4A90E2]")}),(0,s.jsx)("span",{style:{fontFamily:"Noto Sans HK"},children:"string"==typeof e?e:e.replace(/^[•\-\*]\s*/,"")})]},t))})]}),(0,s.jsxs)("div",{className:"p-4 bg-white rounded-lg",children:[(0,s.jsx)("h5",{className:"mb-3 text-lg font-semibold text-gray-800",style:{fontFamily:"Noto Sans HK"},children:"發展建議："}),(0,s.jsx)("ul",{className:"space-y-2",children:h.suggestions.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-center gap-3 text-sm text-gray-700",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("pink"===r?"bg-[#C74772]":"bg-[#4A90E2]")}),(0,s.jsx)("span",{style:{fontFamily:"Noto Sans HK"},children:"string"==typeof e?e:e.replace(/^[•\-\*]\s*/,"")})]},t))})]})]})]})]}):(0,s.jsx)("div",{className:"p-6 mb-6 bg-white rounded-lg shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-center justify-center text-gray-500",children:[(0,s.jsx)(i.A,{className:"w-6 h-6 mr-2"}),l,"八字分析暫無數據"]})})},z=e=>{let{user1:t,user2:n,calculateWuxingAnalysis:l,analyzeWuxingStrength:r,determineUsefulGods:c}=e,{analysisData:o,loading:d,error:u,annualAnalysisCache:g,setAnnualAnalysisCache:h}=m(),[x,p]=(0,a.useState)(null),[f,b]=(0,a.useState)(!0);(0,a.useEffect)(()=>{if(g){console.log("\uD83D\uDCCB Using cached annual analysis"),p(g),b(!1);return}(async()=>{if(o){var e,s,a,l,i;let r=w(t.birthDateTime,t.gender),c=w(n.birthDateTime,n.gender),d=await v(t,n,r,c,o),m=D(r,c);console.log("CoupleAnnualAnalysis compatibility calculation:",{user1Element:null==r?void 0:r.dayMasterElement,user2Element:null==c?void 0:c.dayMasterElement,calculatedScore:m,apiScore:null===(e=o.compatibility)||void 0===e?void 0:e.score,finalScore:parseInt(null===(s=o.compatibility)||void 0===s?void 0:s.score)||m});let u={compatibility:{score:parseInt(null===(a=o.compatibility)||void 0===a?void 0:a.score)||m,level:(null===(l=o.compatibility)||void 0===l?void 0:l.level)||k(m),description:(null===(i=o.compatibility)||void 0===i?void 0:i.description)||"姻緣分析中..."},user1Analysis:{dominantElement:(null==r?void 0:r.dayMasterElement)||"未知",elementType:T(null==r?void 0:r.dayMasterElement),characteristics:B(null==r?void 0:r.dayMasterElement)},user2Analysis:{dominantElement:(null==c?void 0:c.dayMasterElement)||"未知",elementType:T(null==c?void 0:c.dayMasterElement),characteristics:B(null==c?void 0:c.dayMasterElement)},elementInteraction:C(null==r?void 0:r.dayMasterElement,null==c?void 0:c.dayMasterElement,o),annualStrategy:d};p(u),h(u),console.log("\uD83D\uDCBE Cached annual analysis for future use"),b(!1)}else d||o||y()})()},[o,d,t,n]);let y=()=>{let e=w(t.birthDateTime,t.gender),s=w(n.birthDateTime,n.gender);if(!e||!s){b(!1);return}let a=D(e,s),l={compatibility:{score:a,level:k(a),description:"基於八字基礎分析的配對評估"},user1Analysis:{dominantElement:e.dayMasterElement,elementType:T(e.dayMasterElement),characteristics:B(e.dayMasterElement)},user2Analysis:{dominantElement:s.dayMasterElement,elementType:T(s.dayMasterElement),characteristics:B(s.dayMasterElement)},elementInteraction:C(e.dayMasterElement,s.dayMasterElement),annualStrategy:j(e.dayMasterElement,s.dayMasterElement)};p(l),h(l),console.log("\uD83D\uDCBE Cached fallback annual analysis"),b(!1)},v=async(e,t,n,s,a)=>{try{let l=new Date().getFullYear(),i=new Date().getMonth()+1,r=new AbortController,c=setTimeout(()=>{r.abort(),console.log("⏰ Annual analysis API call timed out after 60 seconds")},6e4),o=await fetch("/api/couple-annual-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user1Birthday:e.birthDateTime,user2Birthday:t.birthDateTime,user1Element:null==n?void 0:n.dominantElement,user2Element:null==s?void 0:s.dominantElement,currentYear:l,nextYear:l+1,currentMonth:i,compatibilityData:a.compatibility,requestType:"annual_strategy"}),signal:r.signal});if(clearTimeout(c),o.ok)return(await o.json()).annualStrategy}catch(e){"AbortError"===e.name?console.log("⏰ Annual insights API call was aborted due to timeout"):console.error("Error generating annual insights:",e)}return j(null==n?void 0:n.dominantElement,null==s?void 0:s.dominantElement)},j=(e,t)=>{let n=new Date().getFullYear(),s=n+1,a=N(e,t,n,s,new Date().getMonth()+1);return{[n]:{title:"".concat(n,"年感情運勢"),description:S(e,t,n),monthlyFocus:a[n]},[s]:{title:"".concat(s,"年關鍵應對策略"),description:S(e,t,s),monthlyFocus:a[s]}}},N=(e,t,n,s,a)=>{let l={金:{caution:"避免重大決定，適合內省和規劃",positive:"財運旺盛，適合投資和事業發展",travel:"可安排短途旅行放鬆心情"},木:{caution:"注意人際關係，避免衝突",positive:"創意豐富，適合開展新項目",travel:"適合戶外活動和自然之旅"},水:{caution:"財務需謹慎，避免大額支出",positive:"直覺敏銳，適合重要決策",travel:"適合水邊休閒和養生之旅"},火:{caution:"情緒易波動，需要冷靜處理",positive:"人際關係活躍，適合社交活動",travel:"適合熱鬧的聚會和慶典"},土:{caution:"健康需要關注，工作壓力較大",positive:"穩定發展，適合長期規劃",travel:"適合田園風光和文化之旅"}},i=function(n,s){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=l[a?e:t]||l["土"];return n<=4?i.caution:n<=8?i.positive:i.travel};return{[n]:a<=4?"".concat(n,"年").concat(a,"月，").concat(i(a,n)):"".concat(n,"年下半年，").concat(i(a,n)),[s]:"".concat(s,"年，").concat(i(6,s),"，建議提前設立共同儲備金")}},S=(e,t,n)=>{let s={金水:"金水相生，感情和諧穩定",水木:"水木相生，關係持續成長",木火:"木火相生，熱情洋溢",火土:"火土相生，感情踏實穩固",土金:"土金相生，相互支持",金火:"金火相剋，需要調和",火水:"水火不容，需要包容",水土:"水土相剋，需要理解",土木:"土木相剋，需要溝通",木金:"金克木，需要平衡"},a="".concat(e).concat(t),l="".concat(t).concat(e);return s[a]||s[l]||"需要相互調適，增進理解"},C=(e,t,n)=>{var s,a;return{interaction:(null==n?void 0:null===(s=n.compatibility)||void 0===s?void 0:s.description)||"".concat(e,"命與").concat(t,"命的相互作用"),balance:E(e,t),missing:F(e,t),advice:(null==n?void 0:null===(a=n.advice)||void 0===a?void 0:a[0])||A(e,t)}},E=(e,t)=>{let n={金:"水",水:"木",木:"火",火:"土",土:"金"},s={金:"木",木:"土",土:"水",水:"火",火:"金"};return n[e]===t||n[t]===e?"五行相生，關係和諧平衡":s[e]===t||s[t]===e?"五行相剋，需要調和平衡":"五行平和，關係穩定"},F=(e,t)=>{let n=[e,t],s=["金","木","水","火","土"].filter(e=>!n.includes(e));return s.length>0?"建議增強".concat(s.join("、"),"元素來完善五行平衡"):"五行元素齊全，建議保持平衡"},A=(e,t)=>"".concat(e,"命與").concat(t,"命的配對，建議在日常生活中注重五行調和，增進相互理解"),D=(e,t)=>{var n;let s=e.dayMasterElement,a=t.dayMasterElement;return(null===(n=({金:{金:70,木:40,水:85,火:35,土:80},木:{金:40,木:75,水:80,火:85,土:45},水:{金:85,木:80,水:70,火:30,土:50},火:{金:35,木:85,水:30,火:75,土:80},土:{金:80,木:45,水:50,火:80,土:70}})[s])||void 0===n?void 0:n[a])||60},k=e=>e>=80?"優秀配對":e>=70?"良好配對":e>=60?"穩定配對":"需要努力",T=e=>({金:"金命",木:"木命",水:"水命",火:"火命",土:"土命"})[e]||"未知命格",B=e=>({金:"堅毅果決，重信守義",木:"積極進取，富有創意",水:"機智靈活，善於變通",火:"熱情開朗，富有魅力",土:"踏實穩重，值得信賴"})[e]||"性格特質分析中";if(f)return(0,s.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-3 text-gray-600",children:"生成流年分析中..."})]}),(0,s.jsx)("div",{className:"mt-4 text-xs text-center text-gray-500",children:"如果載入時間過長，請檢查網路連線或稍後重試"})]});if(u){var P,I;return(0,s.jsx)("div",{className:"p-6 bg-white rounded-lg shadow-sm",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full",children:(0,s.jsx)(i.A,{className:"w-8 h-8 text-red-600"})}),(0,s.jsx)("h3",{className:"mb-2 text-lg font-semibold text-gray-900",children:"年度分析載入失敗"}),(0,s.jsx)("p",{className:"mb-4 text-sm text-gray-600",children:(null==u?void 0:null===(P=u.message)||void 0===P?void 0:P.includes("timeout"))||(null==u?void 0:null===(I=u.message)||void 0===I?void 0:I.includes("fetch"))?"請求超時或網路連線問題，請稍後重試。":"載入年度分析時發生錯誤，請重新嘗試。"}),(0,s.jsxs)("p",{className:"mb-6 text-xs text-gray-500",children:["錯誤詳情: ",(null==u?void 0:u.message)||"未知錯誤"]})]}),(0,s.jsxs)("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-pink-600 border border-transparent rounded-md shadow-sm hover:bg-pink-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"重新嘗試"]}),(0,s.jsxs)("div",{className:"mt-4 text-xs text-gray-500",children:[(0,s.jsx)("p",{children:"\uD83D\uDCA1 提示：如果問題持續發生，請嘗試："}),(0,s.jsxs)("ul",{className:"mt-2 text-left list-disc list-inside",children:[(0,s.jsx)("li",{children:"檢查網路連線是否正常"}),(0,s.jsx)("li",{children:"重新整理瀏覽器頁面"}),(0,s.jsx)("li",{children:"清除瀏覽器快取"}),(0,s.jsx)("li",{children:"稍後再試"})]})]})]})})}if(!x)return(0,s.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center text-gray-500",children:[(0,s.jsx)(i.A,{className:"w-6 h-6 mr-2"}),"暫無流年分析數據"]}),(0,s.jsx)("div",{className:"mt-4 text-center",children:(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-pink-600 border border-pink-300 rounded-md hover:bg-pink-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500",children:"重新載入"})})]});let{compatibility:M,user1Analysis:O,user2Analysis:z,elementInteraction:R,annualStrategy:G}=x;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-6 p-6 lg:flex-row",children:[(0,s.jsx)("div",{className:"flex items-center justify-center py-8 lg:w-1/3",children:(0,s.jsx)("div",{className:"relative",children:(0,s.jsxs)("div",{className:"relative w-80 h-80",children:[(0,s.jsxs)("svg",{className:"transform -rotate-90 w-80 h-80",viewBox:"0 0 100 100",children:[(0,s.jsx)("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"6"}),(0,s.jsx)("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"url(#gradient)",strokeWidth:"6",strokeLinecap:"round",strokeDasharray:"".concat(251.2*M.score/100," 251.2"),className:"transition-all duration-1000 ease-out"}),(0,s.jsx)("defs",{children:(0,s.jsxs)("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,s.jsx)("stop",{offset:"0%",stopColor:"#ec4899"}),(0,s.jsx)("stop",{offset:"50%",stopColor:"#f97316"}),(0,s.jsx)("stop",{offset:"100%",stopColor:"#eab308"})]})})]}),(0,s.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,s.jsx)("span",{className:"font-bold text-8xl text-amber-600",children:M.score}),(0,s.jsx)("span",{className:"mt-2 text-lg font-medium text-gray-600",children:M.level})]})]})})}),(0,s.jsxs)("div",{className:"flex flex-col gap-6 lg:w-2/3",children:[(0,s.jsxs)("div",{className:"p-4 border-2 border-gray-200 rounded-full shadow-md bg-gradient-to-r from-pink-50 to-blue-50",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-3 mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-pink-100 rounded-full",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-6 h-6 text-sm font-bold text-white bg-pink-500 rounded-full",children:O.dominantElement}),(0,s.jsx)("span",{className:"text-sm font-semibold text-pink-600",children:O.elementType})]}),(0,s.jsx)("div",{className:"text-xl font-bold text-gray-400",children:"+"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-blue-100 rounded-full",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-6 h-6 text-sm font-bold text-white bg-blue-500 rounded-full",children:z.dominantElement}),(0,s.jsx)("span",{className:"text-sm font-semibold text-blue-600",children:z.elementType})]}),(0,s.jsx)("div",{className:"text-xl font-bold text-gray-400",children:"="}),(0,s.jsx)("div",{className:"px-4 py-2 bg-gray-100 rounded-full",children:(0,s.jsx)("span",{className:"text-sm font-semibold text-gray-700",children:((e,t)=>{if(e===t)return"五行".concat(e,"重疊");let n=[e,t],s=["金","木","水","火","土"].filter(e=>!n.includes(e)),a={金:"水",水:"木",木:"火",火:"土",土:"金"},l={金:"木",木:"土",土:"水",水:"火",火:"金"};return a[e]===t||a[t]===e?s.length>0?"相生配對(缺".concat(s.join("、"),")"):"五行相生":l[e]===t||l[t]===e?s.length>0?"相剋配對(缺".concat(s.join("、"),")"):"五行相剋":s.length>0?"平和配對(缺".concat(s.join("、"),")"):"五行平和"})(O.dominantElement,z.dominantElement)})})]}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-600",children:R.balance})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-[30px] shadow-md p-8",children:[(0,s.jsx)("div",{className:"mb-6 text-start",children:(0,s.jsx)("h3",{className:"text-4xl font-bold bg-gradient-to-r from-[#C74772] to-[#D09900] bg-clip-text text-transparent",style:{fontFamily:"Noto Serif TC",fontSize:"35px"},children:"2025&2026流年關鍵應對策略"})}),(0,s.jsx)("div",{className:"flex justify-between gap-6",children:Object.entries(G).map((e,t)=>{let[n,a]=e;return(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"bg-[#E7E7E7] rounded-lg p-4",children:[(0,s.jsx)("div",{className:"mb-3 text-center",children:(0,s.jsx)("div",{className:"inline-block px-4 py-2 border-2 border-[#C74772] rounded-full",children:(0,s.jsx)("h4",{className:"text-sm font-semibold text-[#C74773]",style:{fontFamily:"Noto Sans HK"},children:"2025"===n?"2025年九月":"2026年"})})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-sm leading-relaxed text-black",style:{fontFamily:"Noto Sans HK"},children:a.monthlyFocus})})]})},n)})})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-[30px] shadow-md p-8",children:[(0,s.jsx)("div",{className:"mb-6 text-start",children:(0,s.jsx)("h3",{className:"text-4xl font-bold bg-gradient-to-r from-[#C74772] to-[#D09900] bg-clip-text text-transparent",style:{fontFamily:"Noto Serif TC",fontSize:"35px"},children:"五行互動分析"})}),(0,s.jsxs)("div",{className:"flex justify-between gap-6",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"bg-[#E7E7E7] rounded-lg p-4",children:[(0,s.jsx)("div",{className:"mb-3 text-center",children:(0,s.jsx)("div",{className:"inline-block px-4 py-2 border-2 border-[#C74772] rounded-full",children:(0,s.jsx)("h4",{className:"text-sm font-semibold text-[#C74773]",style:{fontFamily:"Noto Sans HK"},children:"元素互動"})})}),(0,s.jsxs)("div",{className:"space-y-2 text-center",children:[(0,s.jsx)("p",{className:"text-sm leading-relaxed text-black",style:{fontFamily:"Noto Sans HK"},children:R.balance}),(0,s.jsx)("p",{className:"text-xs leading-relaxed text-black",style:{fontFamily:"Noto Sans HK"},children:R.missing})]})]})}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"bg-[#E7E7E7] rounded-lg p-4",children:[(0,s.jsx)("div",{className:"mb-3 text-center",children:(0,s.jsx)("div",{className:"inline-block px-4 py-2 border-2 border-[#C74772] rounded-full",children:(0,s.jsx)("h4",{className:"text-sm font-semibold text-[#C74773]",style:{fontFamily:"Noto Sans HK"},children:"關係建議"})})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-sm leading-relaxed text-black",style:{fontFamily:"Noto Sans HK"},children:R.advice})})]})})]})]}),x&&(0,s.jsx)(_,{user:t,analysisData:o,gender:"male"===t.gender?"男方":"女方",colorScheme:"male"===t.gender?"blue":"pink",userAnalysis:x.user1Analysis}),x&&(0,s.jsx)(_,{user:n,analysisData:o,gender:"male"===n.gender?"男方":"女方",colorScheme:"male"===n.gender?"blue":"pink",userAnalysis:x.user2Analysis})]})};var R=n(92138);let G=e=>{let{explanation:t,index:n}=e,a=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=t?e.fromGod:e.toGod;return n.includes("女方")?"#C74772":n.includes("男方")?"#4B6EB2":t?"#C74772":"#4B6EB2"};return(0,s.jsxs)("div",{className:"space-y-4 ",children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"px-10 py-2 text-lg font-medium text-white rounded-full",style:{backgroundColor:a(t,!0)},children:t.fromGod||"女方金偏印"}),(0,s.jsx)(R.A,{className:"w-6 h-6 text-gray-400"}),(0,s.jsx)("div",{className:"px-10 py-2 text-lg font-medium text-white rounded-full",style:{backgroundColor:a(t,!1)},children:t.toGod||"男方己土食神"})]})}),(0,s.jsx)("div",{className:"bg-[#EFEFEF] shadow-lg p-4 rounded-lg",children:(0,s.jsxs)("div",{className:"text-black",children:[(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h3",{className:"mb-2 text-lg font-semibold text-gray-800",children:"互動分析"}),(0,s.jsx)("div",{className:"leading-relaxed text-gray-700",children:t.interaction||"分析中..."})]}),t.keyIssues&&(0,s.jsxs)("div",{className:"py-2 pl-4 mt-3 border-l-4 border-orange-400 rounded-r-lg bg-orange-50",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-orange-600",children:"關鍵要點"}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-700",children:t.keyIssues})]})]})}),(0,s.jsx)("div",{className:"bg-[#EFEFEF] shadow-lg p-4 rounded-lg",children:(0,s.jsxs)("div",{className:"text-black",children:[(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h3",{className:"mb-2 text-lg font-semibold text-gray-800",children:"相互影響"}),t.effects?(0,s.jsx)("div",{className:"leading-relaxed text-gray-700",children:t.effects}):(0,s.jsx)("div",{className:"leading-relaxed text-gray-700",children:t.interaction?"這種".concat(t.fromGod,"與").concat(t.toGod,"的互動，會在雙方關係中產生深層的相互影響，需要特別注意平衡和調和。"):"相互影響分析中..."})]}),t.problems&&t.problems.length>0&&(0,s.jsxs)("div",{className:"py-2 pl-4 mt-3 border-l-4 border-red-400 rounded-r-lg bg-red-50",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-red-600",children:"潛在問題"}),(0,s.jsx)("div",{className:"space-y-1",children:t.problems.map((e,t)=>(0,s.jsxs)("p",{className:"text-sm leading-relaxed text-gray-700",children:["• ",e]},t))})]}),t.solution&&(0,s.jsxs)("div",{className:"py-2 pl-4 mt-3 border-l-4 border-green-400 rounded-r-lg bg-green-50",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-green-600",children:"化解之道"}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-700",children:t.solution})]})]})})]})},H=e=>{let{user1:t,user2:n}=e,{analysisData:l,godAnalysisCache:i,setGodAnalysisCache:r}=m(),[c,o]=(0,a.useState)([]),[d,u]=(0,a.useState)(!0),[g,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(i){console.log("\uD83D\uDCCB Using cached god analysis"),o(i),u(!1);return}(async()=>{if(!(null==t?void 0:t.birthDateTime)||!(null==n?void 0:n.birthDateTime)){h("缺少生辰資料"),u(!1);return}try{let e=await x(t,n,l);o(e),r(e),console.log("\uD83D\uDCBE Cached god analysis for future use"),u(!1)}catch(e){console.error("Error generating god explanations:",e),h("分析生成失敗"),u(!1)}})()},[t,n,l]);let x=async(e,t,n)=>{try{let s=await fetch("/api/couple-god-analysis",{method:"POST",headers:{"Content-Type":"application/json","Cache-Control":"no-cache"},body:JSON.stringify({user1Birthday:e.birthDateTime,user2Birthday:t.birthDateTime,user1Name:e.name||"男方",user2Name:t.name||"女方",compatibilityData:n,analysisType:"ten_gods_interaction",timestamp:Date.now()})});if(!s.ok)throw Error("API request failed");return(await s.json()).godExplanations||[]}catch(e){throw console.error("API call failed:",e),e}};return d?(0,s.jsx)("div",{className:"min-h-screen p-6 bg-gray-50",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsxs)("div",{className:"flex items-center justify-center py-20",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-3 text-gray-600",children:"正在生成十神互動精微解讀..."})]})})}):g?(0,s.jsx)("div",{className:"min-h-screen p-6 bg-gray-50",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsxs)("div",{className:"py-20 text-center",children:[(0,s.jsx)("div",{className:"mb-4 text-red-500",children:"分析生成失敗"}),(0,s.jsx)("div",{className:"text-gray-600",children:g})]})})}):(0,s.jsx)("div",{className:"min-h-screen my-12",children:(0,s.jsxs)("div",{className:"max-w-full mx-auto",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-8",children:(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"十神互動精微解讀"})}),(0,s.jsx)("div",{className:"space-y-6",children:c.map((e,t)=>(0,s.jsx)("div",{className:"w-full p-6 bg-white rounded-[30px] shadow-md p-15",children:(0,s.jsx)(G,{explanation:e,index:t})},t))})]})})};var U=n(66766);let W={感情:{left:{label:"日月互動",img:"/images/report/sun.png",selectedBg:"#B4003C",selectedImg:"#FFFFFF",unselectedBg:"#EFEFEF",unselectedImg:"#B4003C"},middle:{label:"夫妻宮寅未暗合",img:"/images/report/star2.png",selectedBg:"#DEAB20",selectedImg:"#FFFFFF",unselectedBg:"#EFEFEF",unselectedImg:"#DEAB20"},right:{label:"五行氣機修補",img:"/images/report/heart.png",selectedBg:"#C74772",selectedImg:"#FFFFFF",unselectedBg:"#EFEFEF",unselectedImg:"#C74772"}},婚姻:{left:{label:"配對特性",img:"/images/report/couple.png",selectedBg:"#B4003C",selectedImg:"#FFFFFF",unselectedBg:"#EFEFEF",unselectedImg:"#B4003C"},middle:{label:"婚配格局分析",img:"/images/report/star2.png",selectedBg:"#DEAB20",selectedImg:"#FFFFFF",unselectedBg:"#EFEFEF",unselectedImg:"#DEAB20"},right:{label:"婚姻調候方案",img:"/images/report/marriage.png",selectedBg:"#4B6EB2",selectedImg:"#FFFFFF",unselectedBg:"#EFEFEF",unselectedImg:"#4B6EB2"}},家庭:{left:{label:"配對特性",img:"/images/report/couple.png",selectedBg:"#B4003C",selectedImg:"#FFFFFF",unselectedBg:"#EFEFEF",unselectedImg:"#B4003C"},middle:{label:"夫妻合盤分析",img:"/images/report/star2.png",selectedBg:"#DEAB20",selectedImg:"#FFFFFF",unselectedBg:"#EFEFEF",unselectedImg:"#DEAB20"},right:{label:"家庭和睦方案",img:"/images/report/family.png",selectedBg:"#389D7D",selectedImg:"#FFFFFF",unselectedBg:"#EFEFEF",unselectedImg:"#389D7D"}}},$=["left","middle","right"];function L(e){return W[e]||W.感情}function J(e,t,n){return"left"===e?n?L(t).left.selectedImg:L(t).left.unselectedImg:"middle"===e?n?L(t).middle.selectedImg:L(t).middle.unselectedImg:"right"===e?n?L(t).right.selectedImg:L(t).right.unselectedImg:"#B4003C"}async function Y(e,t){let{user1:n,user2:s,concern:a,problem:l,currentYear:i}=e,r=a||"感情",c=function(e,t,n){let{user1:s,user2:a,problem:l,currentYear:i}=n,r="";try{let e=w(s.birthDateTime,s.gender),t=w(a.birthDateTime,a.gender);r="\n八字四柱分析：\n男方八字：".concat(e.fourPillars.year.stem).concat(e.fourPillars.year.branch," ").concat(e.fourPillars.month.stem).concat(e.fourPillars.month.branch," ").concat(e.fourPillars.day.stem).concat(e.fourPillars.day.branch," ").concat(e.fourPillars.hour.stem).concat(e.fourPillars.hour.branch,"\n男方日主：").concat(e.dayMasterStem).concat(e.dayMasterElement,"\n男方年命：").concat(e.lifeNayin,"（").concat(e.lifeElement,"命）\n\n女方八字：").concat(t.fourPillars.year.stem).concat(t.fourPillars.year.branch," ").concat(t.fourPillars.month.stem).concat(t.fourPillars.month.branch," ").concat(t.fourPillars.day.stem).concat(t.fourPillars.day.branch," ").concat(t.fourPillars.hour.stem).concat(t.fourPillars.hour.branch,"\n女方日主：").concat(t.dayMasterStem).concat(t.dayMasterElement,"\n女方年命：").concat(t.lifeNayin,"（").concat(t.lifeElement,"命）\n\n五行配對：").concat(e.dayMasterElement).concat("火"===e.dayMasterElement?"火":e.dayMasterElement,"男配").concat(t.dayMasterElement).concat("水"===t.dayMasterElement?"水":t.dayMasterElement,"女\n配對關係：").concat(function(e,t){let n={金木:"金克木 - 需要調和與包容",金水:"金生水 - 相互促進，和諧配合",金火:"火克金 - 激烈碰撞，需要平衡",金土:"土生金 - 穩定支持，互相成就",木水:"水生木 - 滋養成長，相得益彰",木火:"木生火 - 熱情激發，互相點燃",木土:"木克土 - 需要理解與協調",水火:"水火不容 - 對立衝突，需要化解",水土:"土克水 - 制約關係，需要平衡",火土:"火生土 - 溫暖厚實，相互依靠"};return n[e+t]||n[t+e]||"特殊組合 - 需要深入分析"}(e.dayMasterElement,t.dayMasterElement),"\n")}catch(e){console.warn("Element analysis failed, using basic info:",e),r="\n基本資料：\n男方生辰：".concat(s.birthDateTime,"，性別：").concat(s.gender||"男","\n女方生辰：").concat(a.birthDateTime,"，性別：").concat(a.gender||"女","\n")}let c="夫妻合盤分析：\n".concat(r,"\n關注領域：").concat(e,"，具體問題：").concat(l,"，分析年份：").concat(i,"\n\n【重要指示】你是專業的八字合盤命理大師，必須提供具體、準確、有說服力的夫妻合盤分析。避免模糊用詞，要給出明確的判斷和建議。請使用繁體中文回應。");if("left"===t)return"".concat(c,"\n\n請必須按照以下格式提供夫妻配對特性分析：\n\n【標題格式】\n【[男方日干][女方日干]合盤分析】\n\n內容結構：\n1. 第一段：[男方日干]配[女方日干]，[格局名稱]，賦予[具體優勢]；然[具體挑戰]。全局需[調和方案]，具體長期配對策略如下：\n\n2. 五行調和方案：\n[列出3個具體的五行調和建議，包含方位、物品、時辰等]\n\n3. 長期配對策略：\n[針對當年年份的具體建議，包含季節、活動、風水佈局等]\n\n4. 最後段落：[深度分析說明雙方命理互動關係和注意事項]\n\n範例格式：\n【辛金配戊土合盤分析】\n\n辛金配戊土，土生金之正印格局，賦予穩定包容、財官相生之利；然金土皆燥，火炎土焦之憂。全局需水潤金土，具體長期配對策略如下：\n\n五行調和方案：\n1. 北方水位佈局黑曜石或魚缸化解火燥\n2. 隨身佩戴海藍寶石增強水氣流通  \n3. 亥子時辰（21-01時）為最佳溝通時段\n\n長期配對策略：\n2025乙巳年需注意巳申相刑，建議：\n- 立春後共同參與水相關活動（游泳、溫泉）\n- 秋季金旺時節進行重要家庭決策\n- 臥室西方放置銅製擺件平衡金氣\n\n此局戊土正印護辛金，女方能有效緩解男方癸水食神之波動性，男方甲木正財可疏導女方戊土比肩之固執。惟雙午火局需防2025年巳火加入形成三會火局，建議立夏後減少南方行程，多運用黑色系衣著配飾調節。\n\n請嚴格按照此格式生成，確保包含所有必要元素。");if("middle"===t){if("感情"===e)return"".concat(c,'\n      \n你必須嚴格按照以下JSON格式回應，提供夫妻感情合盤的具體分析。\n\n【重要】只返回純JSON格式，不要包含任何markdown代碼塊標記（如```json或```），直接從{開始到}結束：\n\n{\n  "合盤核心": {\n    "主要内容": "明確指出雙方日干配對的核心格局和感情基礎（如：甲木配己土，官印相生）",\n    "状态列表": [\n      "具體配對強弱：[提供具體證據，如男方日干得女方生扶或相剋]",\n      "具體感情互動：[明確說出雙方在感情上的互動模式]", \n      "具體吸引力源：[說明雙方相互吸引的命理基礎]"\n    ],\n    "结论": "給出明確的感情配對總體評價，不要模糊用詞"\n  },\n  "感情之源": {\n    "主要分析": "具體分析雙方感情宮位配置及相互影響，說明感情發展模式（約100字，要具體）",\n    "关键问题": {\n      "问题1": {\n        "名称": "具體感情問題名稱（如：水火不容易起衝突）",\n        "解释": "具體解釋這個問題的成因和對感情的影響（50字）"\n      },\n      "问题2": {\n        "名称": "另一個具體感情挑戰",\n        "解释": "具體解釋第二個問題及其解決方向（50字）"\n      }\n    }\n  },\n  "夫妻互动关键": {\n    "互动列表": [\n      {\n        "方面": "具體互動方面（如：溝通模式）",\n        "特點": "明確說明這方面的互動特點和建議（40字）"\n      },\n      {\n        "方面": "第二個互動方面（如：性格互補）",\n        "特點": "具體互動機制，不要模糊描述（40字）"\n      },\n      {\n        "方面": "第三個互動方面（如：共同目標）",\n        "特點": "明確的互動分析，要有說服力（40字）"\n      }\n    ],\n    "格局核心": "用15字內準確概括夫妻配對的核心優勢"\n  }\n}\n\n【強制要求】：\n- 必須提供具體的雙方天干地支合盤分析\n- 不允許使用"可能"、"或許"、"一般來說"等模糊詞彙\n- 每個分析都要有具體的合盤命理依據\n- 總字數約350字，內容要實用有效');if("婚姻"===e)return"".concat(c,'\n      \n你必須嚴格按照以下JSON格式回應，提供婚姻方面的夫妻合盤分析。\n\n【重要】只返回純JSON格式，不要包含任何markdown代碼塊標記（如```json或```），直接從{開始到}結束：\n\n{\n  "婚姻根基": {\n    "主要内容": "明確分析雙方婚姻宮配置和夫妻星情況，說出具體婚姻格局",\n    "状态列表": [\n      "具體婚姻基礎：[明確說出雙方夫妻宮和夫妻星的配合情況]",\n      "具體穩定性：[根據合盤配置給出明確的婚姻穩定度判斷]",\n      "具體成長潛力：[說明婚姻關係的發展空間和方向]"\n    ],\n    "结论": "對婚姻關係給出明確而非模糊的總結"\n  },\n  "婚姻发展": {\n    "主要分析": "具體分析適合的婚姻經營模式和發展階段，要給出明確建議（約100字）",\n    "关键问题": {\n      "问题1": {\n        "名称": "具體婚姻發展障礙",\n        "解释": "明確說明這個障礙的原因和解決方向（50字）"\n      },\n      "问题2": {\n        "名称": "另一個具體婚姻挑戰",\n        "解释": "具體分析第二個挑戰及應對策略（50字）"\n      }\n    }\n  },\n  "夫妻星配置": {\n    "配置列表": [\n      {\n        "星神": "具體夫妻星名稱（如：正官、正財）",\n        "作用": "明確說明這個星神在婚姻中的作用（40字）"\n      },\n      {\n        "星神": "第二個相關星神",\n        "作用": "具體作用機制，不要模糊描述（40字）"\n      },\n      {\n        "星神": "第三個重要星神",\n        "作用": "明確的婚姻影響分析（40字）"\n      }\n    ],\n    "格局核心": "用15字內準確概括婚姻格局的核心特質"\n  }\n}\n\n【強制要求】：\n- 必須提供具體的夫妻星和婚姻宮合盤分析\n- 不允許使用模糊詞彙，要有明確判斷\n- 每個分析都要有具體的命理依據\n- 總字數約350字，重點關注婚姻穩定性');if("家庭"===e)return"".concat(c,'\n      \n你必須嚴格按照以下JSON格式回應，提供家庭方面的夫妻合盤分析。\n\n【重要】只返回純JSON格式，不要包含任何markdown代碼塊標記（如```json或```），直接從{開始到}結束：\n\n{\n  "家庭基础": {\n    "主要内容": "明確分析雙方家庭宮位和子女星配置，說出具體家庭格局",\n    "状态列表": [\n      "具體家庭根基：[明確說出雙方在家庭建設上的優勢配合]",\n      "具體子女緣：[根據子女星配置分析生育和教養能力]",\n      "具體家庭和諧度：[說明家庭氛圍和相處模式]"\n    ],\n    "结论": "對家庭建設給出明確的總體評價"\n  },\n  "家庭经营": {\n    "主要分析": "具體分析適合的家庭經營模式和分工安排，要給出明確建議（約100字）",\n    "关键问题": {\n      "问题1": {\n        "名称": "具體家庭經營挑戰",\n        "解释": "明確說明這個挑戰的原因和改善方向（50字）"\n      },\n      "问题2": {\n        "名称": "另一個具體家庭問題",\n        "解释": "具體分析第二個問題及解決策略（50字）"\n      }\n    }\n  },\n  "家庭角色配置": {\n    "角色列表": [\n      {\n        "角色": "具體家庭角色（如：經濟支柱、教育主導）",\n        "分工": "明確說明這個角色的最佳分工安排（40字）"\n      },\n      {\n        "角色": "第二個重要角色",\n        "分工": "具體分工機制和配合方式（40字）"\n      },\n      {\n        "角色": "第三個關鍵角色",\n        "分工": "明確的角色定位和責任分配（40字）"\n      }\n    ],\n    "格局核心": "用15字內準確概括家庭經營的核心優勢"\n  }\n}\n\n【強制要求】：\n- 必須提供具體的家庭宮位和子女星合盤分析\n- 不允許使用模糊詞彙，要有明確的家庭經營建議\n- 每個分析都要有具體的命理依據\n- 總字數約350字，重點關注家庭和諧與發展')}else if("right"===t){if("感情"===e)return"".concat(c,'\n\n請提供感情調候策略的具體建議，必須按照以下JSON格式。\n\n【重要】只返回純JSON格式，不要包含任何markdown代碼塊標記（如```json或```），直接從{開始到}結束：\n\n{\n  "调候核心": {\n    "五行调节": "明確指出雙方需要的具體五行調節方案（如：男方需木火調候，女方需金水平衡）",\n    "调候重点": "具體說明調候的重點時機和方法（60字）"\n  },\n  "实用建议": {\n    "日常调和": [\n      "具體的日常感情調和建議1（30字）",\n      "具體的日常感情調和建議2（30字）",\n      "具體的日常感情調和建議3（30字）"\n    ],\n    "时机把握": [\n      "重要時機的把握建議1（30字）",\n      "重要時機的把握建議2（30字）"\n    ]\n  },\n  "长期策略": {\n    "感情发展": "具體的長期感情發展策略和目標（80字）",\n    "关键节点": "明確指出感情發展的關鍵節點和注意事項（60字）"\n  }\n}\n\n要求300字，重點提供實用的調候建議。');if("婚姻"===e)return"".concat(c,'\n\n請提供婚姻調候方案的具體建議，必須按照以下JSON格式。\n\n【重要】只返回純JSON格式，不要包含任何markdown代碼塊標記（如```json或```），直接從{開始到}結束：\n\n{\n  "调候核心": {\n    "五行调节": "明確指出婚姻關係需要的具體五行調節（如：夫妻宮需要火土調和）",\n    "调候重点": "具體說明婚姻調候的重點和方法（60字）"\n  },\n  "实用建议": {\n    "婚姻经营": [\n      "具體的婚姻經營建議1（30字）",\n      "具體的婚姻經營建議2（30字）",\n      "具體的婚姻經營建議3（30字）"\n    ],\n    "冲突化解": [\n      "夫妻衝突化解方法1（30字）",\n      "夫妻衝突化解方法2（30字）"\n    ]\n  },\n  "长期策略": {\n    "婚姻稳定": "具體的長期婚姻穩定策略（80字）",\n    "成长目标": "明確的夫妻共同成長目標和路徑（60字）"\n  }\n}\n\n要求300字，重點提供實用的婚姻調候方案。');if("家庭"===e)return"".concat(c,'\n\n請提供家庭和睦方案的具體建議，必須按照以下JSON格式。\n\n【重要】只返回純JSON格式，不要包含任何markdown代碼塊標記（如```json或```），直接從{開始到}結束：\n\n{\n  "调候核心": {\n    "五行调节": "明確指出家庭和諧需要的具體五行調節（如：家庭氣場需要土金調和）",\n    "调候重点": "具體說明家庭調候的重點和實施方法（60字）"\n  },\n  "实用建议": {\n    "家庭和谐": [\n      "具體的家庭和諧建議1（30字）",\n      "具體的家庭和諧建議2（30字）",\n      "具體的家庭和諧建議3（30字）"\n    ],\n    "子女教养": [\n      "子女教養的重點建議1（30字）",\n      "子女教養的重點建議2（30字）"\n    ]\n  },\n  "长期策略": {\n    "家庭发展": "具體的長期家庭發展策略和願景（80字）",\n    "传承规划": "明確的家庭傳承規劃和價值延續（60字）"\n  }\n}\n\n要求300字，重點提供實用的家庭經營方案。')}return"".concat(c,"\n\n請提供").concat(e,"方面的夫妻合盤分析，包含具體的配對特點、互動模式和調和建議。要求內容具體實用，避免模糊描述，約300字。")}(r,t,{user1:n,user2:s,problem:l,currentYear:i});for(let e=1;e<=3;e++)try{console.log("AI Couple Analysis Attempt ".concat(e," for ").concat(t," - ").concat(r));let a=await fetch("/api/couple-mingju-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user1Birthday:n.birthDateTime,user2Birthday:s.birthDateTime,user1Name:n.name||"男方",user2Name:s.name||"女方",concern:r,problem:l,currentYear:i,analysisType:t,prompt:c})});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));let o=await a.json();if(o.analysis&&o.analysis.trim())return console.log("✅ AI Analysis Success for ".concat(t)),o.analysis;throw Error("Empty AI response")}catch(a){if(console.error("❌ AI Analysis Attempt ".concat(e," failed:"),a),3===e)return K(t,r,n,s)}}function K(e,t,n,s){let a=n.name||"男方",l=s.name||"女方";return"left"===e?"".concat(a,"與").concat(l,"的八字配對分析：\n\n根據雙方生辰八字，此配對展現出獨特的五行互動格局。雙方在性格特質上既有互補優勢，也存在需要調和的差異。\n\n配對優勢：\n• 五行互補：雙方的日干五行形成良性互動，有助於相互支持\n• 性格平衡：在處事方式上能夠互相補足，形成穩定的配對基礎\n\n需要注意：\n• 溝通調和：不同的表達方式可能需要更多理解和包容\n• 節奏協調：在生活步調上需要找到平衡點\n\n調和建議：\n建議雙方多關注對方的五行特質，在日常相處中運用相生原理，避免相剋情況。通過適當的風水調節和時機把握，可以增進感情和諧，建立長久穩定的關係。\n\n此配對具有良好的發展潛力，關鍵在於雙方的理解與配合。"):"middle"===e?JSON.stringify({合盤核心:{主要内容:"".concat(a,"與").concat(l,"的八字合盤顯示良好的配對基礎"),状态列表:["配對強弱：雙方日干形成穩定的相互關係","感情互動：在情感表達上有互補特質","吸引力源：基於五行相生的天然吸引力"],结论:"整體配對評價為良好，具有發展潛力"},感情之源:{主要分析:"雙方的感情宮位配置較為和諧，男方的理性與女方的感性形成良好互補，感情發展呈現穩定上升趨勢。",关键问题:{问题1:{名称:"溝通方式差異",解释:"雙方在表達感情的方式上有所不同，需要多一些耐心和理解。"},问题2:{名称:"生活節奏調和",解释:"在日常生活安排上需要找到雙方都舒適的平衡點。"}}},夫妻互动关键:{互动列表:[{方面:"情感交流",特點:"建議多用行動表達關愛，減少語言上的誤解"},{方面:"生活規劃",特點:"在重大決定上多商量，發揮各自的優勢特質"},{方面:"相處模式",特點:"保持適當的個人空間，同時增進共同興趣"}],格局核心:"互補配對，和諧發展"}},null,2):"right"===e?JSON.stringify({调候核心:{五行调节:"".concat(a,"需要調和火土之氣，").concat(l,"適合平衡金水能量"),调候重点:"重點在於雙方的五行平衡，建議在季節轉換時特別注意情感調節"},实用建议:{日常调和:["多在自然環境中約會，增進五行和諧","選擇適合的顏色和飾品輔助調候","注意飲食搭配，避免五行相剋的食物組合"],时机把握:["在吉利的時辰進行重要決定和溝通","利用流年大運的有利時機推進感情發展"]},长期策略:{感情发展:"建議循序漸進，在穩固感情基礎的同時，規劃未來的共同目標和發展方向。",关键节点:"特別注意農曆的重要節氣，這些時間點對感情發展有重要影響。"}},null,2):"分析中...請稍候，正在為您生成專業的夫妻合盤".concat(t,"分析報告。")}let q=function(e){let{user1:t,user2:n,currentYear:l}=e,{coupleMingJuCache:i,setCoupleMingJuCache:r}=m(),[c,o]=(0,a.useState)("left"),[d,u]=(0,a.useState)(""),[g,h]=(0,a.useState)(""),[x,p]=(0,a.useState)(!0),[f,b]=(0,a.useState)({}),[y,v]=(0,a.useState)(new Set),[j,N]=(0,a.useState)(!1),[w,S]=(0,a.useState)(!0),C="感情",E=(e,t,n,s)=>"".concat(e,"_").concat(t.birthDateTime,"_").concat(n.birthDateTime,"_").concat(C,"_").concat(s);(0,a.useEffect)(()=>{if(i){console.log("\uD83D\uDCCB Using global cached couple MingJu analysis"),b(i),N(!0),S(!1);let e=E(c,t,n,l);if(i[e]){let t=i[e];"left"===c?u(t):h(t),p(!1)}}},[i,c,t,n,l]),(0,a.useEffect)(()=>{i||(b({}),v(new Set),N(!1),S(!0),p(!0))},[t.birthDateTime,n.birthDateTime,i]),(0,a.useEffect)(()=>{(!i||!(Object.keys(i).length>0))&&async function(){console.log("\uD83D\uDE80 Starting couple MingJu preload for all tabs..."),console.log("\uD83D\uDD0D User1 info:",t),console.log("\uD83D\uDD0D User2 info:",n),console.log("\uD83D\uDD0D Current year:",l);let e=$.map(async e=>{let s=E(e,t,n,l);if(console.log("\uD83D\uDD11 Cache key for ".concat(e,":"),s),f[s]){console.log("\uD83D\uDCCB Tab ".concat(e," already cached"));return}console.log("⏳ Preloading couple content for ".concat(e)),v(t=>new Set([...t,e]));try{console.log("\uD83E\uDD16 Calling generateCoupleMingJuAnalysis for ".concat(e,"..."));let a=await Y({user1:t,user2:n,concern:C,problem:"夫妻合盤命理分析",currentYear:l},e);console.log("✅ Generated content for ".concat(e,":"),null==a?void 0:a.substring(0,100)),b(t=>{let n={...t,[s]:a};return console.log("\uD83D\uDCBE Cached content for ".concat(e)),n}),v(t=>{let n=new Set(t);return n.delete(e),n}),e===c&&("left"===e?u(a):h(a),p(!1))}catch(s){if(console.error("❌ Failed to preload ".concat(e,":"),s),v(t=>{let n=new Set(t);return n.delete(e),n}),e===c){let s=K(e,C,t,n);"left"===e?u(s):h(s),p(!1)}}});try{await Promise.allSettled(e),console.log("\uD83C\uDF89 All couple MingJu tabs preload completed"),N(!0),S(!1)}catch(e){console.error("❌ Error during preload:",e),S(!1)}}()},[t,n,l,c]),(0,a.useEffect)(()=>{if(Object.keys(f).length>0&&j&&!w){let e=setTimeout(()=>{r(f),console.log("\uD83D\uDCBE Updated global couple MingJu cache")},0);return()=>clearTimeout(e)}},[f,j,w,r]),(0,a.useEffect)(()=>{let e=E(c,t,n,l);console.log("\uD83D\uDD04 Tab changed to ".concat(c,", cache key: ").concat(e));let s=f[e]||i&&i[e];if(s)console.log("\uD83D\uDCCB Found cached content for ".concat(c)),"left"===c?u(s):h(s),p(!1);else if(console.log("⏳ No cached content for ".concat(c,", checking if loading...")),w||y.has(c)){p(!0);let s=()=>{let a=f[e]||i&&i[e];if(a)"left"===c?u(a):h(a),p(!1);else if(y.has(c))setTimeout(s,500);else{let e=K(c,C,t,n);"left"===c?u(e):h(e),p(!1)}};s()}else{let e=K(c,C,t,n);"left"===c?u(e):h(e),p(!1)}},[c,f,i,t,n,l,w,y]);let F=e=>"left"===e?"#B4003C":"middle"===e?L(C).middle.selectedBg:"right"===e?L(C).right.selectedBg:"#B4003C",A=e=>{if(e!==c){let s=E(e,t,n,l);!(f[s]||i&&i[s])&&y.has(e)&&p(!0),o(e)}};return(0,s.jsx)("div",{className:"mx-auto shadow-md p-15",style:{width:"100%",backgroundColor:"white",borderRadius:"45px",boxShadow:"0 4px 4px rgba(0, 0, 0, 0.25)"},children:(0,s.jsxs)("div",{className:"px-8",children:[(0,s.jsx)("div",{className:"flex items-center justify-center px-4 mb-8 gap-70",children:$.map(e=>{let t=c===e,n="left"===e?L(C).left.label:"middle"===e?L(C).middle.label:"right"===e?L(C).right.label:e,a="left"===e?L(C).left.img:"middle"===e?L(C).middle.img:"right"===e?L(C).right.img:"/images/report/couple.png",l="left"===e?t?L(C).left.selectedBg:L(C).left.unselectedBg:"middle"===e?t?L(C).middle.selectedBg:L(C).middle.unselectedBg:"right"===e?t?L(C).right.selectedBg:L(C).right.unselectedBg:"#EFEFEF";return J(e,C,t),(0,s.jsxs)("div",{className:"flex flex-col items-center mb-10",children:[(0,s.jsx)("button",{className:"flex flex-col items-center justify-center transition-all duration-200 hover:scale-105",style:{width:90,height:90,borderRadius:"50%",backgroundColor:l,boxShadow:"0 4px 4px rgba(0,0,0,0.25)"},onClick:()=>A(e),children:(0,s.jsx)(U.default,{src:a,alt:n,width:32,height:32,style:{filter:(()=>{if(t)return"brightness(0) invert(1)";let n=J(e,C,!1);if("#DEAB20"===n)return"brightness(0) saturate(100%) invert(85%) sepia(89%) saturate(2000%) hue-rotate(30deg) brightness(95%) contrast(102%)";if("#C74772"===n)return"brightness(0) saturate(100%) invert(35%) sepia(89%) saturate(2000%) hue-rotate(320deg) brightness(95%) contrast(102%)";if("#4B6EB2"===n)return"brightness(0) saturate(100%) invert(35%) sepia(89%) saturate(2000%) hue-rotate(200deg) brightness(95%) contrast(102%)";if("#389D7D"===n)return"brightness(0) saturate(100%) invert(45%) sepia(67%) saturate(1000%) hue-rotate(150deg) brightness(85%) contrast(102%)";if("#B4003C"===n)return"brightness(0) saturate(100%) invert(15%) sepia(89%) saturate(2000%) hue-rotate(330deg) brightness(95%) contrast(102%)";return"none"})()}})}),(0,s.jsx)("div",{className:"mt-4 text-center",style:{width:100,fontSize:"14px",lineHeight:"1.2",color:t?F(e):"#999",fontWeight:t?"bold":"normal"},children:n})]},e)})}),(0,s.jsx)("div",{className:"px-4",children:"left"===c?(0,s.jsx)("div",{className:"min-h-[300px]",style:{backgroundColor:"white",color:"black",fontSize:"15px"},children:x?(0,s.jsxs)("div",{className:"flex items-center justify-center h-40",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#B4003C]"}),(0,s.jsx)("span",{className:"ml-3 text-gray-600",children:"夫妻合盤分析中..."})]}):(0,s.jsx)("div",{className:"py-4",children:function(e){if(!e)return null;let t=e.split("\n").filter(e=>e.trim()),n=t.findIndex(e=>e.includes("合盤分析】"));if(-1===n)return(0,s.jsx)("div",{className:"whitespace-pre-line",children:e});let a=t[n].match(/【(.+?)合盤分析】/),l=a?a[1]:"",i="",r=t.slice(n+1).join(" ").match(/([^，。]+?格局)/);r&&(i=r[1]);let c="",o=t.findIndex((e,t)=>t>n&&e.includes("賦予")&&e.includes("全局"));-1!==o&&(c=t[o]);let d=e=>{let n=t.findIndex(t=>t.includes(e));if(-1===n)return[];let s=[];for(let e=n;e<t.length;e++){let a=t[e];if(e>n&&(a.includes("方案：")||a.includes("策略：")||a.includes("此局")))break;s.push(a)}return s},m=d("五行調和方案："),u=d("長期配對策略：");return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-[#C74772]",style:{fontFamily:"'Noto Serif TC', serif",fontSize:"56px",fontWeight:"400",lineHeight:"1.2"},children:l}),i&&(0,s.jsx)("div",{className:"bg-[#C74772] text-white px-4 py-2 rounded-full",style:{fontSize:"16px",fontWeight:"500"},children:i})]}),c&&(0,s.jsx)("div",{className:"text-base leading-relaxed text-black",children:c}),m.length>0&&(0,s.jsx)("div",{className:"bg-[#EFEFEF] p-4 rounded-lg",children:(0,s.jsx)("div",{className:"text-black",children:m.map((e,t)=>(0,s.jsx)("div",{className:"mb-1",children:e},t))})}),u.length>0&&(0,s.jsx)("div",{className:"bg-[#EFEFEF] p-4 rounded-lg",children:(0,s.jsx)("div",{className:"text-black",children:u.map((e,t)=>(0,s.jsx)("div",{className:"mb-1",children:e},t))})}),t.filter(e=>!e.includes("合盤分析】")&&!e.includes("五行調和方案：")&&!e.includes("長期配對策略：")&&!m.includes(e)&&!u.includes(e)&&e!==c).length>0&&(0,s.jsx)("div",{className:"text-base leading-relaxed text-black",children:t.filter(e=>!e.includes("合盤分析】")&&!e.includes("五行調和方案：")&&!e.includes("長期配對策略：")&&!m.includes(e)&&!u.includes(e)&&e!==c).map((e,t)=>(0,s.jsx)("div",{className:"mb-2",children:e},t))})]})}(d)})}):(0,s.jsx)("div",{className:"min-h-[300px]",children:x?(0,s.jsxs)("div",{className:"flex items-center justify-center h-40",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#B4003C]"}),(0,s.jsx)("span",{className:"ml-3 text-gray-600",children:"夫妻合盤分析中..."})]}):(0,s.jsx)("div",{style:{fontFamily:"system-ui, -apple-system, sans-serif"},children:"middle"===c||"right"===c?g&&g.trim().length>0?function(e,t,n){try{if(!n||"string"!=typeof n||0===n.trim().length)return console.warn("\uD83D\uDCDD renderStructuredContent: 內容為空或無效"),(0,s.jsx)("div",{className:"p-4 border border-yellow-200 rounded-lg bg-yellow-50",children:(0,s.jsx)("p",{className:"text-yellow-800",children:"正在載入分析內容..."})});let e=n.trim();e.startsWith("```json")?e=e.replace(/^```json\s*/,"").replace(/\s*```$/,""):e.startsWith("```")&&(e=e.replace(/^```\s*/,"").replace(/\s*```$/,""));let t=e.match(/\{[\s\S]*\}/);if(t&&(e=t[0]),!e||0===e.trim().length)return console.warn("\uD83D\uDCDD renderStructuredContent: 清理後內容為空"),(0,s.jsx)("div",{className:"p-4 border border-yellow-200 rounded-lg bg-yellow-50",children:(0,s.jsx)("p",{className:"text-yellow-800",children:"正在處理分析內容..."})});e=e.replace(/(\s*"特點":\s*"[^"]*")\s*\]/g,"$1\n      }\n    ]").replace(/("\s*),?\s*\]\s*,?\s*\}\s*$/g,'"\n      }\n    ],\n    "格局核心": "土生金發，剛柔並濟"\n  }\n}').replace(/("\s*),?\s*\]\s*$/g,'"\n      }\n    ]\n  }\n}'),console.log("\uD83D\uDD27 Cleaned content before parsing:",e);let a=JSON.parse(e);return(0,s.jsx)("div",{className:"space-y-6",children:Object.entries(a).map((e,t)=>{let[n,a]=e;return(0,s.jsxs)("div",{className:"p-4 rounded-lg bg-[#EFEFEF] shadow-lg",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-[#B4003C] mb-3",children:n}),a.主要内容&&(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsx)("p",{className:"leading-relaxed text-gray-800",children:a.主要内容})}),a.主要分析&&(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsx)("p",{className:"leading-relaxed text-gray-800",children:a.主要分析})}),a.状态列表&&(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsx)("ul",{className:"space-y-2",children:a.状态列表.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-start",children:[(0,s.jsx)("span",{className:"text-[#C74772] mr-2",children:"•"}),(0,s.jsx)("span",{className:"text-gray-700",children:e})]},t))})}),a.关键问题&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-gray-800",children:"關鍵問題："}),Object.entries(a.关键问题).map((e,t)=>{let[n,a]=e;return(0,s.jsxs)("div",{className:"mb-2 ml-4",children:[(0,s.jsx)("p",{className:"font-medium text-[#4B6EB2]",children:a.名称}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:a.解释})]},t)})]}),a.互动列表&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-gray-800",children:"互動分析："}),a.互动列表.map((e,t)=>(0,s.jsxs)("div",{className:"mb-2 ml-4",children:[(0,s.jsx)("p",{className:"font-medium text-[#4B6EB2]",children:e.方面}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.特點})]},t))]}),a.配置列表&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-gray-800",children:"配置分析："}),a.配置列表.map((e,t)=>(0,s.jsxs)("div",{className:"mb-2 ml-4",children:[(0,s.jsx)("p",{className:"font-medium text-[#4B6EB2]",children:e.星神||e.角色}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.作用||e.分工})]},t))]}),a.角色列表&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-gray-800",children:"角色分析："}),a.角色列表.map((e,t)=>(0,s.jsxs)("div",{className:"mb-2 ml-4",children:[(0,s.jsx)("p",{className:"font-medium text-[#4B6EB2]",children:e.角色}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.分工})]},t))]}),a.日常调和&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-gray-800",children:"日常調和："}),(0,s.jsx)("ul",{className:"space-y-1",children:a.日常调和.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-start ml-4",children:[(0,s.jsx)("span",{className:"text-[#C74772] mr-2",children:"•"}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:e})]},t))})]}),a.婚姻经营&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-gray-800",children:"婚姻經營："}),(0,s.jsx)("ul",{className:"space-y-1",children:a.婚姻经营.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-start ml-4",children:[(0,s.jsx)("span",{className:"text-[#C74772] mr-2",children:"•"}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:e})]},t))})]}),a.家庭和谐&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-gray-800",children:"家庭和諧："}),(0,s.jsx)("ul",{className:"space-y-1",children:a.家庭和谐.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-start ml-4",children:[(0,s.jsx)("span",{className:"text-[#C74772] mr-2",children:"•"}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:e})]},t))})]}),a.结论&&(0,s.jsx)("div",{className:"mt-3 p-3 bg-white rounded border-l-4 border-[#B4003C]",children:(0,s.jsx)("p",{className:"font-medium text-gray-800",children:a.结论})}),a.格局核心&&(0,s.jsx)("div",{className:"mt-3 p-3 bg-white rounded border-l-4 border-[#B4003C]",children:(0,s.jsxs)("p",{className:"font-medium text-gray-800",children:["核心：",a.格局核心]})}),a.五行调节&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-gray-800",children:"五行調節："}),(0,s.jsx)("p",{className:"ml-4 text-gray-700",children:a.五行调节})]}),a.调候重点&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-gray-800",children:"調候重點："}),(0,s.jsx)("p",{className:"ml-4 text-gray-700",children:a.调候重点})]}),(a.感情发展||a.婚姻稳定||a.家庭发展)&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("h4",{className:"mb-2 font-semibold text-gray-800",children:"長期策略："}),(0,s.jsx)("p",{className:"ml-4 text-gray-700",children:a.感情发展||a.婚姻稳定||a.家庭发展})]})]},t)})})}catch(t){console.error("❌ Error parsing structured content:",t),console.error("\uD83D\uDCC4 Content that failed to parse:",n);let e=n;try{let t=n.split("\n").filter(e=>{let t=e.trim();return t&&!t.match(/^[{}\[\],]*$/)});t.length>0&&(e=t.map(e=>e.replace(/^\s*["']|["'],?\s*$/g,"").replace(/^\s*["}]\s*/,"")).filter(e=>e.length>0).join("\n"))}catch(e){console.warn("Failed to extract readable content:",e)}if(n&&"string"==typeof n&&n.trim().length>0)return(0,s.jsxs)("div",{className:"p-4 border border-blue-200 rounded-lg bg-blue-50",children:[(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"⚠️ 內容格式正在調整中，顯示原始分析結果："})}),(0,s.jsx)("div",{className:"space-y-2",children:e.split("\n").map((e,t)=>{let n=e.trim();return n?n.match(/[\u4e00-\u9fff].*[:：]/)?(0,s.jsx)("h4",{className:"mt-3 mb-1 font-bold text-gray-800",children:n},t):(0,s.jsx)("p",{className:"ml-2 leading-relaxed text-gray-700",children:n},t):null})})]});return(0,s.jsx)("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:(0,s.jsx)("p",{className:"text-gray-600",children:"暫無分析內容，請稍後再試。"})})}}(0,0,g):(0,s.jsx)("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:(0,s.jsx)("p",{className:"text-gray-600",children:"正在載入分析內容..."})}):(0,s.jsx)("div",{className:"text-base leading-relaxed text-black whitespace-pre-line",children:g||"正在載入內容..."})})})})]})})};var Z=n(72191);function X(e){let{user1:t,user2:n,currentYear:l=2025}=e,{coupleSeasonCache:i,setCoupleSeasonCache:r}=m(),[c,o]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0),[g,h]=(0,a.useState)(0),[x,p]=(0,a.useState)(null),f=async(e,t,n)=>{try{let s=await fetch("/api/couple-season-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user1Info:{birthday:(null==e?void 0:e.birthDateTime)||"",gender:(null==e?void 0:e.gender)||"male",name:(null==e?void 0:e.name)||"男方"},user2Info:{birthday:(null==t?void 0:t.birthDateTime)||"",gender:(null==t?void 0:t.gender)||"female",name:(null==t?void 0:t.name)||"女方"},currentYear:n,concern:"感情"})});if(!s.ok)throw Error("API request failed: ".concat(s.status));let a=await s.json();if(!a.success)throw Error(a.error||"Couple season analysis failed");return{title:a.analysis.parsed.title,seasons:a.analysis.parsed.seasons,year:n,concern:"感情",user1Birthday:(null==e?void 0:e.birthDateTime)||"",user2Birthday:(null==t?void 0:t.birthDateTime)||"",user1Name:(null==e?void 0:e.name)||"男方",user2Name:(null==t?void 0:t.name)||"女方",fullContent:a.analysis.parsed.fullContent,timestamp:a.analysis.timestamp}}catch(s){return console.error("Couple season AI analysis error:",s),b(n,e,t)}},b=(e,t,n)=>({title:"夫妻季節分析 (感情指南)",seasons:[{name:"春季",period:"寅卯辰月，木旺",icon:"\uD83C\uDF38",color:"bg-green-500",content:"",keyPoints:[]},{name:"夏季",period:"巳午未月，火土極旺",icon:"☀️",color:"bg-red-500",content:"",keyPoints:[]},{name:"秋季",period:"申酉戌月，金旺",icon:"\uD83C\uDF42",color:"bg-yellow-500",content:"",keyPoints:[]},{name:"冬季",period:"亥子丑月，水旺",icon:"❄️",color:"bg-blue-500",content:"",keyPoints:[]}],year:e,concern:"感情",user1Birthday:(null==t?void 0:t.birthDateTime)||"",user2Birthday:(null==n?void 0:n.birthDateTime)||"",user1Name:(null==t?void 0:t.name)||"男方",user2Name:(null==n?void 0:n.name)||"女方",error:null}),y=(e,t,n)=>"couple_season_".concat(e.birthDateTime,"_").concat(t.birthDateTime,"_").concat(n);return((0,a.useEffect)(()=>{if(!t||!n)return;let e=y(t,n,l);if(i&&i[e]){console.log("\uD83D\uDCCB Using cached couple season analysis"),o(i[e]),u(!1);return}u(!0),p(null),f(t,n,l).then(t=>{o(t),r(n=>({...n,[e]:t}))}).catch(e=>{console.error("Couple season analysis failed:",e),p(e.message),o(b(l,t,n))}).finally(()=>{u(!1)})},[t,n,l,i,r]),d)?(0,s.jsx)("section",{className:"relative mx-auto bg-white rounded-[20px] sm:rounded-[26px] p-4 sm:p-12 lg:p-20 mb-6 sm:mb-10 shadow-[0_4px_5.3px_rgba(0,0,0,0.25)]",style:{width:"95%"},children:(0,s.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-b-2 rounded-full animate-spin border-amber-600"}),(0,s.jsx)("span",{className:"ml-3 text-gray-600",children:"分析夫妻關鍵季節中..."})]})}):c?(0,s.jsx)(Z.qw,{componentName:"CoupleSeason",children:(0,s.jsxs)("section",{className:"relative mx-auto bg-white rounded-[20px] sm:rounded-[26px] p-4 sm:p-12 lg:p-20 mb-6 sm:mb-10 shadow-[0_4px_5.3px_rgba(0,0,0,0.25)]",style:{width:"100%"},children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-8",children:(0,s.jsx)("h2",{style:{fontFamily:"Noto Serif TC, serif",fontSize:"40px",fontWeight:800,color:"#B4003C"},children:"夫妻關鍵季節"})}),(null==c?void 0:c.error)&&(0,s.jsx)("div",{className:"p-3 mb-6 bg-yellow-100 border border-yellow-400 rounded-lg",children:(0,s.jsxs)("p",{className:"text-sm text-yellow-700",children:["⚠️ ",c.error]})}),(0,s.jsx)("div",{className:"flex justify-center mb-8",children:(0,s.jsx)("div",{className:"flex justify-between w-full max-w-md",children:c.seasons.map((e,t)=>{var n,a,l;return(0,s.jsx)("button",{onClick:()=>h(t),className:"w-16 h-16 rounded-full flex items-center justify-center transition-all duration-300 shadow-[0_4px_4px_rgba(0,0,0,0.25)] ".concat((n=e.name,({春季:(a=g===t)?"bg-[#7cb856]":"bg-[#EFEFEF]",夏季:a?"bg-[#B4003C]":"bg-[#EFEFEF]",秋季:a?"bg-[#DEAB20]":"bg-[#EFEFEF]",冬季:a?"bg-[#568CB8]":"bg-[#EFEFEF]"})[n]||(a?"bg-gray-600":"bg-[#EFEFEF]"))," ").concat(g===t?"transform scale-110":"hover:scale-105"),children:(0,s.jsx)("img",{src:{春季:"/images/report/spring.png",夏季:"/images/report/summer.png",秋季:"/images/report/autumn.png",冬季:"/images/report/winter.png"}[e.name]||"/images/report/spring.png",alt:e.name,className:"w-8 h-8",style:{filter:(l=e.name,g===t?"brightness(0) invert(1)":({春季:"hue-rotate(60deg) saturate(0.8) brightness(0.6)",夏季:"hue-rotate(330deg) saturate(1.2) brightness(0.4)",秋季:"hue-rotate(40deg) saturate(1.1) brightness(0.7)",冬季:"hue-rotate(200deg) saturate(0.9) brightness(0.5)"})[l]||"none")}})},e.name)})})}),(0,s.jsxs)("div",{className:"p-6 mb-8",children:[(0,s.jsx)("div",{className:"flex items-center mb-4",children:(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("h3",{className:"text-2xl font-bold mb-2 ".concat({春季:"text-[#7cb856]",夏季:"text-[#B4003C]",秋季:"text-[#DEAB20]",冬季:"text-[#568CB8]"}[c.seasons[g].name]||"text-gray-800"),children:c.seasons[g].name}),(0,s.jsx)("div",{className:"inline-block px-4 py-2 rounded-lg text-white font-medium ".concat({春季:"bg-[#7cb856]",夏季:"bg-[#B4003C]",秋季:"bg-[#DEAB20]",冬季:"bg-[#568CB8]"}[c.seasons[g].name]||"bg-gray-600"),children:c.seasons[g].period})]})}),(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)("div",{className:"space-y-4 leading-relaxed text-gray-700",children:(()=>{let e=c.seasons[g].content;if(!e||e.trim().length<10)return(0,s.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,s.jsx)("div",{className:"w-6 h-6 border-b-2 rounded-full animate-spin border-amber-600"}),(0,s.jsx)("span",{className:"ml-3 text-gray-600",children:"正在分析夫妻感情季節中..."})]});let t=e.replace(/以上分析由DeepSeek生成，僅供參考。.*$/gm,"").replace(/命理之說旨在啟發思路，切勿全信。.*$/gm,"").replace(RegExp("--\\s*免責聲明：以上內容由DeepSeek生成.*$","gms"),"").replace(RegExp("免責聲明：.*$","gms"),"").replace(RegExp("以上內容由DeepSeek生成.*$","gms"),"").replace(RegExp("命理分析並非精密科學.*$","gms"),"").replace(RegExp("實際決策請務必結合現實情況.*$","gms"),"").replace(RegExp("--\\s*總結：.*$","gms"),"").replace(RegExp("總結：.*$","gms"),"").replace(/^：\s*/gm,"").replace(/\n--\s*$/gm,"").replace(/--$/gm,"").replace(RegExp("###.*$","gms"),"").replace(/^\s*###\s*$/gm,"").trim();return t.length<10?(0,s.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,s.jsx)("div",{className:"w-6 h-6 border-b-2 rounded-full animate-spin border-amber-600"}),(0,s.jsx)("span",{className:"ml-3 text-gray-600",children:"正在分析夫妻感情季節中..."})]}):(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsx)("p",{className:"leading-relaxed text-gray-700 whitespace-pre-line",children:t})})})()})})]})]})}):(0,s.jsx)("section",{className:"relative mx-auto bg-white rounded-[20px] sm:rounded-[26px] p-4 sm:p-12 lg:p-20 mb-6 sm:mb-10 shadow-[0_4px_5.3px_rgba(0,0,0,0.25)]",style:{width:"95%"},children:(0,s.jsx)("div",{className:"py-8 text-center text-gray-500",children:"無法載入夫妻季節分析資料"})})}function Q(e){var t;let{user1:n,user2:l,currentYear:i=2025}=e,{coupleCoreSuggestionCache:r,setCoupleCoreSuggestionCache:c}=m(),[o,d]=(0,a.useState)(null),[u,g]=(0,a.useState)(!0),[h,x]=(0,a.useState)(0),[p,f]=(0,a.useState)(null),b=async(e,t,n)=>{try{let s=await fetch("/api/couple-core-suggestion-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user1Info:{birthday:(null==e?void 0:e.birthDateTime)||"",gender:(null==e?void 0:e.gender)||"male",name:(null==e?void 0:e.name)||"男方"},user2Info:{birthday:(null==t?void 0:t.birthDateTime)||"",gender:(null==t?void 0:t.gender)||"female",name:(null==t?void 0:t.name)||"女方"},currentYear:n,concern:"感情"})});if(!s.ok)throw Error("API request failed: ".concat(s.status));let a=await s.json();if(!a.success)throw Error(a.error||"Couple core suggestion analysis failed");return y(a.analysis,e,t,n)}catch(s){return console.error("Couple core suggestion AI analysis error:",s),P(n,e,t)}},y=(e,t,n,s)=>{let a=[{title:"關係發展建議",subtitle:"夫妻合盤策略指南",icon:"/images/report/star.png",color:"bg-[#DEAB20]",content:v(e.content,"關係發展建議","關係發展策略")},{title:"溝通建議",subtitle:"夫妻溝通技巧",icon:"/images/report/chat.png",color:"bg-[#8A71C7]",content:v(e.content,"溝通建議","溝通能量指南")},{title:"能量提升建議",subtitle:"夫妻能量調和",icon:"/images/report/fengshui.png",color:"bg-[#8FA940]",content:v(e.content,"能量提升建議","能量提升方案")},{title:"感情關係禁忌",subtitle:"夫妻相處禁忌",icon:"/images/report/warning.png",color:"bg-[#B4003C]",content:v(e.content,"感情關係禁忌","感情關係禁忌")}],l=a.map((e,t)=>({icon:e.icon,label:e.title,color:e.color,active:0===t}));return{title:"夫妻開運建議",subtitle:"".concat((null==t?void 0:t.name)||"男方"," & ").concat((null==n?void 0:n.name)||"女方"," 感情指南"),coreIcon:"\uD83D\uDC95",iconColor:"bg-[#B4003C]",coreTitle:"夫妻和諧",coreIconList:l,coreCategories:a,motto:T(e.content),coreStrategy:"夫妻八字合盤，五行調和，感情長久",year:s,concern:"感情",user1Birthday:(null==t?void 0:t.birthDateTime)||"",user2Birthday:(null==n?void 0:n.birthDateTime)||"",user1Name:(null==t?void 0:t.name)||"男方",user2Name:(null==n?void 0:n.name)||"女方",fullContent:e.content,timestamp:e.timestamp}},v=(e,t,n)=>{try{if("感情關係禁忌"===t){if(e&&(e.includes("溝通禁忌")||e.includes("行為禁忌")||e.includes("環境禁忌")||e.includes("女方忌用")&&e.includes("男方忌用")||e.includes("約會避開")||e.includes("同房禁忌")))return F(e);return B(t)}for(let s of[RegExp("".concat(n,"[：:]?([\\s\\S]*?)(?=(?:一、|二、|三、|四、|###|$))"),"g"),RegExp("".concat(t,"[：:]?([\\s\\S]*?)(?=(?:關係發展|溝通建議|能量提升|感情關係|$))"),"g"),RegExp("【".concat(t,"】([\\s\\S]*?)(?=【|$)"),"g")]){s.lastIndex=0;let n=s.exec(e);if(n&&n[1]&&n[1].trim().length>50){if("關係發展建議"===t)return A(n[1].trim());if("溝通建議"===t)return j(n[1].trim());if("能量提升建議"===t)return E(n[1].trim());else if("感情關係禁忌"===t)return F(n[1].trim());return k(n[1].trim())}}return B(t)}catch(e){return console.error("Error extracting category content:",e),B(t)}},j=e=>{try{let t=e.match(/男方([^，]*?(?:土性|沉穩|傾聽|包容)[^，]*?)，/),n=e.match(/女方([^。]*?(?:火性|直率|表達|情緒)[^。]*?)。/),s=e.match(/建議採用[^。]*?([^。]*?)。/),a=e.match(/最佳溝通時辰([^。]*?)。/);e.match(/可能出現的溝通障礙([^。]*?)。/),e.match(/可採用[^。]*?([^。]*?)。/);let l=t=>{let n=RegExp("".concat(t,"[^：]*：?([^\\n]*(?:男方[^\\n]*女方[^\\n]*|女方[^\\n]*男方[^\\n]*)?[^\\n]*)"),"g"),s=e.match(n);if(s&&s.length>0){let e=s[0],t=e.match(/男方[^：]*：([^女方]*)/),n=e.match(/女方[^：]*：([^男方]*)/);return{male:t?t[1].trim().replace(/[，。]*$/,""):null,female:n?n[1].trim().replace(/[，。]*$/,""):null}}return{male:null,female:null}},i={衝突類型:l("衝突類型"),意見不合:l("意見不合"),情緒低落:l("情緒低落"),親友干涉:l("親友干涉")},r={title:"溝通風格分析",type:"partner-styles",maleStyle:t?t[1].trim():"土性沉穩擅長傾聽",femaleStyle:n?n[1].trim():"火性直率需要表達空間"},c={title:"實際應用",type:"practical-application",subsections:[{title:"衝突類型",maleStrategy:i["衝突類型"].male||"先認可再補充：「你說的X部分很有道理，我補充Y...」",femaleStrategy:i["衝突類型"].female||"用選項代替質問：「A或B方案你覺得哪個可行？」"},{title:"意見不合",maleStrategy:i["意見不合"].male||"先認可再補充：「你說的X部分很有道理，我補充Y...」",femaleStrategy:i["意見不合"].female||"用選項代替質問：「A或B方案你覺得哪個可行？」"},{title:"情緒低落",maleStrategy:i["情緒低落"].male||"肢體接觸>言語（輕拍背、遞熱飲）",femaleStrategy:i["情緒低落"].female||"分享自身類似經歷（主水比劫助共情）"},{title:"親友干涉問題",maleStrategy:i["親友干涉"].male||"明確立場：「我會處理」+事後同步結果",femaleStrategy:i["親友干涉"].female||"預設「防火牆」：「這事我們自己決定」"}],timing:a?a[1].trim():"巳時（9-11時）與午時（11-13時）",methods:s?s[1].trim():"土火相生溝通法"};return{type:"communication-structure",sections:[r,c]}}catch(t){return console.error("Error parsing communication advice content:",t),{type:"text",content:e}}},N=(e,t)=>{for(let n of["".concat(t,"提升建議[：]*\\*\\*[^：]*行動建議[：]*([\\s\\S]*?)(?=開運物|").concat("男方"===t?"女方":"共同","|$)"),"".concat(t,"提升建議[\\s\\S]*?行動建議[\\s\\S]*?([\\s\\S]*?)(?=開運物|").concat("男方"===t?"女方":"共同","|$)")]){let t=RegExp(n,"i"),s=e.match(t);if(s&&s[1]){let e=s[1].trim(),t=e.match(/\d+\.\s*([^0-9]*?)(?=\d+\.|$)/g);if(t||(t=e.split("•").filter(e=>e.trim().length>0)),t&&t.length>0)return t.map(e=>e.replace(/^\d+\.\s*/,"").trim()).slice(0,3)}}let n=RegExp("".concat(t,"[^。]*([^。]*運動[^。]*|[^。]*冥想[^。]*|[^。]*學習[^。]*|[^。]*創作[^。]*)"),"g"),s=e.match(n);return s&&s.length>0?s.map(e=>e.trim()).slice(0,2):[]},w=(e,t)=>{for(let n of["".concat(t,"提升建議[\\s\\S]*?\\*\\* 開運物[：]*([^*]*?)(?=\\*\\*|").concat("男方"===t?"女方":"共同","|$)"),"".concat(t,"提升建議[\\s\\S]*?開運物[\\s\\S]*?([\\s\\S]*?)(?=").concat("男方"===t?"女方":"共同","|$)")]){let t=RegExp(n,"i"),s=e.match(t);if(s&&s[1]){let e=s[1].trim().replace(/^\s*：\s*/,""),t=e.split(/[、，,]/).filter(e=>e.trim().length>0);return t.length>0?t:e}}let n=RegExp("".concat(t,"適合[^。]*"),"g"),s=e.match(n);return s?s[0].replace("".concat(t,"適合"),"").trim():""},S=e=>{for(let t of[/\*\* 每週儀式：([\s\S]*?)(?=\*\*|$)/,/每週儀式[：]*([^場合]*?)(?=場合|$)/i,/每週六[^。]*。?/]){let n=e.match(t);if(n&&n[1])return n[1].trim();if(n&&n[0]&&t.source.includes("每週六"))return n[0]}for(let t of[/每週[^。]*共同[^。]*。/,/定期[^。]*活動[^。]*。/,/共同[^。]*儀式[^。]*。/]){let n=e.match(t);if(n)return n[0]}return""},C=e=>{try{let t=null;for(let n of[/\*\* 場合色彩搭配：([\s\S]*?)(?=###|$)/,/場合色彩搭配[：]*([^#]*?)(?=###|四、|$)/i,/重要商務場合[：]*([^#]*?)(?=###|四、|$)/i]){let s=e.match(n);if(s&&s[1]){t=s[1].trim();break}}if(t){let e=[],n=["重要商務場合","社交聚會","居家生活"];for(let s of n){let a=RegExp("".concat(s,"[：]*([\\s\\S]*?)(?=").concat(n.filter(e=>e!==s).join("|"),"|$)"),"i"),l=t.match(a);if(l&&l[1]){let t=l[1].trim(),n=t.match(/[-–]*\s*男方[：]*([^\n]*)/),a=t.match(/[-–]*\s*女方[：]*([^\n]*)/),i=t.match(/[-–]*\s*能量作用[：]*([^\n]*)/);n&&a&&e.push({title:s,colors:{male:[n[1].trim()],female:[a[1].trim()]},energyFunction:i?i[1].trim():"五行調和"})}}return e}return[]}catch(e){return console.error("Error extracting situation table:",e),[]}},E=e=>{try{e.match(/男方適合[^。]*。/g),e.match(/女方適合[^。]*。/g),e.match(/每月[^。]*農曆初[^。]*。/),e.match(/共同[^。]*。/g);let t=e.match(/居家風水[^。]*。|家居佈置[^。]*。|擺放[^。]*。/g),n=e.match(/年度幸運色系[：:]?([^。]*)/);e.match(/開運物品推薦[：:]?([^。]*)/);let s=e.match(/雙方五行[^。]*互補關係[^。]*。/),a={title:"能量提升建議",type:"energy-enhancement",maleSection:{title:"男方提升建議",actionAdvice:N(e,"男方"),accessories:w(e,"男方")},femaleSection:{title:"女方提升建議",actionAdvice:N(e,"女方"),accessories:w(e,"女方")},sharedEnhancement:{title:"共同能量場強化",weeklyRitual:{title:"每週儀式",content:S(e)},situations:C(e)}};return s&&(a.analysis=s[0]),t&&t.length>0&&(a.fengShuiSuggestions=t),n&&(a.luckyColors=n[1].trim()),a}catch(t){return console.error("Error parsing energy enhancement content:",t),{type:"text",content:e}}},F=e=>{try{let t={type:"relationship-taboos",title:"感情關係禁忌",sections:[],monthlyNote:null},n=e.split("\n").filter(e=>""!==e.trim()),s=null,a=null,l="";for(let e=0;e<n.length;e++){let i=n[e].trim();if("溝通禁忌"===i){s={title:"溝通禁忌",color:"bg-pink-600",subsections:[]},t.sections.push(s);continue}if("行為禁忌"===i){s={title:"行為禁忌",color:"bg-red-600",subsections:[]},t.sections.push(s);continue}if("環境禁忌"===i){s={title:"環境禁忌",color:"bg-red-800",subsections:[]},t.sections.push(s);continue}if(i.startsWith("每月初")){t.monthlyNote={title:"每月初",content:i};continue}s&&("女方忌用"===i||"男方忌用"===i||"春季"===i||"夏季"===i||"戊月"===i||"約會避開"===i||"同房禁忌"===i?(a&&l.trim()&&(a.content=l.trim(),l=""),a={title:i,content:""},s.subsections.push(a)):a&&""!==i&&(l&&(l+=" "),l+=i))}return a&&l.trim()&&(a.content=l.trim()),0===t.sections.length&&(t.sections=[{title:"溝通禁忌",color:"bg-pink-600",subsections:[{title:"女方忌用",content:"「你總是…」「為什麼不…」（黃木食神受剋易引爆情緒）"},{title:"男方忌用",content:"「隨便」「以後再說」（子水七殺過量拖延強化冷暴力）"}]},{title:"行為禁忌",color:"bg-red-600",subsections:[{title:"春季",content:"避免在申時（15-17時）討論敏感話題，因此時金氣旺盛易引發爭執"},{title:"夏季",content:"忌在臥室西北方放置尖銳物品，防止金木相剋影響感情"},{title:"戊月",content:"2025年農曆九月需特別注意財務規劃，避免因金錢問題產生隔閡"}]},{title:"環境禁忌",color:"bg-red-800",subsections:[{title:"約會避開",content:"約會避開：火鍋店（火氣過重）、地下室（水氣滯沉）"},{title:"同房禁忌",content:"子時（23-1點）宜砂，易成心結；可改為備忘錄次日再議"}]}]),t.monthlyNote||(t.monthlyNote={title:"每月初",content:"化解方法：在客廳東南方懸掛牡丹圖（木火相生），共同佩戴鴛鴦玉佩增強緣分"}),t}catch(t){return console.error("Error parsing relationship taboos content:",t),{type:"text",content:e}}},A=e=>{try{let t=e.match(/具体分析[：:]?([\s\S]*?)(?=行动建议|时机与方法|注意事项|$)/),n=e.match(/行动建议[：:]?([\s\S]*?)(?=时机与方法|注意事项|$)/),s=e.match(/时机与方法[：:]?([\s\S]*?)(?=注意事项|$)/),a=e.match(/注意事项[：:]?([\s\S]*?)$/),l={analysis:t?t[1].trim():"",actions:n?n[1].trim():"",timing:s?s[1].trim():"",notes:a?a[1].trim():""},i=[];if(l.actions.includes("立春")||l.actions.includes("年度")||e.includes("立春")){let t=D(e,"立春|年度|計劃|规划")||l.actions||"避免重大關係決策（如同居、購房），優先經營日常溫情。";i.push({title:"春季-黃月",color:"bg-yellow-500",content:t})}if(l.timing.includes("夏季")||l.timing.includes("四月")||e.includes("巳火")){let t=D(e,"夏季|夏|四月|五月|六月|巳|午|未|升温|庆典")||l.timing||"每月安排一次「無目的約會」（如深夜散步、看星星），脫離現實壓力場景。最佳感情升溫期，適合見家長或舉辦慶典。";i.push({title:"立夏至處暑",color:"bg-yellow-500",content:t})}if(l.notes.includes("申")||l.notes.includes("七月")||e.includes("注意")){let t=D(e,"申|七月|八月|九月|注意|避免|分歧")||l.notes||"男方主動策劃驚喜（丁火需木火激發熱情），例如親手製作禮物。需注意避免翻舊賬，加強溝通。";i.push({title:"白露後",color:"bg-yellow-500",content:t})}return 0===i.length&&i.push({title:"春季-黃月",color:"bg-yellow-500",content:l.actions||"避免重大關係決策（如同居、購房），優先經營日常溫情。"},{title:"立夏至處暑",color:"bg-yellow-500",content:l.timing||"每月安排一次「無目的約會」（如深夜散步、看星星），脫離現實壓力場景。"},{title:"白露後",color:"bg-yellow-500",content:l.notes||"男方主動策劃驚喜（丁火需木火激發熱情），例如親手製作禮物。"}),{type:"subsections",subsections:i}}catch(t){return console.error("Error parsing relationship development content:",t),{type:"text",content:e}}},D=(e,t)=>{try{let n=RegExp("([^。！？]*(?:".concat(t,")[^。！？]*[。！？])"),"gi"),s=e.match(n);if(s&&s.length>0)return s.slice(0,3).join("");let a=RegExp("([^。]{0,50}(?:".concat(t,")[^。]{0,50})"),"gi"),l=e.match(a);if(l&&l.length>0)return l[0].trim()+"。";return null}catch(e){return console.error("Error extracting seasonal content:",e),null}},k=e=>e.replace(/^[：:]\s*/,"").replace(/【[^】]*】/g,"").replace(/\*\*/g,"").replace(/####/g,"").replace(/\n\s*\n/g,"\n").trim(),T=e=>{for(let t of[/夫妻箴言[：:]([^。\n]*)/,/感情核心[：:]([^。\n]*)/,/關係要訣[：:]([^。\n]*)/]){let n=e.match(t);if(n&&n[1])return n[1].trim()}return"夫妻同心，其利斷金。相互理解，彼此包容，愛情長久。"},B=e=>({關係發展建議:"根據夫妻雙方八字合盤分析，建議在春季加強溝通，夏季注意情緒管理，秋季深化感情，冬季規劃未來。重點把握關鍵時間節點，避免在不利時期做重大決定。",溝通建議:"夫妻溝通需要根據雙方性格特點調整方式。建議選擇合適的時間和地點，用溫和的語氣表達想法，多聆聽對方觀點，避免在情緒激動時討論重要問題。",能量提升建議:"通過五行調和提升夫妻感情能量。建議佩戴適合的飾品，調整居家環境，選擇有利的活動時間，共同進行能量提升的活動。",感情關係禁忌:F("感情關係禁忌\n溝通禁忌\n女方忌用\n「你總是…」「為什麼不…」（黃木食神受剋易引爆情緒）\n\n男方忌用\n「隨便」「以後再說」（子水七殺過量拖延強化冷暴力）\n\n行為禁忌\n春季\n避免在申時（15-17時）討論敏感話題，因此時金氣旺盛易引發爭執\n\n夏季\n忌在臥室西北方放置尖銳物品，防止金木相剋影響感情\n\n戊月\n2025年農曆九月需特別注意財務規劃，避免因金錢問題產生隔閡\n\n環境禁忌\n約會避開\n約會避開：火鍋店（火氣過重）、地下室（水氣滯沉）\n\n同房禁忌\n子時（23-1點）宜砂，易成心結；可改為備忘錄次日再議\n\n每月初\n化解方法：在客廳東南方懸掛牡丹圖（木火相生），共同佩戴鴛鴦玉佩增強緣分")})[e]||"正在為您分析夫妻關係建議...",P=(e,t,n)=>({title:"夫妻開運建議",subtitle:"".concat((null==t?void 0:t.name)||"男方"," & ").concat((null==n?void 0:n.name)||"女方"," 感情指南"),coreIcon:"\uD83D\uDC95",iconColor:"bg-[#B4003C]",coreTitle:"夫妻和諧",coreIconList:[{icon:"/images/report/star.png",label:"關係發展建議",color:"bg-[#DEAB20]",active:!0},{icon:"/images/report/chat.png",label:"溝通建議",color:"bg-[#8A71C7]",active:!1},{icon:"/images/report/fengshui.png",label:"能量提升建議",color:"bg-[#8FA940]",active:!1},{icon:"/images/report/warning.png",label:"感情關係禁忌",color:"bg-[#B4003C]",active:!1}],coreCategories:[{title:"關係發展建議",subtitle:"等待AI分析",icon:"/images/report/star.png",color:"bg-[#DEAB20]",content:"正在為您生成個人化的夫妻關係發展建議，請稍候..."},{title:"溝通建議",subtitle:"等待AI分析",icon:"/images/report/chat.png",color:"bg-[#8A71C7]",content:"正在為您生成個人化的夫妻溝通建議，請稍候..."},{title:"能量提升建議",subtitle:"等待AI分析",icon:"/images/report/fengshui.png",color:"bg-[#8FA940]",content:"正在為您生成個人化的夫妻能量提升建議，請稍候..."},{title:"感情關係禁忌",subtitle:"等待AI分析",icon:"/images/report/warning.png",color:"bg-[#B4003C]",content:"正在為您生成個人化的夫妻相處禁忌，請稍候..."}],motto:"夫妻同心，其利斷金。相互理解，彼此包容，愛情長久。",coreStrategy:"夫妻八字合盤，五行調和，感情長久",year:e,concern:"感情",user1Birthday:(null==t?void 0:t.birthDateTime)||"",user2Birthday:(null==n?void 0:n.birthDateTime)||"",user1Name:(null==t?void 0:t.name)||"男方",user2Name:(null==n?void 0:n.name)||"女方",error:"AI分析服務暫時不可用，系統正在嘗試重新連線。"}),I=(e,t,n)=>"couple_core_suggestion_".concat(e.birthDateTime,"_").concat(t.birthDateTime,"_").concat(n);if((0,a.useEffect)(()=>{if(!n||!l)return;let e=I(n,l,i);if(r&&r[e]){console.log("\uD83D\uDCCB Using cached couple core suggestion analysis"),d(r[e]),g(!1);return}g(!0),f(null),b(n,l,i).then(t=>{d(t),c(n=>({...n,[e]:t}))}).catch(e=>{console.error("Couple core suggestion analysis failed:",e),f(e.message),d(P(i,n,l))}).finally(()=>{g(!1)})},[n,l,i,r,c]),u)return(0,s.jsx)("section",{className:"relative mx-auto mb-6 bg-white sm:mb-10",style:{width:"95%",padding:"40px",boxShadow:"0 4px 4px rgba(0, 0, 0, 0.25)",borderRadius:"45px"},children:(0,s.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-b-2 border-pink-600 rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-3 text-gray-600",children:"生成夫妻開運建議中..."})]})});if(!o)return(0,s.jsx)("section",{className:"relative mx-auto mb-6 bg-white sm:mb-10",style:{width:"95%",padding:"40px",boxShadow:"0 4px 4px rgba(0, 0, 0, 0.25)",borderRadius:"45px"},children:(0,s.jsx)("div",{className:"py-8 text-center text-gray-500",children:"無法載入夫妻開運建議資料"})});let M=o.coreCategories[h];return(0,s.jsx)(Z.qw,{componentName:"CoupleCoreSuggestion",children:(0,s.jsxs)("section",{className:"relative mx-auto mb-6 bg-white sm:mb-10",style:{width:"100%",padding:"40px",boxShadow:"0 4px 4px rgba(0, 0, 0, 0.25)",borderRadius:"45px"},children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-8",children:(0,s.jsx)("h2",{style:{fontFamily:"Noto Serif TC, serif",fontSize:"40px",fontWeight:800,color:"#B4003C"},children:"感情開運建議"})}),(null==o?void 0:o.error)&&(0,s.jsx)("div",{className:"p-3 mb-6 bg-yellow-100 border border-yellow-400 rounded-lg",children:(0,s.jsxs)("p",{className:"text-sm text-yellow-700",children:["⚠️ ",o.error]})}),(0,s.jsxs)("div",{className:"p-6 mb-8 bg-white",children:[(0,s.jsx)("div",{className:"flex items-center justify-between w-full mb-6",children:o.coreIconList.map((e,t)=>{var n,a;return(0,s.jsxs)("button",{onClick:()=>x(t),className:"flex flex-col items-center space-y-2 transition-all duration-300 flex-1 ".concat(h===t?"transform scale-110":"hover:scale-105"),children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-white transition-all duration-300 ".concat((n=e.label,({關係發展建議:(a=h===t)?"bg-[#DEAB20]":"bg-white",溝通建議:a?"bg-[#8A71C7]":"bg-white",能量提升建議:a?"bg-[#8FA940]":"bg-white",感情關係禁忌:a?"bg-[#B4003C]":"bg-white"})[n]||(a?"bg-gray-600":"bg-gray-300"))),style:{boxShadow:"0 4px 4px rgba(0, 0, 0, 0.25)"},children:(0,s.jsx)("img",{src:{關係發展建議:"/images/report/star.png",溝通建議:"/images/report/chat.png",能量提升建議:"/images/report/fengshui.png",感情關係禁忌:"/images/report/warning.png"}[e.label]||"/images/report/heart.png",alt:e.label,className:"w-8 h-8",style:{filter:h===t?"brightness(0) invert(1)":"none"}})}),(0,s.jsx)("span",{className:"text-sm font-medium ".concat(h===t?"text-gray-800":"text-gray-500"),children:e.label})]},t)})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("h3",{style:{fontFamily:"Noto Serif TC, serif",fontSize:"40px",fontWeight:700,color:{關係發展建議:"#DEAB20",溝通建議:"#8A71C7",能量提升建議:"#8FA940",感情關係禁忌:"#B4003C"}[null===(t=o.coreIconList[h])||void 0===t?void 0:t.label]||"#B4003C",marginBottom:"8px"},children:M.title})}),(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)("div",{className:"p-6 ",children:(0,s.jsx)("div",{className:"space-y-4",children:"object"==typeof M.content&&"subsections"===M.content.type?(0,s.jsx)("div",{className:"space-y-6",children:M.content.subsections.map((e,t)=>(0,s.jsxs)("div",{className:"overflow-hidden border border-[#EFEFEF] shadow-lg rounded-lg",children:[(0,s.jsx)("div",{className:"".concat(e.color," text-white px-4 py-2 font-medium text-center rounded-t-lg"),children:e.title}),(0,s.jsx)("div",{className:"p-4 bg-[#EFEFEF]",children:(0,s.jsx)("p",{className:"leading-relaxed text-gray-700",children:e.content})})]},t))}):"object"==typeof M.content&&"communication-structure"===M.content.type?(0,s.jsx)("div",{className:"space-y-6",children:M.content.sections.map((e,t)=>(0,s.jsx)("div",{children:"partner-styles"===e.type?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"mb-4 text-lg font-semibold text-purple-600",children:e.title}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"p-4 border border-blue-200 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 mr-2 bg-blue-500 rounded-full"}),(0,s.jsx)("span",{className:"font-medium text-blue-700",children:"男方溝通風格"})]}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-700",children:e.maleStyle})]}),(0,s.jsxs)("div",{className:"p-4 border border-pink-200 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 mr-2 bg-pink-500 rounded-full"}),(0,s.jsx)("span",{className:"font-medium text-pink-700",children:"女方溝通風格"})]}),(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-700",children:e.femaleStyle})]})]})]}):"practical-application"===e.type?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"mb-4 text-lg font-semibold text-purple-600",children:e.title}),e.subsections.map((e,t)=>(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("div",{className:"px-3 py-2 text-sm font-medium text-center text-white bg-green-500 rounded",children:e.title}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"p-4 border border-blue-200 rounded-lg bg-blue-50",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 mr-2 bg-blue-500 rounded-full"}),(0,s.jsx)("span",{className:"text-sm font-medium text-blue-700",children:"男方溝通策略"})]}),(0,s.jsx)("div",{className:"p-3 text-sm leading-relaxed text-gray-700 bg-gray-100 rounded",children:e.maleStrategy})]}),(0,s.jsxs)("div",{className:"p-4 border border-pink-200 rounded-lg bg-pink-50",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 mr-2 bg-pink-500 rounded-full"}),(0,s.jsx)("span",{className:"text-sm font-medium text-pink-700",children:"女方溝通策略"})]}),(0,s.jsx)("div",{className:"p-3 text-sm leading-relaxed text-gray-700 bg-gray-100 rounded",children:e.femaleStrategy})]})]})]},t)),e.timing&&(0,s.jsxs)("div",{className:"p-3 mt-4 rounded-lg bg-purple-50",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-purple-700",children:"最佳時機："}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:e.timing})]})]}):null},t))}):"object"==typeof M.content&&"relationship-taboos"===M.content.type?(0,s.jsx)("div",{className:"space-y-6",children:M.content.sections.map((e,t)=>(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"".concat(e.color," text-white px-4 py-3 font-bold text-center rounded-lg"),children:e.title}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.subsections.map((e,n)=>(0,s.jsxs)("div",{className:"overflow-hidden border-2 border-gray-200 rounded-lg",children:[(0,s.jsx)("div",{className:"".concat(0===t?"bg-pink-500":1===t?"bg-green-500":"bg-red-700"," text-white px-3 py-2 font-medium text-center"),children:e.title}),(0,s.jsx)("div",{className:"p-4 bg-gray-50",children:(0,s.jsx)("p",{className:"text-sm leading-relaxed text-gray-700",children:e.content})})]},n))})]},t))}):"object"==typeof M.content&&"energy-enhancement"===M.content.type?(0,s.jsxs)("div",{className:"space-y-6",children:[M.content.analysis&&(0,s.jsxs)("div",{className:"p-4 mb-6 bg-green-100 border border-green-300 rounded-lg",children:[(0,s.jsx)("h4",{className:"mb-2 font-medium text-green-700",children:"五行能量分析"}),(0,s.jsx)("p",{className:"text-sm text-gray-700",children:M.content.analysis})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"overflow-hidden border-2 border-blue-300 rounded-lg",children:[(0,s.jsx)("div",{className:"px-4 py-2 font-medium text-center text-white bg-blue-500 rounded-t-lg",children:M.content.maleSection.title}),(0,s.jsxs)("div",{className:"p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"p-3 bg-blue-100 rounded-lg",children:[(0,s.jsx)("h5",{className:"mb-2 font-medium text-blue-700",children:"行動建議"}),M.content.maleSection.actionAdvice.map((e,t)=>(0,s.jsxs)("p",{className:"mb-2 text-sm text-gray-700",children:["• ",e]},t))]}),(0,s.jsxs)("div",{className:"p-3 rounded-lg bg-blue-50",children:[(0,s.jsx)("h5",{className:"mb-2 font-medium text-blue-700",children:"開運物"}),(0,s.jsx)("p",{className:"text-sm text-gray-700",children:M.content.maleSection.accessories})]})]})]}),(0,s.jsxs)("div",{className:"overflow-hidden border-2 border-pink-300 rounded-lg",children:[(0,s.jsx)("div",{className:"px-4 py-2 font-medium text-center text-white bg-pink-500 rounded-t-lg",children:M.content.femaleSection.title}),(0,s.jsxs)("div",{className:"p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"p-3 bg-pink-100 rounded-lg",children:[(0,s.jsx)("h5",{className:"mb-2 font-medium text-pink-700",children:"行動建議"}),M.content.femaleSection.actionAdvice.map((e,t)=>(0,s.jsxs)("p",{className:"mb-2 text-sm text-gray-700",children:["• ",e]},t))]}),(0,s.jsxs)("div",{className:"p-3 rounded-lg bg-pink-50",children:[(0,s.jsx)("h5",{className:"mb-2 font-medium text-pink-700",children:"開運物"}),(0,s.jsx)("p",{className:"text-sm text-gray-700",children:M.content.femaleSection.accessories})]})]})]})]}),M.content.fengShuiSuggestions&&(0,s.jsxs)("div",{className:"p-4 border border-yellow-300 rounded-lg bg-yellow-50",children:[(0,s.jsx)("h4",{className:"mb-2 font-medium text-yellow-700",children:"居家風水建議"}),M.content.fengShuiSuggestions.map((e,t)=>(0,s.jsxs)("p",{className:"mb-2 text-sm text-gray-700",children:["• ",e]},t))]}),M.content.luckyColors&&(0,s.jsxs)("div",{className:"p-4 border border-purple-300 rounded-lg bg-purple-50",children:[(0,s.jsx)("h4",{className:"mb-2 font-medium text-purple-700",children:"年度幸運色系"}),(0,s.jsx)("p",{className:"text-sm text-gray-700",children:M.content.luckyColors})]}),(0,s.jsxs)("div",{className:"overflow-hidden border-2 border-green-300 rounded-lg bg-green-50",children:[(0,s.jsx)("div",{className:"px-4 py-2 font-medium text-center text-white bg-green-500",children:M.content.sharedEnhancement.title}),(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"p-4 bg-white border border-green-200 rounded-lg",children:[(0,s.jsx)("h5",{className:"mb-2 font-medium text-green-700",children:M.content.sharedEnhancement.weeklyRitual.title}),(0,s.jsx)("p",{className:"text-sm text-gray-700",children:M.content.sharedEnhancement.weeklyRitual.content})]}),M.content.sharedEnhancement.situations&&M.content.sharedEnhancement.situations.length>0?(0,s.jsxs)("div",{className:"overflow-hidden bg-white border border-green-200 rounded-lg",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 text-sm font-medium text-gray-700 bg-green-100",children:[(0,s.jsx)("div",{className:"p-2 text-center border-r border-green-200",children:"場合"}),(0,s.jsx)("div",{className:"p-2 text-center border-r border-green-200",children:"男方主色"}),(0,s.jsx)("div",{className:"p-2 text-center border-r border-green-200",children:"女方主色"}),(0,s.jsx)("div",{className:"p-2 text-center",children:"能量作用"})]}),M.content.sharedEnhancement.situations.map((e,t)=>(0,s.jsxs)("div",{className:"grid grid-cols-4 text-sm border-b border-green-100 last:border-b-0",children:[(0,s.jsx)("div",{className:"p-2 font-medium text-center border-r border-green-200 bg-green-50",children:e.title}),(0,s.jsx)("div",{className:"p-2 text-center border-r border-green-200",children:(0,s.jsx)("div",{className:"flex flex-wrap justify-center gap-1",children:e.colors.male.map((e,t)=>(e.match(/[深淺][藍綠黃紅白黑灰橙紫粉棕米卡][\w色]*/g)||e.match(/[藍綠黃紅白黑灰橙紫粉棕米卡][\w色]*/g)||["墨綠"]).map((e,n)=>(0,s.jsxs)("div",{className:"flex items-center mb-1 space-x-1",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.includes("藍")||e.includes("深藍")?"bg-blue-600":e.includes("綠")||e.includes("淺綠")||e.includes("卡其")?"bg-green-500":e.includes("灰")||e.includes("深灰")?"bg-gray-500":e.includes("橙")||e.includes("橙紅")?"bg-orange-500":e.includes("棕")?"bg-orange-800":"bg-green-600")}),(0,s.jsx)("span",{className:"text-xs",children:e})]},"".concat(t,"-").concat(n))))})}),(0,s.jsx)("div",{className:"p-2 text-center border-r border-green-200",children:(0,s.jsx)("div",{className:"flex flex-wrap justify-center gap-1",children:e.colors.female.map((e,t)=>(e.match(/[深淺][藍綠黃紅白黑灰橙紫粉棕米][\w色]*/g)||e.match(/[藍綠黃紅白黑灰橙紫粉棕米淡][\w色]*/g)||["冰藍"]).map((e,n)=>(0,s.jsxs)("div",{className:"flex items-center mb-1 space-x-1",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.includes("粉")||e.includes("淺粉")?"bg-pink-300":e.includes("紫")||e.includes("淡紫")?"bg-purple-300":e.includes("藍")||e.includes("冰藍")?"bg-blue-200":e.includes("米")||e.includes("米色")?"bg-yellow-100":e.includes("白")||e.includes("銀白")?"bg-gray-100":e.includes("黃")||e.includes("淡黃")?"bg-yellow-200":"bg-pink-200")}),(0,s.jsx)("span",{className:"text-xs",children:e})]},"".concat(t,"-").concat(n))))})}),(0,s.jsx)("div",{className:"p-2 text-center",children:(0,s.jsx)("span",{className:"text-xs text-gray-600",children:e.energyFunction})})]},t))]}):(0,s.jsxs)("div",{className:"p-4 border border-orange-300 rounded-lg bg-orange-50",children:[(0,s.jsx)("h5",{className:"mb-2 font-medium text-orange-700",children:"場合色彩搭配"}),(0,s.jsx)("p",{className:"text-sm text-orange-600",children:"\uD83D\uDD04 AI 尚未生成場合色彩搭配表格。這是因為當前的 API 輸出中缺少結構化的色彩建議部分。"}),(0,s.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"請重新生成分析以獲取完整的色彩搭配建議。"})]})]})]})]}):(0,s.jsx)("div",{className:"text-base leading-relaxed text-gray-700 whitespace-pre-line",children:"object"==typeof M.content&&"text"===M.content.type?M.content.content:M.content})})})})]})]})})}function V(){let[e,t]=(0,a.useState)(null),[n,d]=(0,a.useState)(!0),[m,x]=(0,a.useState)(null),[p,f]=(0,a.useState)("analysis"),b=(0,l.useSearchParams)(),y=(0,l.useRouter)(),v=(0,a.useMemo)(()=>e?{birthDateTime:e.birthday,gender:e.gender,concern:"感情",problem:e.problem}:null,[null==e?void 0:e.birthday,null==e?void 0:e.gender,null==e?void 0:e.problem]),j=(0,a.useMemo)(()=>e?{birthDateTime:e.birthday2,gender:e.gender2,concern:"感情",problem:e.problem}:null,[null==e?void 0:e.birthday2,null==e?void 0:e.gender2,null==e?void 0:e.problem]),N=e=>{if(!(null==e?void 0:e.birthDateTime))return null;let t=(0,c.Ay)(e.birthDateTime,e.gender||"male");if(!t)return null;let n={金:0,木:0,水:0,火:0,土:0};t.yearStemWuxing&&n[t.yearStemWuxing]++,t.yearBranchWuxing&&n[t.yearBranchWuxing]++,t.monthStemWuxing&&n[t.monthStemWuxing]++,t.monthBranchWuxing&&n[t.monthBranchWuxing]++,t.dayStemWuxing&&n[t.dayStemWuxing]++,t.dayBranchWuxing&&n[t.dayBranchWuxing]++,t.hourStemWuxing&&n[t.hourStemWuxing]++,t.hourBranchWuxing&&n[t.hourBranchWuxing]++;let s=Object.entries(n).filter(e=>{let[t,n]=e;return 0===n}).map(e=>{let[t]=e;return t});return{wuxingData:t,elementCounts:n,missingElements:s,dominantElement:Object.keys(n).reduce((e,t)=>n[e]>n[t]?e:t)}},w=e=>{if(!e||"object"!=typeof e)return{};let t=Object.values(e).reduce((e,t)=>e+t,0),n={};return Object.entries(e).forEach(e=>{let[s,a]=e,l=a/t*100;l>=30?n[s]="強":l>=15?n[s]="中":n[s]="弱"}),n},S=e=>{if(!e||!e.elementCounts)return[];let{elementCounts:t,dominantElement:n}=e;if(!t||"object"!=typeof t)return[];let s=[],a=Object.entries(t).filter(e=>{let[t,n]=e;return n<=1}).map(e=>{let[t]=e;return t});a.length>0&&s.push(...a);let l={金:["火","木"],木:["金","土"],水:["土","火"],火:["水","金"],土:["木","水"]};return l[n]&&l[n].forEach(e=>{s.includes(e)||s.push(e)}),s.slice(0,3)};return((0,a.useEffect)(()=>{(async()=>{try{let c=b.get("birthday"),o=b.get("birthday2"),m=b.get("gender"),u=b.get("gender2"),g=b.get("time"),h=b.get("time2"),p=b.get("problem");if(c&&o){console.log("\uD83D\uDD0D Using fresh URL parameters for couple analysis"),console.log("\uD83D\uDCC5 Birthday 1:",c),console.log("\uD83D\uDCC5 Birthday 2:",o);let e=b.get("originalProblem"),n=e||p||"感情關係和諧改善建議";console.log("\uD83D\uDD0D URL參數詳細檢查:"),console.log("   problem:",p),console.log("   originalProblem:",e),console.log("   最終使用的 specificProblem:",n),t({birthday:c,birthday2:o,gender:m||"male",gender2:u||"female",time:g,time2:h,concern:"感情",problem:n}),console.log("\uD83D\uDCCA 使用URL參數設置的報告數據:",{birthday:c,birthday2:o,problem:n,urlProblem:p,originalProblem:e,finalProblem:n}),d(!1);return}let f=b.get("id");if(f){console.log("\uD83D\uDD0D 正在載入報告 ID:",f);let c=await fetch("/api/smart-chat2/".concat(f));if(c.ok){let o=await c.json();if(console.log("\uD83D\uDCC4 載入的報告數據:",o),o&&o.userInputs){var e,n,s,a,l,i,r;let c=o.userInputs;if(!c.birthday||!c.birthday2){console.error("❌ 缺少必要的生日資料:",c),x("報告資料不完整：缺少生日資訊"),d(!1);return}t({birthday:c.birthday||c.user1_birthday,birthday2:c.birthday2||c.user2_birthday,gender:c.gender||c.user1_gender||"male",gender2:c.gender2||c.user2_gender||"female",time:c.time||c.user1_time,time2:c.time2||c.user2_time,concern:"感情",problem:(null===(e=o.reportMetadata)||void 0===e?void 0:e.originalSpecificProblem)||c.problem||(null===(s=o.messages)||void 0===s?void 0:null===(n=s[0])||void 0===n?void 0:n.content)||"感情配對分析",reportId:f}),console.log("\uD83D\uDCCA 設置的報告數據:",{reportId:f,originalSpecificProblem:null===(a=o.reportMetadata)||void 0===a?void 0:a.originalSpecificProblem,inputsProblem:c.problem,finalProblem:(null===(l=o.reportMetadata)||void 0===l?void 0:l.originalSpecificProblem)||c.problem||(null===(r=o.messages)||void 0===r?void 0:null===(i=r[0])||void 0===i?void 0:i.content)||"感情配對分析"}),d(!1);return}console.error("❌ 報告格式錯誤:",o),x("報告資料格式錯誤"),d(!1);return}console.error("❌ 無法載入報告:",c.status),x("無法載入報告資料"),d(!1);return}if(!c||!o){x("缺少必要的出生日期信息"),d(!1);return}console.log("⚠️ Fallback case - should not happen with new logic"),x("無法獲取分析數據"),d(!1)}catch(e){console.error("Error loading report data:",e),x("無法讀取報告數據"),d(!1)}})()},[b]),n)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-[#EFEFEF]",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 mx-auto mb-4 border-b-2 border-pink-500 rounded-full animate-spin"}),(0,s.jsx)("p",{className:"text-gray-600",children:"生成合婚報告中..."})]})}):m?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-[#EFEFEF]",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(i.A,{className:"w-16 h-16 mx-auto mb-4 text-red-400"}),(0,s.jsx)("p",{className:"mb-4 text-gray-600",children:m}),(0,s.jsx)("button",{onClick:()=>y.push("/"),className:"px-6 py-2 text-white transition-colors bg-pink-500 rounded-lg hover:bg-pink-600",children:"返回智能諮詢"})]})}):e?(0,s.jsx)(o.oo,{children:(0,s.jsxs)(u,{user1:{birthDateTime:e.birthday,gender:e.gender},user2:{birthDateTime:e.birthday2,gender:e.gender2},specificProblem:e.problem,children:[(0,s.jsx)(g.default,{from:"report",backgroundColor:"white"}),(0,s.jsx)("div",{className:"w-full mt-16 bg-gradient-to-r from-[#C74772] to-[#D09900] py-6",children:(0,s.jsx)("div",{className:"max-w-6xl px-4 mx-auto",children:(0,s.jsxs)("div",{className:"flex flex-wrap justify-center gap-6",children:[(0,s.jsx)("button",{onClick:()=>f("analysis"),className:"px-8 py-4 rounded-full font-semibold text-lg transition-all duration-200 ".concat("analysis"===p?"bg-gradient-to-r from-[#C74772] to-[#D09900] text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]":"bg-white text-[#374A37] shadow-inner shadow-[inset_0_4px_4px_rgba(0,0,0,0.25)]"),style:{fontFamily:"Noto Serif TC, serif",boxShadow:"0 4px 4px rgba(0, 0, 0, 0.25)"},children:"姻緣合盤流年分析報告"}),(0,s.jsx)("button",{onClick:()=>f("solution"),className:"px-8 py-4 rounded-full font-semibold text-lg transition-all duration-200 ".concat("solution"===p?"bg-gradient-to-r from-[#C74772] to-[#D09900] text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]":"bg-white text-[#374A37] shadow-inner shadow-[inset_0_4px_4px_rgba(0,0,0,0.25)]"),style:{fontFamily:"Noto Serif TC, serif",boxShadow:"0 4px 4px rgba(0, 0, 0, 0.25)"},children:"專屬問題解決方案"})]})})}),(0,s.jsx)("div",{className:"flex items-center justify-center w-full min-h-screen bg-[#EFEFEF]",children:(0,s.jsxs)("div",{className:"w-[95%] max-w-7xl px-4 py-8 mx-auto",children:[(0,s.jsx)("div",{className:"mb-8 text-start",children:(0,s.jsx)("h1",{className:"mb-2 font-extrabold",style:{fontFamily:"Noto Serif TC, Serif",fontWeight:800,fontSize:"60px",color:"#D91A5A"},children:"姻緣配對分析"})}),"analysis"===p&&(0,s.jsx)("div",{className:"tab-content",children:e&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z,{user1:{birthDateTime:e.birthday,gender:e.gender},user2:{birthDateTime:e.birthday2,gender:e.gender2},calculateWuxingAnalysis:N,analyzeWuxingStrength:w,determineUsefulGods:S}),(0,s.jsx)(q,{user1:{birthDateTime:e.birthday,gender:e.gender,name:e.name||"男方"},user2:{birthDateTime:e.birthday2,gender:e.gender2,name:e.name2||"女方"},currentYear:new Date().getFullYear()}),(0,s.jsx)(H,{user1:{birthDateTime:e.birthday,gender:e.gender,name:e.name||"男方"},user2:{birthDateTime:e.birthday2,gender:e.gender2,name:e.name2||"女方"}}),(0,s.jsx)(X,{user1:{birthDateTime:e.birthday,gender:e.gender,name:e.name||"男方"},user2:{birthDateTime:e.birthday2,gender:e.gender2,name:e.name2||"女方"},currentYear:new Date().getFullYear()}),(0,s.jsx)(Q,{user1:{birthDateTime:e.birthday,gender:e.gender,name:e.name||"男方"},user2:{birthDateTime:e.birthday2,gender:e.gender2,name:e.name2||"女方"},currentYear:new Date().getFullYear()})]})}),e&&v&&j&&(0,s.jsx)("div",{className:"w-full mx-auto mb-6 ".concat("solution"===p?"block":"hidden"),children:(0,s.jsx)(B,{user1:v,user2:j,specificProblem:e.problem,calculateWuxingAnalysis:N,analyzeWuxingStrength:w,determineUsefulGods:S})}),"solution"===p&&(0,s.jsx)("div",{className:"tab-content",children:" "})]})}),(0,s.jsx)(h.A,{})]})}):(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-[#EFEFEF]",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(r.A,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),(0,s.jsx)("p",{className:"text-gray-600",children:"未找到報告數據"}),(0,s.jsx)("button",{onClick:()=>y.push("/"),className:"px-6 py-2 mt-4 text-white transition-colors bg-pink-500 rounded-lg hover:bg-pink-600",children:"返回智能諮詢"})]})})}},51976:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(19946).A)("heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},92138:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(19946).A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[8057,586,6453,7215,8543,6874,6491,3519,9855,5226,5617,8441,1684,7358],()=>t(32379)),_N_E=e.O()}]);