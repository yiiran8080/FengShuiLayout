(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[704],{6034:(e,t,a)=>{Promise.resolve().then(a.bind(a,87134))},19924:(e,t,a)=>{"use strict";a.d(t,{F:()=>r});var s=a(73243);a(45323);var i=a(88999),n=a(4318);function r(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(i.bL,{"data-slot":"scroll-area",className:(0,n.cn)("relative",t),...r,children:[(0,s.jsx)(i.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:a}),(0,s.jsx)(o,{}),(0,s.jsx)(i.OK,{})]})}function o(e){let{className:t,orientation:a="vertical",...r}=e;return(0,s.jsx)(i.VM,{"data-slot":"scroll-area-scrollbar",orientation:a,className:(0,n.cn)("flex touch-none p-px transition-colors select-none visible","vertical"===a&&"h-full w-2.5 border-l border-l-transparent","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent",t),...r,children:(0,s.jsx)(i.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}},43263:(e,t,a)=>{"use strict";a.d(t,{A7:()=>x,FN:()=>u,Oj:()=>m,Q8:()=>g,Wk:()=>p});var s=a(73243),i=a(45323),n=a(9920),r=a(772),o=a(22893),l=a(4318),d=a(43601);let c=i.createContext(null);function h(){let e=i.useContext(c);if(!e)throw Error("useCarousel must be used within a <Carousel />");return e}let u=i.forwardRef((e,t)=>{let{orientation:a="horizontal",opts:r,setApi:o,plugins:d,className:h,children:u,...p}=e,[x,g]=(0,n.A)({...r,axis:"horizontal"===a?"x":"y"},d),[m,b]=i.useState(!1),[f,v]=i.useState(!1),y=i.useCallback(e=>{e&&(b(e.canScrollPrev()),v(e.canScrollNext()))},[]),w=i.useCallback(()=>{null==g||g.scrollPrev()},[g]),j=i.useCallback(()=>{null==g||g.scrollNext()},[g]),N=i.useCallback(e=>{"ArrowLeft"===e.key?(e.preventDefault(),w()):"ArrowRight"===e.key&&(e.preventDefault(),j())},[w,j]);return i.useEffect(()=>{g&&o&&o(g)},[g,o]),i.useEffect(()=>{if(g)return y(g),g.on("reInit",y),g.on("select",y),()=>{null==g||g.off("select",y)}},[g,y]),(0,s.jsx)(c.Provider,{value:{carouselRef:x,api:g,opts:r,orientation:a||((null==r?void 0:r.axis)==="y"?"vertical":"horizontal"),scrollPrev:w,scrollNext:j,canScrollPrev:m,canScrollNext:f},children:(0,s.jsx)("div",{ref:t,onKeyDownCapture:N,className:(0,l.cn)("relative",h),role:"region","aria-roledescription":"carousel",...p,children:u})})});u.displayName="Carousel";let p=i.forwardRef((e,t)=>{let{className:a,...i}=e,{carouselRef:n,orientation:r}=h();return(0,s.jsx)("div",{ref:n,className:"overflow-hidden",children:(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex","horizontal"===r?"-ml-4":"-mt-4 flex-col",a),...i})})});p.displayName="CarouselContent";let x=i.forwardRef((e,t)=>{let{className:a,...i}=e,{orientation:n}=h();return(0,s.jsx)("div",{ref:t,role:"group","aria-roledescription":"slide",className:(0,l.cn)("min-w-0 shrink-0 grow-0 basis-full","horizontal"===n?"pl-4":"pt-4",a),...i})});x.displayName="CarouselItem";let g=i.forwardRef((e,t)=>{let{className:a,variant:i="outline",size:n="icon",...o}=e,{orientation:c,scrollPrev:u,canScrollPrev:p}=h();return(0,s.jsxs)(d.$,{ref:t,variant:i,size:n,className:(0,l.cn)("absolute  h-8 w-8 rounded-full","horizontal"===c?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",a),disabled:!p,onClick:u,...o,children:[(0,s.jsx)(r.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Previous slide"})]})});g.displayName="CarouselPrevious";let m=i.forwardRef((e,t)=>{let{className:a,variant:i="outline",size:n="icon",...r}=e,{orientation:c,scrollNext:u,canScrollNext:p}=h();return(0,s.jsxs)(d.$,{ref:t,variant:i,size:n,className:(0,l.cn)("absolute h-8 w-8 rounded-full","horizontal"===c?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",a),disabled:!p,onClick:u,...r,children:[(0,s.jsx)(o.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Next slide"})]})});m.displayName="CarouselNext"},43601:(e,t,a)=>{"use strict";a.d(t,{$:()=>l,r:()=>o});var s=a(73243);a(45323);var i=a(7843),n=a(83944),r=a(4318);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:a,size:n,asChild:l=!1,...d}=e,c=l?i.DX:"button";return(0,s.jsx)(c,{"data-slot":"button",className:(0,r.cn)(o({variant:a,size:n,className:t})),...d})}},49126:(e,t,a)=>{"use strict";a.d(t,{$q:()=>c,Gx:()=>o,Qc:()=>r,Xs:()=>l,sR:()=>i,t7:()=>d,w$:()=>s,x9:()=>n});let s={ROOM:"room",FURNITURE:"furniture"},i={LIVING_ROOM:"living_room",DINING_ROOM:"dining_room",STORAGE_ROOM:"storage_room",STUDY_ROOM:"study_room",BEDROOM:"bedroom",BATHROOM:"bathroom",KITCHEN:"kitchen",BALCONY:"balcony",GARDEN:"garden",GARAGE:"garage",CORRIDOR:"corridor"},n={BED:"bed",SOFA:"sofa",TABLE:"table",CHAIR:"chair",CABINET:"cabinet",TV:"tv",LAMP:"lamp",DOOR:"door",WINDOW:"window",BOOKSHELF:"bookshelf",WARDROBE:"wardrobe",PLANT:"plant",FRIDGE:"fridge",STOVE:"stove",SINK:"sink",WASHBASIN:"washbasin",TOILET:"toilet",SHOWER:"shower",BATHTUB:"bathtub"},r={[n.DOOR]:"门",[n.WINDOW]:"窗",[n.TABLE]:"枱",[n.CHAIR]:"椅子",[n.SOFA]:"沙发",[n.BED]:"床",[n.LAMP]:"儿童床",[n.TV]:"电视",[n.BOOKSHELF]:"茶几",[n.WARDROBE]:"柜",[n.PLANT]:"植物",[n.FRIDGE]:"冰箱",[n.STOVE]:"炉具",[n.SINK]:"锌盘",[n.WASHBASIN]:"洗手盘",[n.TOILET]:"马桶",[n.SHOWER]:"淋浴",[n.BATHTUB]:"浸浴"},o={[n.DOOR]:"門",[n.WINDOW]:"窗",[n.TABLE]:"枱",[n.CHAIR]:"椅子",[n.SOFA]:"沙發",[n.BED]:"床",[n.LAMP]:"兒童床",[n.TV]:"電視",[n.BOOKSHELF]:"茶几",[n.WARDROBE]:"櫃",[n.PLANT]:"植物",[n.FRIDGE]:"冰箱",[n.STOVE]:"爐具",[n.SINK]:"锌盘",[n.WASHBASIN]:"洗手盤",[n.TOILET]:"馬桶",[n.SHOWER]:"淋浴",[n.BATHTUB]:"浸浴"},l={[i.LIVING_ROOM]:"客厅",[i.DINING_ROOM]:"饭厅",[i.STORAGE_ROOM]:"杂物房",[i.STUDY_ROOM]:"书房",[i.BEDROOM]:"睡房",[i.BATHROOM]:"浴室",[i.KITCHEN]:"厨房",[i.BALCONY]:"阳台",[i.GARDEN]:"花园",[i.GARAGE]:"车库",[i.CORRIDOR]:"走廊"},d={[i.LIVING_ROOM]:"客廳",[i.DINING_ROOM]:"飯廳",[i.STORAGE_ROOM]:"雜物房",[i.STUDY_ROOM]:"書房",[i.BEDROOM]:"睡房",[i.BATHROOM]:"浴室",[i.KITCHEN]:"廚房",[i.BALCONY]:"陽台",[i.GARDEN]:"花園",[i.GARAGE]:"車庫",[i.CORRIDOR]:"走廊"},c={[i.LIVING_ROOM]:"#F0DF9C",[i.DINING_ROOM]:"#F5D4BC",[i.STORAGE_ROOM]:"#ADC0BC",[i.STUDY_ROOM]:"#B0B8C9",[i.BEDROOM]:"#F5B8B8",[i.BATHROOM]:"#C1D7E2",[i.KITCHEN]:"#EDE0C6",[i.BALCONY]:"#D0DCAA",[i.GARDEN]:"#AACDBC",[i.GARAGE]:"#C7C7DD",[i.CORRIDOR]:"#CDCDCD"}},86693:(e,t,a)=>{"use strict";a.d(t,{Xi:()=>d,av:()=>c,j7:()=>l,tU:()=>o});var s=a(73243);a(45323);var i=a(69282),n=a(82247),r=a(4318);function o(e){let{className:t,...a}=e;return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(i.bL,{"data-slot":"tabs",className:(0,r.cn)("flex flex-col gap-2",t),...a}),a.setShowTab&&(0,s.jsx)(n.A,{className:"w-4 h-4 absolute top-2.5 right-5",onClick:()=>a.setShowTab(!1)})]})}function l(e){let{className:t,...a}=e;return(0,s.jsx)(i.B8,{"data-slot":"tabs-list",className:(0,r.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)(i.l9,{"data-slot":"tabs-trigger",className:(0,r.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...a})}function c(e){let{className:t,...a}=e;return(0,s.jsx)(i.UC,{"data-slot":"tabs-content",className:(0,r.cn)("flex-1 outline-none",t),...a})}},87134:(e,t,a)=>{"use strict";let s;a.r(t),a.d(t,{default:()=>eI});var i=a(73243),n=a(46249),r=a(45323),o=a(17416),l=a(4318),d=a(43601);function c(e){let{...t}=e;return(0,i.jsx)(o.bL,{"data-slot":"alert-dialog",...t})}function h(e){let{...t}=e;return(0,i.jsx)(o.l9,{"data-slot":"alert-dialog-trigger",...t})}function u(e){let{...t}=e;return(0,i.jsx)(o.ZL,{"data-slot":"alert-dialog-portal",...t})}function p(e){let{className:t,...a}=e;return(0,i.jsx)(o.hJ,{"data-slot":"alert-dialog-overlay",className:(0,l.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function x(e){let{className:t,...a}=e;return(0,i.jsxs)(u,{children:[(0,i.jsx)(p,{}),(0,i.jsx)(o.UC,{"data-slot":"alert-dialog-content",className:(0,l.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...a})]})}function g(e){let{className:t,...a}=e;return(0,i.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,l.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function m(e){let{className:t,...a}=e;return(0,i.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,l.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function b(e){let{className:t,...a}=e;return(0,i.jsx)(o.hE,{"data-slot":"alert-dialog-title",className:(0,l.cn)("text-lg font-semibold",t),...a})}function f(e){let{className:t,...a}=e;return(0,i.jsx)(o.VY,{"data-slot":"alert-dialog-description",className:(0,l.cn)("text-muted-foreground text-sm",t),...a})}function v(e){let{className:t,...a}=e;return(0,i.jsx)(o.rc,{className:(0,l.cn)((0,d.r)(),t,"text-white"),...a})}function y(e){let{className:t,...a}=e;return(0,i.jsx)(o.ZD,{className:(0,l.cn)((0,d.r)({variant:"outline"}),t),...a})}var w=a(14041),j=a(49126),N=a(92378),R=a.n(N),O=a(52751),I=a(4449),E=a(81238),T=a(23224),A=a(58204),C=a(76420),S=a(62326);function z(e){let{history:t,historyIndex:a,handleUndo:s,handleRedo:n,className:r}=e;return(0,i.jsxs)("div",{className:(0,l.cn)("flex items-center gap-2",r),children:[(0,i.jsx)("button",{className:"p-1 rounded hover:bg-gray-100 ".concat(a<=0?"text-gray-300":"text-gray-600"),onClick:s,disabled:a<=0,children:(0,i.jsx)(C.A,{className:"w-4 h-4"})}),(0,i.jsx)("button",{className:"p-1 rounded hover:bg-gray-100 ".concat(a>=t.length-1?"text-gray-300":"text-gray-600"),onClick:n,disabled:a>=t.length-1,children:(0,i.jsx)(S.A,{className:"w-4 h-4"})})]})}var D=a(40217),U=a(75919),M=a(71400);let F=(0,r.forwardRef)((e,t)=>{let{items:a,onShowTab:o,showTab:d,history:u,historyIndex:p,setHistory:f,setHistoryIndex:w,handleUndo:N,handleRedo:C,onGenReport:S,locale:F}=e,k="zh-TW"===F?j.Gx:j.Qc,$=(0,D.c3)("design"),B=(0,U.A)(),[L,_]=(0,r.useState)({x:0,y:0}),[G,H]=(0,r.useState)(!1),[Y,W]=(0,r.useState)({x:0,y:0}),[P,X]=(0,r.useState)(null),[V,K]=(0,r.useState)({width:2e3,height:2e3}),[q,Q]=(0,r.useState)(!1),[J,Z]=(0,r.useState)({x:0,y:0}),[ee,et]=(0,r.useState)(null),[ea,es]=(0,r.useState)([]),[ei,en]=(0,r.useState)(!1),[er,eo]=(0,r.useState)({x:0,y:0}),[el,ed]=(0,r.useState)(null),[ec,eh]=(0,r.useState)(100),[eu,ep]=(0,r.useState)({originScale:100,isMoving:!1,pageX:0,pageY:0,pageX2:0,pageY2:0,initialDistance:0}),[ex,eg]=(0,r.useState)(0);(0,r.useImperativeHandle)(t,()=>({getLocalItems:()=>ea,setLocalItems:es,setActiveRoom:X,setIsRoomDragging:Q,setDraggedRoom:et,setRoomDragStart:Z,setPosition:_,setCompassRotation:eg,getPosition:()=>L,getCompassRotation:()=>ex,getScale:()=>ec,setScale:eh}),[ea,L,ex,ec]);let em=(0,r.useRef)(null),{setNodeRef:eb}=(0,n.zM)({id:"canvas",data:{accepts:[j.w$.ROOM,j.w$.FURNITURE]}});(0,r.useEffect)(()=>{var e;s=null===(e=document.getElementById("canvas-drop-area"))||void 0===e?void 0:e.getBoundingClientRect()},[]);let ef=(e,t,a,s)=>Math.sqrt(Math.pow(a-e,2)+Math.pow(s-t,2)),ev=(0,r.useCallback)(e=>{var t,a;if(!e.target.closest('[data-room-element="true"]')&&"canvas"===e.target.id&&(0===e.button||e.touches)){if((null===(t=e.touches)||void 0===t?void 0:t.length)===2){let t=e.touches[0],a=e.touches[1],s=ef(t.pageX,t.pageY,a.pageX,a.pageY);ep(e=>({...e,isMoving:!0,pageX:t.pageX,pageY:t.pageY,pageX2:a.pageX,pageY2:a.pageY,initialDistance:s,originScale:ec}));return}X(null),H(!0),(null===(a=e.touches)||void 0===a?void 0:a.length)===1?W({x:e.touches[0].clientX-L.x,y:e.touches[0].clientY-L.y}):W({x:e.clientX-L.x,y:e.clientY-L.y})}},[L,ec]),ey=(e,t)=>{if(!e.position||!t.position)return!1;let a=20;return console.log("家具在里面",e.rotation),(-90===e.rotation||-270===e.rotation)&&(console.log("ss",e.size.width,e.size.height),a=Math.abs(e.size.width-e.size.height)/2+a),e.position.x+a>=t.position.x&&e.position.x<=t.position.x+t.size.width&&e.position.x-a+e.size.width<=t.position.x+t.size.width&&e.position.y+a>=t.position.y&&e.position.y<=t.position.y+t.size.height&&e.position.y-a+e.size.height<=t.position.y+t.size.height},ew=(0,r.useCallback)((e,t)=>{var a;if(e.stopPropagation(),Q(!0),et(t),(null===(a=e.touches)||void 0===a?void 0:a.length)==1?Z({x:e.touches[0].clientX-t.position.x,y:e.touches[0].clientY-t.position.y}):Z({x:e.clientX-t.position.x,y:e.clientY-t.position.y}),t.type===j.w$.ROOM){let e=ea.map(e=>e.type===j.w$.FURNITURE&&ey(e,t)?{...e,parentId:t.id,offset:{x:e.position.x-t.position.x,y:e.position.y-t.position.y}}:{...e,parentId:null});es(ea.map(t=>e.find(e=>e.id===t.id)||t))}},[ea]),ej=(0,r.useCallback)((e,t,a)=>{var s;e.stopPropagation(),en(!0),ed(a),(null===(s=e.touches)||void 0===s?void 0:s.length)==1?eo({x:e.touches[0].clientX,y:e.touches[0].clientY}):eo({x:e.clientX,y:e.clientY})},[]);R().throttle(M.oR.info,3e3);let eN=e=>{var t,a,i,n,r;if(e.preventDefault(),(null===(t=e.touches)||void 0===t?void 0:t.length)===2){let t=e.touches[0],a=e.touches[1],s=ef(t.pageX,t.pageY,a.pageX,a.pageY);eu.initialDistance?s>eu.initialDistance?eI("in",1):eI("out",1):ep(e=>({...e,initialDistance:s,originScale:ec}))}else if(ei&&P&&el){let t,s;(null===(a=e.touches)||void 0===a?void 0:a.length)==1?(t=e.touches[0].clientX-er.x,s=e.touches[0].clientY-er.y):(t=e.clientX-er.x,s=e.clientY-er.y);let n=P.size.width/P.size.height;es(ea.map(e=>{if(e.id===P.id){let a;let i={...e.size},r={...e.position};switch(el){case"top-left":i.width=e.size.width-t,P.type===j.w$.ROOM?i.height=e.size.height-s:i.height=i.width/n,r.x=e.position.x+t,r.y=e.position.y+s;break;case"top-right":i.width=e.size.width+t,P.type===j.w$.ROOM?i.height=e.size.height-s:i.height=i.width/n,r.y=e.position.y+s;break;case"bottom-left":i.width=e.size.width-t,P.type===j.w$.ROOM?i.height=e.size.height+s:i.height=i.width/n,r.x=e.position.x+t;break;case"bottom-right":i.width=e.size.width+t,P.type===j.w$.ROOM?i.height=e.size.height+s:i.height=i.width/n}if(e.type===j.w$.ROOM?i.width>=100&&i.height>=100:e.data.type===j.x9.WINDOW?i.width>=8&&i.height>=8:i.width>=20&&i.height>=20)return{...e,size:i,position:r}}return e})),(null===(i=e.touches)||void 0===i?void 0:i.length)==1?eo({x:e.touches[0].clientX,y:e.touches[0].clientY}):eo({x:e.clientX,y:e.clientY})}else if(q&&ee){let t,a;(null===(n=e.touches)||void 0===n?void 0:n.length)==1?(t=e.touches[0].clientX-J.x,a=e.touches[0].clientY-J.y):(t=e.clientX-J.x,a=e.clientY-J.y),t=Math.max(0,t),a=Math.max(0,a);let s=[];if(ee.type===j.w$.ROOM){let e=ea.filter(e=>e.type===j.w$.FURNITURE&&e.parentId===ee.id).map(e=>e.id);s=ea.map(s=>{if(s.id===ee.id)return{...s,position:{x:t,y:a}};if(e.includes(s.id)){var i,n;return{...s,position:{x:t+(null===(i=s.offset)||void 0===i?void 0:i.x)||0,y:a+(null===(n=s.offset)||void 0===n?void 0:n.y)||0}}}return s})}else s=ea.map(e=>e.id===ee.id?{...e,position:{x:t,y:a}}:e);es(s)}else if(G){let t,a,i,n;(null===(r=e.touches)||void 0===r?void 0:r.length)===1?(t=e.touches[0].clientX-Y.x,a=e.touches[0].clientY-Y.y):(t=e.clientX-Y.x,a=e.clientY-Y.y),t>0&&(t=0),a>0&&(a=0),t<-1e3&&(t=-1e3),a<-1e3&&(a=-1e3),2e3+t<s.width/(ec/100)&&(i=(2e3-t)/(ec/100)),2e3+a<s.height/(ec/100)&&(n=(2e3-a)/(ec/100)),_({x:t,y:a}),K({width:i||V.width,height:n||V.height})}},eR=(0,r.useCallback)(e=>{var t,a;if((null===(t=e.touches)||void 0===t?void 0:t.length)<2&&ep(e=>({...e,isMoving:!1,initialDistance:0})),q||ei){let t,s,i;if((null===(a=e.changedTouches)||void 0===a?void 0:a.length)==1?(t=e.changedTouches[0].clientX-J.x-L.x,s=e.changedTouches[0].clientY-J.y-L.y):(t=e.clientX-J.x-L.x,s=e.clientY-J.y-L.y),ee&&!ea.some(e=>e.id===ee.id)){let e={...ee,position:{x:t/(ec/100),y:s/(ec/100)},data:{...ee.data,label:"".concat(ee.data.label)}};es(i=[...ea,e]),eO(e,i)}else i=ea;let n=u.slice(0,p+1);n.push(i),f(n),w(n.length-1)}H(!1),Q(!1),et(null),en(!1),ed(null)},[q,ei,ea,u,p,J,ee,L,eu]),eO=(e,t)=>{if(e.type===j.w$.FURNITURE){let a=t||ea,s=a.find(t=>t.type===j.w$.ROOM&&ey(e,t));if(s){let t=a.filter(t=>t.type===j.w$.FURNITURE&&t.data.type===e.data.type&&ey(t,s)).sort((e,t)=>e.position.x-t.position.x).map((t,a)=>{let i="".concat(s.data.label,"-").concat(k[e.data.type]).concat(a+1);return t.id===e.id&&(e.data.label=i,e.data.parentRoom=s),{...t,data:{...t.data,label:i,parentRoom:s}}});es(a.map(e=>t.find(t=>t.id===e.id)||e))}else{console.log("选中家具，当前未匹配到房间");let t=R().cloneDeep(a),s=t.filter(t=>t.id===e.id)[0];s&&(s.data.label="未分配-".concat(k[s.data.type]),s.data.parentRoom=null,e.data.label="未分配-".concat(k[s.data.type]),e.data.parentRoom=null,es(t))}}setTimeout(()=>{X(e)})};function eI(e){let t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("in"===e&&ec<120)t=ec+a;else if("out"===e&&ec>50)t=ec-a;else{if("reset"!==e)return;t=100}"out"===e&&K({width:(V.width-(L.x<0?L.x:0))*(1+(ec-t)/100),height:(V.height-(L.y<0?L.y:0))*(1+(ec-t)/100)}),eh(t)}(0,r.useEffect)(()=>{let e=em.current;if(e)return e.addEventListener("mousedown",ev),window.addEventListener("mousemove",eN),window.addEventListener("mouseup",eR),e.addEventListener("touchstart",ev),window.addEventListener("touchmove",eN,{passive:!1}),window.addEventListener("touchend",eR),()=>{e.removeEventListener("mousedown",ev),window.removeEventListener("mousemove",eN),window.removeEventListener("mouseup",eR),e.removeEventListener("touchstart",ev),window.removeEventListener("touchmove",eN),window.removeEventListener("touchend",eR)}},[ev,eN,eR]);let eE=(0,r.useCallback)(()=>{P&&es(ea.map(e=>{if(e.id===P.id){let t=((e.rotation||0)-45)%360;return{...e,rotation:t}}return e}))},[P,ea]),eT=e=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"absolute w-3 h-3 bg-white border border-red-500 cursor-nw-resize rounded-full",style:{top:-6,left:-6},onMouseDown:t=>ej(t,e,"top-left"),onTouchStart:t=>ej(t,e,"top-left")}),(0,i.jsx)("div",{className:"absolute w-3 h-3 bg-white border border-red-500 cursor-ne-resize rounded-full",style:{top:-6,right:-6},onMouseDown:t=>ej(t,e,"top-right"),onTouchStart:t=>ej(t,e,"top-right")}),(0,i.jsx)("div",{className:"absolute w-3 h-3 bg-white border border-red-500 cursor-sw-resize rounded-full",style:{bottom:-6,left:-6},onMouseDown:t=>ej(t,e,"bottom-left"),onTouchStart:t=>ej(t,e,"bottom-left")}),(0,i.jsx)("div",{className:"absolute w-3 h-3 bg-white border border-red-500 cursor-se-resize rounded-full",style:{bottom:-6,right:-6},onMouseDown:t=>ej(t,e,"bottom-right"),onTouchStart:t=>ej(t,e,"bottom-right")})]});return(0,i.jsxs)("div",{ref:e=>{em.current=e,eb(e)},className:"relative w-full min-h-[calc(100vh-64px)] overflow-hidden bg-background",children:[(0,i.jsxs)("div",{className:"fixed top-20 right-6 flex items-center gap-4 z-9",children:[!B&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(z,{history:u,historyIndex:p,handleUndo:N,handleRedo:C,className:" bg-white rounded-full shadow-lg  px-3 py-2"})}),(0,i.jsxs)("div",{className:"flex items-center gap-2 bg-white rounded-full shadow-lg px-3 py-2",children:[(0,i.jsx)("button",{className:"p-1 rounded hover:bg-gray-100 text-gray-600",onClick:e=>eI("out"),disabled:ec<=50,children:(0,i.jsx)(O.A,{className:"w-4 h-4"})}),(0,i.jsxs)("span",{className:"text-sm font-medium text-gray-600 min-w-[48px] text-center",children:[ec,"%"]}),(0,i.jsx)("button",{className:"p-1 rounded hover:bg-gray-100 text-gray-600",onClick:e=>eI("in"),disabled:ec>=120,children:(0,i.jsx)(I.A,{className:"w-4 h-4"})})]}),(0,i.jsxs)("div",{style:{transform:"rotate(".concat(ex,"deg)"),transition:"transform 0.3s ease-out"},onClick:()=>{eg(ex+45)},className:"flex flex-col items-center",children:[(0,i.jsx)("div",{className:"text-sm text-gray-600",children:"N"}),(0,i.jsx)(A.default,{src:"/images/compass.png",alt:"方向",width:40,height:40,className:"cursor-pointer"})]})]}),(0,i.jsx)("div",{id:"canvas",className:"absolute cursor-move",style:{width:"".concat(V.width,"px"),height:"".concat(V.height,"px"),transform:"translate(".concat(L.x,"px, ").concat(L.y,"px)  scale(").concat(ec/100,")"),transformOrigin:"top left",backgroundImage:"radial-gradient(circle, #ddd 1px, transparent 1px)",backgroundSize:"10px 10px"},children:(0,i.jsx)("div",{className:"relative",children:ea.map(e=>e.type===j.w$.ROOM?(0,i.jsxs)("div",{"data-room-element":"true",className:"absolute ".concat((null==P?void 0:P.id)===e.id?"ring-2 ring-red-500":""," cursor-move z-100"),style:{left:e.position.x,top:e.position.y,width:e.size.width,height:e.size.height},onClick:t=>{t.stopPropagation(),eO(e)},onMouseDown:t=>ew(t,e),onTouchStart:t=>ew(t,e),children:[P&&P.id===e.id&&(0,i.jsxs)("div",{style:{left:"50%",top:"-64px",transform:"translateX(-50%)"},className:"min-w-fit whitespace-nowrap  absolute z-1 h-[40px] rounded-4xl bg-white shadow-lg  items-center px-3 gap-2 md:flex hidden",children:[(0,i.jsxs)("span",{className:"text-sm text-gray-600",children:[$("chosed"),"："]}),(0,i.jsxs)("div",{className:"flex flex-grow items-center gap-1",children:[(0,i.jsx)("div",{style:{width:"12px",height:"12px",backgroundColor:j.$q[P.data.type],borderRadius:"2px"}}),(0,i.jsx)("span",{className:"text-sm text-gray-600 font-bold",children:P.data.label})]}),(0,i.jsx)("button",{className:"flex-shrink-0 text-red-500",onClick:e=>{e.stopPropagation(),es(ea.filter(e=>e.id!==P.id)),X(null)},children:(0,i.jsx)(E.A,{className:"w-4 h-4 text-red-500"})})]}),(0,i.jsx)("div",{className:"w-full h-full",style:{border:e.type===j.w$.ROOM?"8px solid":"none",borderColor:e.type===j.w$.ROOM?j.$q[e.data.type]:"transparent",borderRadius:e.type===j.w$.ROOM?"8px":"0",backgroundColor:e.type===j.w$.ROOM?j.$q[e.data.type]+"80":"transparent"},children:(0,i.jsx)("div",{className:"absolute top-2 left-2 text-[14px] text-[#888888]",style:{zIndex:1},children:e.data.label})}),(null==P?void 0:P.id)===e.id&&eT(e)]},e.id):e.type===j.w$.FURNITURE?(0,i.jsxs)("div",{"data-room-element":"true",className:"absolute cursor-move z-200",style:{left:e.position.x,top:e.position.y,width:e.size.width,height:e.size.height},onClick:t=>{t.stopPropagation(),eO(e)},onMouseDown:t=>{t.stopPropagation(),ew(t,e)},onTouchStart:t=>{t.stopPropagation(),ew(t,e)},children:[P&&P.id===e.id&&(0,i.jsxs)("div",{style:{left:"50%",top:"-64px",transform:"translateX(-50%)"},className:"min-w-fit whitespace-nowrap absolute z-1 h-[40px] rounded-4xl bg-white shadow-lg  items-center px-3 gap-2 md:flex hidden",children:[(0,i.jsxs)("span",{className:"text-sm text-gray-600",children:[$("chosed"),"："]}),(0,i.jsxs)("div",{className:"flex flex-grow items-center gap-1",children:[P.data.parentRoom&&(0,i.jsx)("div",{style:{width:"12px",height:"12px",backgroundColor:j.$q[P.data.parentRoom.data.type],borderRadius:"2px"}}),(0,i.jsx)("span",{className:"text-sm text-gray-600 font-bold",children:P.data.label})]}),(0,i.jsx)("button",{className:"flex-shrink-0",onClick:e=>{e.stopPropagation(),eE()},children:(0,i.jsx)(T.A,{className:"w-4 h-4"})}),(0,i.jsx)("button",{className:"flex-shrink-0 text-red-500 hover:text-red-600 transition-colors",onClick:e=>{e.stopPropagation(),es(ea.filter(e=>e.id!==P.id)),X(null)},children:(0,i.jsx)(E.A,{className:"w-4 h-4 text-red-500"})})]}),(null==P?void 0:P.id)===e.id&&eT(e),(0,i.jsx)(A.default,{draggable:"false",className:(null==P?void 0:P.id)===e.id?"ring-2 ring-red-500":"",style:{transform:e.rotation?"rotate(".concat(e.rotation,"deg)"):"none",transformOrigin:"center"},src:e.activeIcon,alt:"Furniture",width:e.size.width,height:e.size.height})]},e.id):void 0)})}),P&&(0,i.jsxs)("div",{className:(0,l.cn)("min-w-fit whitespace-nowrap fixed  left-1/2 -translate-x-1/2 h-10 rounded-4xl bg-white shadow-lg flex items-center px-3 gap-2 md:hidden",d?"bottom-85":"bottom-22.5 "),children:[(0,i.jsxs)("span",{className:"text-sm text-gray-600",children:[$("chosed"),"："]}),(0,i.jsxs)("div",{className:"flex flex-grow items-center gap-1",children:[(0,i.jsx)("div",{style:{width:"12px",height:"12px",backgroundColor:j.$q[P.data.parentRoom?P.data.parentRoom.data.type:P.data.type],borderRadius:"2px"}}),(0,i.jsx)("span",{className:"text-sm text-gray-600 font-bold",children:P.data.label})]}),P.type===j.w$.FURNITURE&&(0,i.jsxs)("button",{className:"flex-shrink-0",onClick:e=>{e.stopPropagation(),eE()},children:[" ",(0,i.jsx)(T.A,{className:"w-4 h-4"})]}),(0,i.jsx)("button",{className:"flex-shrink-0 text-red-500 hover:text-red-600 transition-colors",onClick:e=>{e.stopPropagation(),es(ea.filter(e=>e.id!==P.id)),X(null)},children:(0,i.jsx)(E.A,{className:"w-4 h-4 text-red-500"})})]}),(0,i.jsxs)("div",{className:"fixed z-50 bottom-6 left-0 px-2 gap-4 w-full bg-transparent flex items-center justify-between  md:hidden",children:[!d&&(0,i.jsx)("button",{onClick:o,className:"border-primary border-1 font-bold w-4/5 py-3 bg-white text-foreground rounded-[100px] text-sm",children:$("showTab")}),(0,i.jsxs)(c,{children:[(0,i.jsxs)(h,{className:(0,l.cn)("inline-flex font-bold py-3 bg-button-gradient text-white rounded-[100px] text-sm items-center justify-center gap-0",d?"w-full ":"w-4/5"),children:[$("cta"),(0,i.jsx)(A.default,{src:"/images/hero/star.png",alt:"arrow",width:15,height:16})]}),(0,i.jsxs)(x,{children:[(0,i.jsx)(g,{children:(0,i.jsx)(b,{children:$("alert")})}),(0,i.jsxs)(m,{children:[(0,i.jsx)(y,{children:$("cancel")}),(0,i.jsx)(v,{onClick:S,children:$("ok")})]})]})]})]})]})});var k=a(67703),$=a(32249),B=a(58052),L=a(59536),_=a(93881);function G(e){let{onSaveProject:t,onGenReport:a,onUserOpen:s}=e,{isMobile:n}=(0,U.A)(),r=(0,D.c3)("design");return(0,i.jsx)("nav",{className:"bg-white h-16 border-b-gray-100 border-b-2 fixed top-0 left-0 right-0 z-10",children:(0,i.jsx)("div",{className:"mx-auto px-4 h-full",children:(0,i.jsxs)("div",{className:"flex items-center justify-between h-full",children:[(0,i.jsx)(k.N_,{href:"/",className:"text-2xl font-bold text-primary",children:"HarmoniQ"}),(0,i.jsxs)("div",{className:"flex items-center space-x-4 text-foreground  gap-3",children:[(0,i.jsx)($.A,{className:"text-foreground"}),(0,i.jsxs)("span",{className:"flex items-center gap-1 cursor-pointer",onClick:t,children:[(0,i.jsx)(B.A,{className:"w-4 h-4"}),"保存 "]}),(0,i.jsxs)("span",{className:"flex items-center gap-1 cursor-pointer",onClick:()=>s(!0),children:[(0,i.jsx)(L.A,{className:"w-4 h-4"}),r("profile")," "]}),(0,i.jsxs)(c,{children:[(0,i.jsxs)(h,{className:"inline-flex px-4 py-1 bg-button-gradient text-white rounded-full hover:bg-primary/90 transition-colors items-center gap-2",children:[r("cta"),(0,i.jsx)("span",{className:"text-lg",children:"✨"})]}),(0,i.jsxs)(x,{children:[(0,i.jsx)(g,{children:(0,i.jsx)(b,{children:r("alert")})}),(0,i.jsxs)(m,{children:[(0,i.jsx)(y,{children:r("cancel")}),(0,i.jsx)(v,{onClick:a,children:r("ok")})]})]})]}),(0,i.jsx)(_.A,{})]})]})})})}var H=a(70643),Y=a(97311);function W(e){let{onSaveProject:t,history:a,historyIndex:s,handleUndo:n,handleRedo:o,onUserOpen:l}=e,[d,c]=(0,r.useState)(!1),h=(0,D.c3)("design");return(0,i.jsxs)("div",{className:"fixed top-0 left-0 right-0 z-50",children:[(0,i.jsx)("nav",{className:"bg-white h-16 border-b-gray-100 border-b-2 ",children:(0,i.jsx)("div",{className:"mx-auto px-4 h-full",children:(0,i.jsxs)("div",{className:"flex items-center justify-between h-full",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4 text-foreground  gap-3",children:[(0,i.jsx)(z,{history:a,historyIndex:s,handleUndo:n,handleRedo:o}),(0,i.jsxs)("span",{className:"flex items-center gap-1 cursor-pointer",onClick:t,children:[(0,i.jsx)(B.A,{className:"w-4 h-4"})," "]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-4 text-foreground  gap-3",children:[(0,i.jsx)("span",{className:"flex items-center gap-1 cursor-pointer",children:(0,i.jsx)(H.A,{className:"w-4 h-4",onClick:()=>c(!0)})}),(0,i.jsxs)("span",{className:"flex items-center gap-1 cursor-pointer",children:[(0,i.jsx)(L.A,{className:"w-4 h-4",onClick:()=>l(!0)})," "]}),(0,i.jsx)(_.A,{})]})]})})}),d&&(0,i.jsxs)("div",{className:"h-8 w-full bg-[#E5F4FF] px-6 py-3 flex justify-between items-center",children:[(0,i.jsxs)("span",{className:"text-[12px] text-foreground flex items-center gap-1",children:[(0,i.jsx)(H.A,{className:"w-4 h-4 text-[#888]"}),h("warning")]}),(0,i.jsx)(Y.A,{className:"w-4 h-4 text-[#888]",onClick:()=>c(!1)})]})]})}function P(e){let{id:t,type:a,data:s,children:r,isOverCanvas:o}=e,{attributes:l,listeners:d,setNodeRef:c,transform:h,isDragging:u}=(0,n.PM)({id:t,data:{type:a,...s}}),p=h?{transform:"translate3d(".concat(h.x,"px, ").concat(h.y,"px, 0)"),opacity:u&&!o?.5:u&&o?0:1,position:"relative",zIndex:u?1e3:1,visibility:"visible"}:{};return(0,i.jsxs)("div",{className:"relative z-0 w-22.5",children:[(0,i.jsx)("div",{className:"absolute  -z-1 w-22.5 top-0 left-0",children:r}),(0,i.jsx)("div",{ref:c,...d,...l,className:"cursor-move",style:{...p},children:r})]})}a(80420);var X=a(19924);function V(e){let{sidebarRef:t,roomItems:a,furnitureItems:s,isOverCanvas:n,draggingItemSize:r}=e,o=(0,D.c3)("design");return(0,i.jsx)(X.F,{className:"h-[calc(100vh-64px)] w-1/6",children:(0,i.jsxs)("div",{ref:t,className:"md:block hidden  bg-white p-4 shadow border-r-gray-100 border-r-2",children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("h3",{className:"text-2xl font-semibold mb-4",children:o("room")}),(0,i.jsx)("div",{className:"grid 2xl:grid-cols-3 xl:grid-cols-2 gap-2",children:a.map(e=>(0,i.jsx)(P,{id:e.id,type:e.type,data:e.data,isOverCanvas:n,children:(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("div",{className:"w-14 h-14 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200 transition-colors",children:(0,i.jsx)(A.default,{className:" bg-[#EFF7F4] rounded-lg",src:e.data.icon,alt:e.data.label,width:r,height:r,priority:!0})}),(0,i.jsx)("span",{className:"mt-1 text-sm text-gray-600",children:e.data.label})]})},e.id))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-2xl font-semibold mb-4",children:o("furniture")}),(0,i.jsx)("div",{className:"grid 2xl:grid-cols-3 xl:grid-cols-2 gap-2",children:s.map(e=>(0,i.jsx)(P,{id:e.id,type:e.type,data:e.data,isOverCanvas:n,children:(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("div",{className:"w-14 h-14 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200 transition-colors",children:(0,i.jsx)(A.default,{className:"bg-[#EFF7F4] rounded-lg",src:e.data.icon,alt:e.data.label,width:r,height:r,priority:!0})}),(0,i.jsx)("span",{className:"mt-1 text-sm text-gray-600",children:e.data.label})]})},e.id))})]})]})})}var K=a(86693),q=a(43263);function Q(e){let{showTab:t,setShowTab:a,roomItems:s,furnitureItems:n,isOverCanvas:o,draggingItemSize:d}=e,[c,h]=(0,r.useState)(""),u=(0,D.c3)("design");return(0,r.useEffect)(()=>{h("room")},[]),(0,i.jsx)("div",{style:{boxShadow:"0 -1px 5px 0px rgba(0, 0, 0, 0.2)"},className:(0,l.cn)("fixed bottom-0 left-0 z-10 w-full pb-20 pl-0 pr-2 bg-white md:hidden rounded-t-2xl transition-transform duration-300 ease-in-out",t?"translate-y-0":"translate-y-full"),children:(0,i.jsxs)(K.tU,{value:c,className:"w-full gap-4",setShowTab:a,onValueChange:e=>h(e),children:[(0,i.jsxs)(K.j7,{className:"mx-auto bg-white gap-8",children:[(0,i.jsx)(K.Xi,{defaultValue:!0,value:"room",className:"rounded-[3px] text-[12px] font-bold data-[state=active]:shadow-none data-[state=active]:border-b-4 data-[state=active]:border-b-primary",children:u("room")}),(0,i.jsx)(K.Xi,{value:"furniture",className:"rounded-[3px] text-[12px] font-bold data-[state=active]:shadow-none data-[state=active]:border-b-4 data-[state=active]:border-b-primary",children:u("furniture")})]}),(0,i.jsx)(K.av,{value:"room",className:"w-full pb-3 overflow-hidden",children:(0,i.jsxs)(q.FN,{children:[(0,i.jsxs)(q.Wk,{children:[(0,i.jsx)(q.A7,{children:(0,i.jsx)("div",{className:"grid grid-cols-4 gap-x-8 gap-y-6",children:s.slice(0,8).map(e=>(0,i.jsx)(P,{id:e.id,type:e.type,data:e.data,isOverCanvas:o,children:(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("div",{className:"w-14 h-14 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200 transition-colors",children:(0,i.jsx)(A.default,{className:"bg-[#EFF7F4] rounded-lg",src:e.data.icon,alt:e.data.label,width:d,height:d,priority:!0})}),(0,i.jsx)("span",{className:"mt-1 text-[12px] text-gray-600",children:e.data.label})]})},e.id))})}),(0,i.jsx)(q.A7,{children:(0,i.jsx)("div",{className:"grid grid-cols-4 gap-x-8 gap-y-6",children:s.slice(8).map(e=>(0,i.jsx)(P,{id:e.id,type:e.type,data:e.data,isOverCanvas:o,children:(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("div",{className:"w-14 h-14 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200 transition-colors",children:(0,i.jsx)(A.default,{className:"bg-[#EFF7F4] rounded-lg",src:e.data.icon,alt:e.data.label,width:d,height:d,priority:!0})}),(0,i.jsx)("span",{className:"mt-1 text-[12px] text-gray-600",children:e.data.label})]})},e.id))})})]}),(0,i.jsx)(q.Q8,{className:"left-0 "}),(0,i.jsx)(q.Oj,{className:"right-0"})]})}),(0,i.jsx)(K.av,{value:"furniture",className:"w-full pb-3 overflow-hidden",children:(0,i.jsxs)(q.FN,{children:[(0,i.jsxs)(q.Wk,{children:[(0,i.jsx)(q.A7,{children:(0,i.jsx)("div",{className:"grid grid-cols-4 gap-x-8 gap-y-6",children:n.slice(0,8).map(e=>(0,i.jsx)(P,{id:e.id,type:e.type,data:e.data,isOverCanvas:o,children:(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("div",{className:"w-14 h-14 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200 transition-colors",children:(0,i.jsx)(A.default,{className:"bg-[#EFF7F4] rounded-lg",src:e.data.icon,alt:e.data.label,width:d,height:d})}),(0,i.jsx)("span",{className:"mt-1 text-[12px] text-gray-600",children:e.data.label})]})},e.id))})}),(0,i.jsx)(q.A7,{children:(0,i.jsx)("div",{className:"grid grid-cols-4 gap-x-8 gap-y-6",children:n.slice(8,16).map(e=>(0,i.jsx)(P,{id:e.id,type:e.type,data:e.data,isOverCanvas:o,children:(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("div",{className:"w-14 h-14 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200 transition-colors",children:(0,i.jsx)(A.default,{className:"bg-[#EFF7F4] rounded-lg",src:e.data.icon,alt:e.data.label,width:d,height:d})}),(0,i.jsx)("span",{className:"mt-1 text-[12px] text-gray-600",children:e.data.label})]})},e.id))})}),(0,i.jsx)(q.A7,{children:(0,i.jsx)("div",{className:"grid grid-cols-4 gap-x-8 gap-y-6",children:n.slice(16).map(e=>(0,i.jsx)(P,{id:e.id,type:e.type,data:e.data,isOverCanvas:o,children:(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("div",{className:"w-14 h-14 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200 transition-colors",children:(0,i.jsx)(A.default,{className:"bg-[#EFF7F4] rounded-lg",src:e.data.icon,alt:e.data.label,width:d,height:d})}),(0,i.jsx)("span",{className:"mt-1 text-[12px] text-gray-600",children:e.data.label})]})},e.id))})})]}),(0,i.jsx)(q.Q8,{className:"left-0 "}),(0,i.jsx)(q.Oj,{className:"right-0"})]})})]})})}var J=a(92387);let Z=[{name:"north",range:[337.5,22.5],baseAngle:0},{name:"northEast",range:[22.5,67.5],baseAngle:45},{name:"east",range:[67.5,112.5],baseAngle:90},{name:"southEast",range:[112.5,157.5],baseAngle:135},{name:"south",range:[157.5,202.5],baseAngle:180},{name:"southWest",range:[202.5,247.5],baseAngle:225},{name:"west",range:[247.5,292.5],baseAngle:270},{name:"northWest",range:[292.5,337.5],baseAngle:315}];var ee=a(73379),et=a(6900);function ea(e){let{...t}=e;return(0,i.jsx)(et.bL,{"data-slot":"dialog",...t})}function es(e){let{...t}=e;return(0,i.jsx)(et.ZL,{"data-slot":"dialog-portal",...t})}function ei(e){let{className:t,...a}=e;return(0,i.jsx)(et.hJ,{"data-slot":"dialog-overlay",className:(0,l.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function en(e){let{className:t,children:a,...s}=e;return(0,i.jsxs)(es,{"data-slot":"dialog-portal",children:[(0,i.jsx)(ei,{}),(0,i.jsxs)(et.UC,{"data-slot":"dialog-content",className:(0,l.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...s,children:[a,(0,i.jsxs)(et.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,i.jsx)(Y.A,{}),(0,i.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function er(e){let{className:t,...a}=e;return(0,i.jsx)("div",{"data-slot":"dialog-header",className:(0,l.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function eo(e){let{className:t,...a}=e;return(0,i.jsx)(et.hE,{"data-slot":"dialog-title",className:(0,l.cn)("text-lg leading-none font-semibold",t),...a})}var el=a(93286),ed=a(14013),ec=a(93386),eh=a(91293);function eu(e){let{className:t,...a}=e;return(0,i.jsx)(ec.bL,{"data-slot":"radio-group",className:(0,l.cn)("grid gap-3",t),...a})}function ep(e){let{className:t,...a}=e;return(0,i.jsx)(ec.q7,{"data-slot":"radio-group-item",className:(0,l.cn)("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,i.jsx)(ec.C1,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:(0,i.jsx)(eh.A,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}var ex=a(82945);function eg(e){let{className:t,...a}=e;return(0,i.jsx)(ex.b,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}var em=a(74307);let eb=Array.from({length:100},(e,t)=>(2025-t).toString()),ef=Array.from({length:12},(e,t)=>(t+1).toString().padStart(2,"0")),ev=Array.from({length:31},(e,t)=>(t+1).toString().padStart(2,"0")),ey=Array.from({length:24},(e,t)=>t.toString().padStart(2,"0")),ew={years:eb,months:ef,days:ev,hours:ey};function ej(e){let{tHour:t,onChange:a}=e,[s,n]=(0,r.useState)({years:"1996",months:"04",days:"15",hours:"12"});(0,r.useEffect)(()=>{e.value&&n({years:e.value[0],months:e.value[1],days:e.value[2],hours:e.value[3]})},[e.value]);let o=(e,a)=>{switch(a){case"years":return e+"年";case"months":return e+"月";case"days":return e+"日";case"hours":return e+t}};return(0,i.jsx)(em.A,{value:s,onChange:e=>{n(e),a&&a([e.years,e.months,e.days,e.hours])},children:Object.keys(ew).map(e=>(0,i.jsx)(em.A.Column,{name:e,children:ew[e].map(t=>(0,i.jsx)(em.A.Item,{value:t,children:o(t,e)},t))},e))})}function eN(e){let{open:t,onUserOpen:a,onSubmit:s,userInfo:n}=e,o=(0,D.c3)("design"),l=(0,U.A)(),[c,h]=(0,r.useState)("男"),[u,p]=(0,r.useState)("1996"),[x,g]=(0,r.useState)("03"),[m,b]=(0,r.useState)("12"),[f,v]=(0,r.useState)("22");(0,r.useEffect)(()=>{if(n&&(h(n.gender||"male"),n.birthDateTime)){let e=new Date(n.birthDateTime);p(e.getFullYear().toString()),g((e.getMonth()+1).toString().padStart(2,"0")),b(e.getDate().toString().padStart(2,"0")),v(e.getHours().toString().padStart(2,"0"))}},[n]);let y=()=>{s({gender:c,birthDateTime:new Date(parseInt(u),parseInt(x)-1,parseInt(m),parseInt(f))})},w=e=>{e&&(p(e[0]),g(e[1]),b(e[2]),v(e[3]))};return(0,i.jsx)(ea,{open:t,onOpenChange:a,children:(0,i.jsxs)(en,{className:"sm:max-w-[432px]",children:[(0,i.jsxs)(er,{children:[(0,i.jsxs)(eo,{className:"text-lg md:text-xl font-bold md:text-left text-center",children:[" ",o("profile")," "]}),(0,i.jsx)("div",{className:"py-4 text-sm md:text-base  text-left",children:o("tip")})]}),(0,i.jsx)(el.Separator,{className:"md:hidden"}),(0,i.jsxs)("div",{className:"grid gap-4 pb-4",children:[l?(0,i.jsx)(()=>(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)(eg,{className:"text-base",children:"性别"}),(0,i.jsxs)("div",{className:"flex bg-gray-200 p-1 rounded-[6px]  ",children:[(0,i.jsx)("button",{style:{boxShadow:"0 1px 5px 0px rgba(0, 0, 0, 0.3)"},className:"rounded-[6px] px-4 py-1 ".concat("male"===c?"bg-white":"transparent"),onClick:()=>h("male"),children:"男"}),(0,i.jsx)("button",{className:"rounded-[6px] px-4 py-1 ".concat("female"===c?"bg-white":"transparent"),onClick:()=>h("female"),children:"女"})]})]}),{}):(0,i.jsx)(()=>(0,i.jsxs)("div",{className:"space-y-2 pb-4",children:[(0,i.jsx)(eg,{className:"font-bold pb-2 text-base",children:"性别"}),(0,i.jsxs)(eu,{value:c,onValueChange:h,className:"flex space-x-4",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(ep,{value:"male",id:"male"}),(0,i.jsx)(eg,{htmlFor:"male",children:"男"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(ep,{value:"female",id:"female"}),(0,i.jsx)(eg,{htmlFor:"female",children:"女"})]})]})]}),{}),(0,i.jsx)(el.Separator,{className:"md:hidden"}),l?(0,i.jsx)(()=>(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between pb-4",children:[(0,i.jsx)(eg,{className:"text-base",children:"出生日期"}),(0,i.jsx)("span",{children:"".concat(u,"年").concat(x,"月").concat(m,"日").concat(f).concat(o("hour"))})]}),(0,i.jsx)(el.Separator,{}),(0,i.jsx)(ej,{tHour:o("hour"),onChange:w,value:[u,x,m,f]}),(0,i.jsx)(el.Separator,{})]}),{}):(0,i.jsx)(()=>(0,i.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(eg,{className:"font-bold pb-4 text-base",children:"年"}),(0,i.jsxs)(ed.l6,{value:u,onValueChange:p,children:[(0,i.jsx)(ed.bq,{className:"w-24",children:(0,i.jsx)(ed.yv,{placeholder:"年"})}),(0,i.jsx)(ed.gC,{children:eb.map(e=>(0,i.jsxs)(ed.eb,{value:e,children:[e,"年"]},e))})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(eg,{className:"font-bold pb-4 text-base",children:"月"}),(0,i.jsxs)(ed.l6,{value:x,onValueChange:g,children:[(0,i.jsx)(ed.bq,{className:"w-24",children:(0,i.jsx)(ed.yv,{placeholder:"月"})}),(0,i.jsx)(ed.gC,{children:ef.map(e=>(0,i.jsxs)(ed.eb,{value:e,children:[e,"月"]},e))})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(eg,{className:"font-bold pb-4 text-base",children:"日"}),(0,i.jsxs)(ed.l6,{value:m,onValueChange:b,children:[(0,i.jsx)(ed.bq,{className:"w-20",children:(0,i.jsx)(ed.yv,{placeholder:"日"})}),(0,i.jsx)(ed.gC,{children:ev.map(e=>(0,i.jsxs)(ed.eb,{value:e,children:[e,"日"]},e))})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(eg,{className:"font-bold pb-4 text-base",children:["小",o("hour")]}),(0,i.jsxs)(ed.l6,{value:f,onValueChange:v,children:[(0,i.jsx)(ed.bq,{className:"w-20",children:(0,i.jsx)(ed.yv,{placeholder:o("hour")})}),(0,i.jsx)(ed.gC,{children:ey.map(e=>(0,i.jsxs)(ed.eb,{value:e,children:[e,o("hour")]},e))})]})]})]}),{}),l?(0,i.jsxs)("div",{className:"flex justify-around",children:[(0,i.jsx)(d.$,{onClick:()=>{a(!1)},className:"px-10 border-1 border-[#ccc] text-foreground rounded-[100px] bg-white font-bold mt-10",children:"取消"}),(0,i.jsx)(d.$,{onClick:y,className:"px-10 bg-[#13ab87] font-bold mt-10 rounded-[100px]",children:"保存"})]}):(0,i.jsx)(d.$,{onClick:y,className:"w-full bg-[#13ab87] font-bold mt-10 rounded-[100px]",children:"保存"})]})]})})}var eR=a(8403);let eO={[j.sR.LIVING_ROOM]:"#F0DF9C",[j.sR.DINING_ROOM]:"#F5D4BC",[j.sR.STORAGE_ROOM]:"#ADC0BC",[j.sR.STUDY_ROOM]:"#B0B8C9",[j.sR.BEDROOM]:"#F5B8B8",[j.sR.BATHROOM]:"#C1D7E2",[j.sR.KITCHEN]:"#EDE0C6",[j.sR.BALCONY]:"#D0DCAA",[j.sR.GARDEN]:"#AACDBC",[j.sR.GARAGE]:"#C7C7DD",[j.sR.CORRIDOR]:"#CDCDCD"};function eI(e){var t,a;let{params:s}=e,o=(0,r.use)(s).locale,l=(0,D.c3)("design"),d=(0,D.c3)("toast"),h="zh-TW"===o?j.t7:j.Xs,u="zh-TW"===o?j.Gx:j.Qc,p=[{id:"door-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.DOOR,label:u[j.x9.DOOR],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/door.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/door-gr.png",size:{width:40,height:40}}},{id:"window-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.WINDOW,label:u[j.x9.WINDOW],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/window.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/window-gr.png",size:{width:8,height:56}}},{id:"table-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.TABLE,label:u[j.x9.TABLE],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/table.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/table-gr.png",size:{width:44,height:120}}},{id:"chair-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.CHAIR,label:u[j.x9.CHAIR],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/chair.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/chair-gr.png",size:{width:28,height:35}}},{id:"sofa-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.SOFA,label:u[j.x9.SOFA],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/sofa.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/sofa-gr.png",size:{width:67,height:123}}},{id:"bed-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.BED,label:u[j.x9.BED],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/bed.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/bed-gr.png",size:{width:89,height:128}}},{id:"lamp-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.LAMP,label:u[j.x9.LAMP],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/lamp.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/lamp-gr.png",size:{width:70,height:128}}},{id:"tv-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.TV,label:u[j.x9.TV],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/tv.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/tv-gr.png",size:{width:134,height:32}}},{id:"bookshelf-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.BOOKSHELF,label:u[j.x9.BOOKSHELF],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/bookshelf.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/bookshelf-gr.png",size:{width:44,height:44}}},{id:"wardrobe-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.WARDROBE,label:u[j.x9.WARDROBE],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/wardrobe.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/wardrobe-gr.png",size:{width:40,height:129}}},{id:"plant-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.PLANT,label:u[j.x9.PLANT],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/plant.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/plant-gr.png",size:{width:36,height:36}}},{id:"fridge-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.FRIDGE,label:u[j.x9.FRIDGE],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/fridge.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/fridge-gr.png",size:{width:40,height:43}}},{id:"stove-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.STOVE,label:u[j.x9.STOVE],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/stove.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/stove-gr.png",size:{width:62,height:32}}},{id:"sink-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.SINK,label:u[j.x9.SINK],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/sink.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/sink-gr.png",size:{width:60,height:40}}},{id:"washbasin-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.WASHBASIN,label:u[j.x9.WASHBASIN],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/washbasin.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/washbasin-gr.png",size:{width:50,height:50}}},{id:"toilet-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.TOILET,label:u[j.x9.TOILET],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/toilet.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/toilet-gr.png",size:{width:40,height:60}}},{id:"shower-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.SHOWER,label:u[j.x9.SHOWER],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/shower.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/shower-gr.png",size:{width:80,height:80}}},{id:"bathtub-template",type:j.w$.FURNITURE,data:{cateType:j.w$.FURNITURE,type:j.x9.BATHTUB,label:u[j.x9.BATHTUB],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/bathtub.png",activeIcon:"https://d3cbeloe0vn1bb.cloudfront.net/images/fur-icon/bathtub-gr.png",size:{width:120,height:60}}}],N=(0,n.FR)((0,n.MS)(n.IG,{tolerance:50}),(0,n.MS)(n.cA,{activationConstraint:{distance:10}})),R=(0,w.useRouter)(),[O,I]=(0,r.useState)(null),[E,T]=(0,r.useState)(!1),[C,S]=(0,r.useState)(0),[z,k]=(0,r.useState)(!1),[$,B]=(0,r.useState)([[]]),[L,_]=(0,r.useState)(0),[H,Y]=(0,r.useState)(!1),[P,X]=(0,r.useState)({}),[K,q]=(0,r.useState)(!1),et=(0,r.useRef)(null),ea=(0,r.useRef)(null),es=(0,U.A)(),ei=es?48:56,en=es?{width:200,height:200}:{width:300,height:300},[er,eo]=(0,r.useState)(!1),[el,ed]=(0,r.useState)(""),ec=[{id:"living-room",type:j.w$.ROOM,data:{cateType:j.w$.ROOM,type:j.sR.LIVING_ROOM,label:h[j.sR.LIVING_ROOM],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/room-icon/living_room.png",size:en}},{id:"dining-room",type:j.w$.ROOM,data:{cateType:j.w$.ROOM,type:j.sR.DINING_ROOM,label:h[j.sR.DINING_ROOM],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/room-icon/dining_room.png",size:en}},{id:"storage-room",type:j.w$.ROOM,data:{cateType:j.w$.ROOM,type:j.sR.STORAGE_ROOM,label:h[j.sR.STORAGE_ROOM],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/room-icon/storage_room.png",size:en}},{id:"study-room",type:j.w$.ROOM,data:{cateType:j.w$.ROOM,type:j.sR.STUDY_ROOM,label:h[j.sR.STUDY_ROOM],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/room-icon/study_room.png",size:en}},{id:"bedroom",type:j.w$.ROOM,data:{cateType:j.w$.ROOM,type:j.sR.BEDROOM,label:h[j.sR.BEDROOM],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/room-icon/bedroom.png",size:en}},{id:"bathroom",type:j.w$.ROOM,data:{cateType:j.w$.ROOM,type:j.sR.BATHROOM,label:h[j.sR.BATHROOM],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/room-icon/bathroom.png",size:en}},{id:"kitchen",type:j.w$.ROOM,data:{cateType:j.w$.ROOM,type:j.sR.KITCHEN,label:h[j.sR.KITCHEN],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/room-icon/kitchen.png",size:en}},{id:"balcony",type:j.w$.ROOM,data:{cateType:j.w$.ROOM,type:j.sR.BALCONY,label:h[j.sR.BALCONY],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/room-icon/balcony.png",size:en}},{id:"garden",type:j.w$.ROOM,data:{cateType:j.w$.ROOM,type:j.sR.GARDEN,label:h[j.sR.GARDEN],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/room-icon/garden.png",size:en}},{id:"garage",type:j.w$.ROOM,data:{cateType:j.w$.ROOM,type:j.sR.GARAGE,label:h[j.sR.GARAGE],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/room-icon/garage.png",size:en}},{id:"corridor",type:j.w$.ROOM,data:{cateType:j.w$.ROOM,type:j.sR.CORRIDOR,label:h[j.sR.CORRIDOR],icon:"https://d3cbeloe0vn1bb.cloudfront.net/images/room-icon/corridor.png",size:en}}],{data:eh}=(0,ee.wV)();(0,r.useEffect)(()=>{let e=()=>{ea.current&&S(ea.current.offsetWidth)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,r.useEffect)(()=>{(async()=>{var e,t,a,s,i;let n=null==eh?void 0:null===(e=eh.user)||void 0===e?void 0:e.userId;if(n)try{q(!0);let{status:e,message:r,data:o}=await (0,J.Jt)("/api/users/".concat(n)),{status:l,message:d,data:c}=await (0,J.Jt)("/api/design/".concat(n));if(0!==e){M.oR.error("查询用户错误:"+r);return}if(0!==l){M.oR.error("查询布局错误:"+d);return}X(o),Y(!0);let{localItems:h=[],scale:u=100,canvasPosition:p={x:0,y:0},compassRotation:x=0}=c,g=h.map(e=>({...e,type:e._type,data:{...e.data,type:e.data._type}}));null===(t=et.current)||void 0===t||t.setLocalItems(g),null===(a=et.current)||void 0===a||a.setPosition(p),null===(s=et.current)||void 0===s||s.setCompassRotation(x),null===(i=et.current)||void 0===i||i.setScale(u),q(!1)}catch(e){q(!1),M.oR.error("加载布局错误:"+e),console.error("Error loading design:",e)}})()},[null==eh?void 0:null===(t=eh.user)||void 0===t?void 0:t.userId]);let eu=(e,t)=>{let{over:a}=e,s=(null==a?void 0:a.id)==="canvas";if(T(s),s){let e=et.current.getLocalItems(),a="".concat(O.data.current.label).concat(e.filter(e=>e.data.type===O.data.current.type).length+1),s={id:"".concat(O.data.current.type,"-").concat(e.filter(e=>e.data.type===O.data.current.type).length+1),type:O.data.current.cateType,data:{...O.data.current,label:O.data.current.cateType===j.w$.ROOM?a:""},size:O.data.current.size,activeIcon:O.data.current.activeIcon};et.current.setIsRoomDragging(!0),et.current.setRoomDragStart(t),et.current.setDraggedRoom(s)}else et.current.setIsRoomDragging(!1)},ep=async()=>{var e;(null==eh?void 0:null===(e=eh.user)||void 0===e?void 0:e.userId)||(0,w.redirect)("/auth/login");try{q(!0);let e=function(e){var t;let a,s,i,n,r,o,l,d=e.localItems.filter(e=>"room"===e.type),c=e.localItems.filter(e=>"furniture"===e.type),h=(e,t,a,s,i)=>{if(e===t)return"center";let n=e.position.x+e.size.width/2,r=e.position.y+e.size.height/2,o=180/Math.PI*Math.atan2(n-a,-(r-s));for(let t of(o<0&&(o+=360),console.log("newDirections",o,e,n,r,a,s),i))if(337.5!==t.range[0]){if(o>=t.range[0]&&o<t.range[1])return t.name}else if(o>=t.range[0]||o<t.range[1])return t.name},{centerRoom:u,centerX:p,centerY:x}=(a=0,s=0,i=d[0].position.x+d[0].size.width/2,n=d[0].position.y+d[0].size.height/2,r=d[0].position.x+d[0].size.width/2,o=d[0].position.y+d[0].size.height/2,d.forEach(e=>{e.position.x+e.size.width/2<i&&(i=e.position.x+e.size.width/2),e.position.y+e.size.height/2<n&&(n=e.position.y+e.size.height/2),e.position.x+e.size.width/2>r&&(r=e.position.x+e.size.width/2),e.position.y+e.size.height/2>o&&(o=e.position.y+e.size.height/2)}),a=(i+r)/2,s=(n+o)/2,{centerRoom:d.find(e=>e.position.x<=a&&e.position.x+e.size.width>=a&&e.position.y<=s&&e.position.y+e.size.height>=s),centerX:a,centerY:s}),g=(t=e.compassRotation||0,console.log("northIndex",l=Z.findIndex(e=>e.baseAngle===t%360)),Z.slice(l).concat(Z.slice(0,l)).map((e,t)=>({...e,name:Z[t].name}))),m=d.map(e=>{let t=h(e,u,p,x,g);return{...e,direction:t}});return{...e,localItems:[...m,...c]}}({localItems:et.current.getLocalItems(),canvasPosition:et.current.getPosition(),compassRotation:et.current.getCompassRotation(),scale:et.current.getScale()}),{status:t}=await (0,J.bE)("/api/design/".concat(eh.user.userId),e);0==t&&M.oR.success("保存成功！")}catch(e){M.oR.error("保存失败："+e),console.error("Error saving design:",e)}finally{q(!1)}},ex=async()=>{var e;(null==eh?void 0:null===(e=eh.user)||void 0===e?void 0:e.userId)||(0,w.redirect)("/auth/login");let t=eh.user.userId,a=et.current.getLocalItems(),s=!1,i=!1;if(a.forEach(e=>{"door"===e.data.type&&(s=!0),"window"===e.data.type&&(i=!0)}),!s||!i){M.oR.error(l("warning"),{autoClose:!1,style:{width:400}});return}try{let{status:e,data:a}=await (0,J.Jt)("/api/reportUserDoc/".concat(t,"/").concat("zh-CN"==o?"zh":"tw"));a?eo(!0):(await ep(),R.push("/report"))}catch(e){}},eg=async()=>{var e;(null==eh?void 0:null===(e=eh.user)||void 0===e?void 0:e.userId)||(0,w.redirect)("/auth/login");let t=eh.user.userId;await ep();try{eo(!1),q(!0);let{status:e}=await (0,J.bE)("/api/users/".concat(eh.user.userId),{isLock:!0,genStatus:"none"}),{status:a}=await (0,J.F6)("/api/reportUserDoc/".concat(t),{isDelete:1});q(!1),0==e&&0==a&&R.push("/report")}catch(e){}},em=()=>{if(L>0){var e,t;null===(e=et.current)||void 0===e||e.setActiveRoom(null),_(e=>e-1),null===(t=et.current)||void 0===t||t.setLocalItems($[L-1])}},eb=()=>{if(L<$.length-1){var e,t;null===(e=et.current)||void 0===e||e.setActiveRoom(null),_(e=>e+1),null===(t=et.current)||void 0===t||t.setLocalItems($[L+1])}},ef=async e=>{var t;(null==eh?void 0:null===(t=eh.user)||void 0===t?void 0:t.userId)||(0,w.redirect)("/auth/login"),q(!0),X(e);try{let{status:t}=await (0,J.bE)("/api/users/".concat(eh.user.userId),{gender:e.gender,birthDateTime:e.birthDateTime.toISOString()});0==t&&(M.oR.success("保存成功！"),Y(!1))}catch(e){M.oR.error("保存失败："+e),console.error("Error saving user info:",e)}finally{q(!1)}};return(0,i.jsx)(r.Suspense,{fallback:(0,i.jsx)("div",{children:"loading..."}),children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eR.m5,{fullscreen:!0,spinning:K,tip:d("loading2"),className:"bg-[#fff9]"}),(0,i.jsx)(eN,{open:H,onUserOpen:Y,onSubmit:ef,userInfo:P}),es?(0,i.jsx)(W,{onSaveProject:ep,history:$,historyIndex:L,handleUndo:em,handleRedo:eb,onUserOpen:Y}):(0,i.jsx)(G,{onSaveProject:ep,onGenReport:ex,onUserOpen:Y}),(0,i.jsx)("div",{className:"pt-16",children:(0,i.jsxs)(n.Mp,{sensors:N,onDragStart:e=>{let{active:t}=e;I(t),T(!1)},onDragOver:e=>{es||eu(e,{x:C,y:ei})},onDragMove:e=>{es&&e.delta.y<-120&&eu(e,{x:0,y:50})},children:[(0,i.jsx)("div",{className:"min-h-[calc(100vh-64px)] bg-gray-50",children:(0,i.jsx)("div",{className:"container p-0",style:{maxWidth:"100%"},children:(0,i.jsxs)("div",{className:"flex h-[calc(100vh-64px)]",children:[es?(0,i.jsx)(Q,{showTab:z,setShowTab:k,roomItems:ec,furnitureItems:p,isOverCanvas:E,draggingItemSize:ei}):(0,i.jsx)(V,{sidebarRef:ea,roomItems:ec,furnitureItems:p,isOverCanvas:E,draggingItemSize:ei}),(0,i.jsx)("div",{className:"flex-1 overflow-auto",id:"canvas-drop-area",children:(0,i.jsx)(F,{ref:et,locale:o,history:$,historyIndex:L,setHistory:B,setHistoryIndex:_,handleUndo:em,handleRedo:eb,onGenReport:ex,showTab:z,onShowTab:()=>{k(!0)}})})]})})}),(0,i.jsx)(n.Hd,{children:(null==O?void 0:O.id)&&E&&(O.data.current.cateType===j.w$.ROOM?(0,i.jsx)("div",{className:"flex flex-col items-center justify-center bg-white/80 rounded-lg",style:{transform:es?"translateY(78px)":"translateY(0)",width:en.width,height:en.height,border:"8px solid",borderColor:eO[null===(a=ec.find(e=>e.id===O.id))||void 0===a?void 0:a.data.type],borderRadius:"8px"},children:(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)(A.default,{className:"bg-[#EFF7F4] rounded-lg",src:O.data.current.icon,alt:"Room",width:ei,height:ei}),(0,i.jsx)("span",{className:"mt-1 text-sm text-gray-600",children:O.data.current.label+(et.current.getLocalItems().filter(e=>e.data.type===O.data.current.type).length+1)})]})}):(0,i.jsx)(A.default,{src:O.data.current.activeIcon,alt:"Furniture",width:O.data.current.size.width,height:O.data.current.size.height}))})]})}),(0,i.jsx)(c,{open:er,onOpenChange:eo,children:(0,i.jsxs)(x,{children:[(0,i.jsxs)(g,{children:[(0,i.jsx)(b,{children:l("hasReportAlert")}),(0,i.jsx)(f,{children:l("description")})]}),(0,i.jsxs)(m,{children:[(0,i.jsx)(y,{children:l("cancel")}),(0,i.jsx)(v,{onClick:()=>{eo(!1),R.push("/report")},children:l("readReport")}),(0,i.jsx)(v,{onClick:eg,children:l("coverReport")})]})]})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[3265,2376,1400,3379,3257,8403,7029,5593,1882,7642,52,1638,2072,7358],()=>t(6034)),_N_E=e.O()}]);