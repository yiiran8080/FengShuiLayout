(()=>{var e={};e.id=4448,e.ids=[4448],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27900:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29407:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var s=r(60687),l=r(43210),a=r(99208),n=r(16189),i=r(67760),o=r(62688);let d=(0,o.A)("sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),c=(0,o.A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var u=r(78200);let p=(0,o.A)("message-circle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),h=(0,o.A)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),x=(0,o.A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var m=r(27900),g=r(64398);let b=(0,o.A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),y=({onAnalysisComplete:e,userProfile:t})=>{let[r,a]=(0,l.useState)(0),[n,o]=(0,l.useState)({emotionalState:"",lifeAreas:[],priorities:[],timeframe:""}),u=[{id:"stressed",label:"壓力很大",icon:"\uD83D\uDE13",color:"bg-red-100 text-red-700"},{id:"anxious",label:"感到焦慮",icon:"\uD83D\uDE30",color:"bg-orange-100 text-orange-700"},{id:"confused",label:"感到迷茫",icon:"\uD83D\uDE15",color:"bg-yellow-100 text-yellow-700"},{id:"sad",label:"心情低落",icon:"\uD83D\uDE22",color:"bg-blue-100 text-blue-700"},{id:"hopeful",label:"充滿希望",icon:"\uD83D\uDE0A",color:"bg-green-100 text-green-700"},{id:"neutral",label:"情緒平穩",icon:"\uD83D\uDE10",color:"bg-gray-100 text-gray-700"}],p=[{id:"career",label:"事業工作",icon:(0,s.jsx)(g.A,{className:"w-5 h-5"}),description:"工作發展、職場關係"},{id:"relationship",label:"感情關係",icon:(0,s.jsx)(i.A,{className:"w-5 h-5"}),description:"愛情、婚姻、人際關係"},{id:"health",label:"健康狀況",icon:(0,s.jsx)(d,{className:"w-5 h-5"}),description:"身體健康、精神狀態"},{id:"finance",label:"財運金錢",icon:(0,s.jsx)(c,{className:"w-5 h-5"}),description:"財務狀況、投資理財"},{id:"family",label:"家庭和睦",icon:(0,s.jsx)(b,{className:"w-5 h-5"}),description:"家人關係、居家環境"},{id:"personal",label:"個人成長",icon:(0,s.jsx)(g.A,{className:"w-5 h-5"}),description:"學習進步、自我提升"}],h=e=>{o(t=>({...t,emotionalState:e})),a(1)},x=e=>{o(t=>({...t,lifeAreas:t.lifeAreas.includes(e)?t.lifeAreas.filter(t=>t!==e):[...t.lifeAreas,e]}))},m=()=>{let e=u.find(e=>e.id===n.emotionalState),t=p.filter(e=>n.lifeAreas.includes(e.id));return`我目前的情緒狀態是${e?.label}，主要關心的生活領域包括：${t.map(e=>e.label).join("、")}。請根據我的情況提供情感支持和風水建議，幫助我改善目前的狀況。`},y=[{title:"你現在的心情如何？",subtitle:"選擇最符合你目前情緒狀態的選項",content:(0,s.jsx)("div",{className:"grid grid-cols-2 gap-3",children:u.map(e=>(0,s.jsx)("button",{onClick:()=>h(e.id),className:`p-4 rounded-xl border-2 hover:border-purple-300 transition-all text-left ${n.emotionalState===e.id?"border-purple-500 bg-purple-50":"border-gray-200 hover:bg-gray-50"}`,children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("span",{className:"text-2xl",children:e.icon}),(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"font-medium text-gray-800",children:e.label})})]})},e.id))})},{title:"哪些生活領域需要關注？",subtitle:"可以選擇多個你想改善的方面",content:(0,s.jsxs)("div",{className:"space-y-3",children:[p.map(e=>(0,s.jsx)("button",{onClick:()=>x(e.id),className:`w-full p-4 rounded-xl border-2 transition-all text-left ${n.lifeAreas.includes(e.id)?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300 hover:bg-gray-50"}`,children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"text-purple-600",children:e.icon}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium text-gray-800",children:e.label}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:e.description})]}),n.lifeAreas.includes(e.id)&&(0,s.jsx)("div",{className:"w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white text-sm",children:"✓"})})]})},e.id)),(0,s.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,s.jsx)("button",{onClick:()=>a(0),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-50",children:"上一步"}),(0,s.jsx)("button",{onClick:()=>{e(m(),n)},disabled:0===n.lifeAreas.length,className:"px-6 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-purple-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"開始分析"})]})]})}];return(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-6",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:y[r].title}),(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:[r+1,"/2"]})]}),(0,s.jsx)("p",{className:"text-gray-600",children:y[r].subtitle})]}),y[r].content,(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-300",style:{width:`${(r+1)/y.length*100}%`}})})})]})};var f=r(48730);let v=({onAnalysisComplete:e,userProfile:t})=>{let[r,a]=(0,l.useState)({year:"",month:"",day:"",hour:"",gender:"",location:t.location||""}),[n,i]=(0,l.useState)(!1),o=[{value:"23-01",label:"子時 (23:00-01:00)",element:"水"},{value:"01-03",label:"丑時 (01:00-03:00)",element:"土"},{value:"03-05",label:"寅時 (03:00-05:00)",element:"木"},{value:"05-07",label:"卯時 (05:00-07:00)",element:"木"},{value:"07-09",label:"辰時 (07:00-09:00)",element:"土"},{value:"09-11",label:"巳時 (09:00-11:00)",element:"火"},{value:"11-13",label:"午時 (11:00-13:00)",element:"火"},{value:"13-15",label:"未時 (13:00-15:00)",element:"土"},{value:"15-17",label:"申時 (15:00-17:00)",element:"金"},{value:"17-19",label:"酉時 (17:00-19:00)",element:"金"},{value:"19-21",label:"戌時 (19:00-21:00)",element:"土"},{value:"21-23",label:"亥時 (21:00-23:00)",element:"水"}];return(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-6",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"生辰八字分析"}),(0,s.jsx)("p",{className:"text-gray-600",children:"請提供您的出生資訊，我會為您進行詳細的命理分析"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"出生年"}),(0,s.jsxs)("select",{value:r.year,onChange:e=>a(t=>({...t,year:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300",children:[(0,s.jsx)("option",{value:"",children:"選擇年份"}),Array.from({length:80},(e,t)=>{let r=new Date().getFullYear()-t;return(0,s.jsx)("option",{value:r,children:r},r)})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"出生月"}),(0,s.jsxs)("select",{value:r.month,onChange:e=>a(t=>({...t,month:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300",children:[(0,s.jsx)("option",{value:"",children:"月份"}),Array.from({length:12},(e,t)=>(0,s.jsxs)("option",{value:t+1,children:[t+1,"月"]},t+1))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"出生日"}),(0,s.jsxs)("select",{value:r.day,onChange:e=>a(t=>({...t,day:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300",children:[(0,s.jsx)("option",{value:"",children:"日期"}),Array.from({length:31},(e,t)=>(0,s.jsxs)("option",{value:t+1,children:[t+1,"日"]},t+1))]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"出生時辰"}),(0,s.jsxs)("button",{onClick:()=>i(!n),className:"text-sm text-purple-600 hover:text-purple-700",children:[(0,s.jsx)(f.A,{className:"w-4 h-4 inline mr-1"}),"時辰說明"]})]}),(0,s.jsxs)("select",{value:r.hour,onChange:e=>a(t=>({...t,hour:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300",children:[(0,s.jsx)("option",{value:"",children:"選擇出生時辰（可選）"}),o.map(e=>(0,s.jsxs)("option",{value:e.value,children:[e.label," - ",e.element,"行"]},e.value))]}),n&&(0,s.jsxs)("div",{className:"mt-2 p-3 bg-purple-50 rounded-lg text-sm text-purple-700",children:[(0,s.jsx)("p",{className:"font-medium mb-1",children:"\uD83D\uDCA1 時辰提示："}),(0,s.jsx)("p",{children:"出生時辰對八字分析很重要，如果不確定確切時間，可以詢問家人或查看出生證明。沒有時辰資訊也可以進行基本分析。"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"性別"}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("button",{onClick:()=>a(e=>({...e,gender:"男"})),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-all ${"男"===r.gender?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-300 hover:border-purple-300"}`,children:"男性"}),(0,s.jsx)("button",{onClick:()=>a(e=>({...e,gender:"女"})),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-all ${"女"===r.gender?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-300 hover:border-purple-300"}`,children:"女性"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,s.jsx)(b,{className:"w-4 h-4 inline mr-1"}),"出生地"]}),(0,s.jsx)("input",{type:"text",value:r.location,onChange:e=>a(t=>({...t,location:e.target.value})),placeholder:"例：台北市、高雄市...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300"})]}),(0,s.jsxs)("button",{onClick:()=>{let t;if(!r.year||!r.month||!r.day){alert("請填寫完整的出生年月日");return}let s=new Date(r.year,r.month-1,r.day),l=new Date().getFullYear()-s.getFullYear(),a=parseInt(r.month),n=parseInt(r.day),i=["摩羯座","水瓶座","雙魚座","牡羊座","金牛座","雙子座","巨蟹座","獅子座","處女座","天秤座","天蠍座","射手座"][12===a&&n>=22||1===a&&n<=19?0:1===a&&n>=20||2===a&&n<=18?1:2===a&&n>=19||3===a&&n<=20?2:3===a&&n>=21||4===a&&n<=19?3:4===a&&n>=20||5===a&&n<=20?4:5===a&&n>=21||6===a&&n<=20?5:6===a&&n>=21||7===a&&n<=22?6:7===a&&n>=23||8===a&&n<=22?7:8===a&&n>=23||9===a&&n<=22?8:9===a&&n>=23||10===a&&n<=22?9:10===a&&n>=23||11===a&&n<=21?10:11],d=["鼠","牛","虎","兔","龍","蛇","馬","羊","猴","雞","狗","豬"][(parseInt(r.year)-1900)%12],c=o.find(e=>e.value===r.hour),u=c?.element||"未知";e(`請幫我分析生辰八字：
出生日期：${r.year}年${r.month}月${r.day}日
出生時辰：${c?.label||"未提供"}
性別：${r.gender}
星座：${i}
生肖：${d}
出生地：${r.location}
目前年齡：${l}歲

請根據這些資訊分析我的：
1. 五行屬性和個人特質
2. 適合的風水佈局建議
3. 今年的運勢走向
4. 開運的顏色和方位
5. 需要注意的事項

請用溫暖關懷的語調，提供實用的建議。`,{...r,zodiacSign:i,chineseZodiacYear:d,hourElement:u,age:l})},className:"w-full py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all hover:scale-105 flex items-center justify-center space-x-2",children:[(0,s.jsx)(g.A,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:"開始八字分析"})]})]}),(0,s.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-700",children:[(0,s.jsx)("p",{className:"font-medium mb-1",children:"\uD83D\uDD2E 分析內容包含："}),(0,s.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,s.jsx)("li",{children:"個人五行屬性與性格特質"}),(0,s.jsx)("li",{children:"適合的風水佈局建議"}),(0,s.jsx)("li",{children:"運勢趨勢與開運方法"}),(0,s.jsx)("li",{children:"幸運顏色與方位指引"})]})]})]})};function j(){let{data:e}=(0,a.wV)(),t=(0,n.useRouter)(),[o,g]=(0,l.useState)([{id:1,role:"assistant",content:"你好！我係你嘅風水AI助手小風 \uD83C\uDF38 我喺呢度聆聽你嘅煩惱，提供溫暖嘅建議，並引導你發現生活中嘅正能量。請話俾我知，今日有咩想傾嘅嗎？",timestamp:new Date,emotion:"welcoming"}]),[b,f]=(0,l.useState)(""),[j,N]=(0,l.useState)(!1),[w,k]=(0,l.useState)({name:e?.user?.name||"",birthday:"",birthTime:"",concerns:[],emotionalState:"neutral"}),[A,C]=(0,l.useState)(!1),[D,S]=(0,l.useState)(!1),[M,$]=(0,l.useState)(!1),q=(0,l.useRef)(null),F=(e,t)=>{if(!t)return;let r=w.birthday?new Date(w.birthday):new Date;switch(e){case"year":r.setFullYear(parseInt(t));break;case"month":r.setMonth(parseInt(t)-1);break;case"day":r.setDate(parseInt(t))}let s=r.toISOString().split("T")[0];k(e=>({...e,birthday:s}))},P=e=>{let r;let l=/\[([^\]]+)\]\(([^)]+)\)/g,a=[],n=0;for(;null!==(r=l.exec(e));)r.index>n&&a.push(e.slice(n,r.index)),a.push((0,s.jsx)("a",{href:r[2],className:"text-blue-600 underline cursor-pointer hover:text-blue-800",onClick:e=>{e.preventDefault(),t.push(r[2])},children:r[1]},r.index)),n=r.index+r[0].length;return n<e.length&&a.push(e.slice(n)),a.length>0?a:e},L=e=>{for(let[t,r]of Object.entries({stressed:["壓力","焦慮","緊張","擔心","困擾","煩惱","累","攰"],sad:["難過","傷心","沮喪","憂鬱","失落","孤單","唔開心"],angry:["生氣","憤怒","不爽","火大","討厭","嬲","激嬲"],confused:["不知道","困惑","迷茫","不懂","疑問","唔明","亂"],hopeful:["希望","期待","想要","渴望","夢想","盼望"],happy:["開心","快樂","高興","興奮","滿足","爽","正"]}))if(r.some(t=>e.includes(t)))return t;return"neutral"},_=(e,t)=>{let r={stressed:["我感受到你而家壓力好大 \uD83D\uDE14 深呼吸一下，等我哋一齊面對呢個挑戰。","壓力確實好難承受，但你已經好勇敢咁講出嚟 \uD83D\uDCAA 我哋嚟諗下解決方法。"],sad:["我聽到你內心嘅痛苦 \uD83D\uDC99 俾自己感受呢啲情緒係好重要嘅。","每個人都會有低潮嘅時候，你並唔孤單 \uD83E\uDD17 等我陪你度過呢段時光。"],angry:["我理解你嘅憤怒，呢啲情緒都係合理嘅 \uD83D\uDD25 等我哋搵個健康嘅方式嚟處理佢。","嬲嘅時候好容易失去理智，但你選擇咗溝通，呢個好棒 \uD83D\uDC4F"],confused:["迷茫係成長嘅一部分 \uD83C\uDF31 等我哋一齊理清思緒，搵到方向。","唔確定嘅感覺我明 \uD83E\uDD14 有時候慢慢探索比急住搵答案更有意義。"],hopeful:["我感受到你內心嘅希望之光 ✨ 呢種正能量好珍貴，等我哋好好培養佢。","有夢想嘅人最靚 \uD83C\uDF1F 等我幫你實現呢啲美好嘅願望。"],happy:["睇到你咁開心，我都感到好溫暖 \uD83D\uDE0A 分享快樂會令佢加倍！","你嘅快樂好有感染力 \uD83C\uDF08 繼續保持呢種美好嘅心情！"],neutral:["多謝你同我分享 \uD83D\uDE0C 我好樂意聽你講更多。","我喺呢度陪伴你 \uD83D\uDC9B 無論咩話題都可以傾。"]},s=r[e]||r.neutral;return s[Math.floor(Math.random()*s.length)]},z=(e,t)=>{let r={career:"事業運勢可以通過調整辦公桌朝向同加強東方能量嚟提升 \uD83D\uDCC8",relationship:"喺睡房西南角放置成雙嘅物品可以增進感情運 \uD83D\uDC95",health:"保持居住空間嘅清潔同通風，特別注意廚房同浴室嘅風水 \uD83C\uDF3F",finance:"財運同東南方位相關，可以喺嗰個方位放置綠色植物 \uD83D\uDCB0",family:"家庭和諧需要客廳嘅正能量，避免尖角對住座位 \uD83C\uDFE0",stress:"喺屋企北方放置水元素（如小噴泉）有助於緩解壓力 \uD83C\uDF0A"};return"stressed"===t?r.stress:Object.values(r)[Math.floor(Math.random()*Object.values(r).length)]},E=async()=>{if(!b.trim()||j)return;let e={id:Date.now(),role:"user",content:b,timestamp:new Date,emotion:L(b)};g(t=>[...t,e]),f(""),N(!0);try{let t=L(b),r=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[...o,e],userProfile:w,emotion:t,context:"feng_shui_emotional_support"})});if(!r.ok)throw Error("Failed to get AI response");let s=await r.json(),l={id:Date.now()+1,role:"assistant",content:s.content,timestamp:new Date,emotion:"supportive",suggestions:s.suggestions||[]};g(e=>[...e,l])}catch(e){console.error("Chat error:",e);try{let{analyzeUserEmotion:e,detectTopic:t,generatePersonalResponse:s}=await r.e(3685).then(r.bind(r,83685)),l=e(b),a=t(b),n=s(b,w,l,a),i={id:Date.now()+1,role:"assistant",content:n,timestamp:new Date,emotion:"supportive"};g(e=>[...e,i])}catch(r){console.error("Failed to load enhanced fallback system:",r);let e=L(b),t={id:Date.now()+1,role:"assistant",content:`${_(e,b)}

${z(w.concerns,e)}`,timestamp:new Date,emotion:"supportive"};g(e=>[...e,t])}}finally{N(!1)}},H=[{icon:(0,s.jsx)(i.A,{className:"w-4 h-4"}),text:"我感到焦慮",message:"最近我感到好焦慮，唔知道應該點辦..."},{icon:(0,s.jsx)(d,{className:"w-4 h-4"}),text:"想改善運勢",message:"我想了解點樣通過風水嚟改善我嘅運勢"},{icon:(0,s.jsx)(c,{className:"w-4 h-4"}),text:w.birthday?"我嘅八字分析":"提供生日分析",message:w.birthday?"根據我嘅生日分析一下我嘅運勢":"我想提供我嘅生日進行八字分析",action:w.birthday?null:()=>$(!0)},{icon:(0,s.jsx)(u.A,{className:"w-4 h-4"}),text:"情緒分析",action:()=>S(!0)}],I=e=>{e.message?f(e.message):e.action&&e.action()},U=(e,t)=>{S(!1),$(!1),f(e),setTimeout(()=>{E()},100)};return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-indigo-50",children:[(0,s.jsx)("div",{className:"sticky top-0 z-10 border-b border-purple-100 bg-white/80 backdrop-blur-sm",children:(0,s.jsx)("div",{className:"container px-4 py-4 mx-auto",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-pink-500",children:(0,s.jsx)(p,{className:"w-6 h-6 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"風水AI助手小風"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"情感支持 • 風水指導 • 生活建議"})]})]}),(0,s.jsx)("button",{onClick:()=>C(!0),className:"px-4 py-2 text-purple-700 transition-colors bg-purple-100 rounded-lg hover:bg-purple-200",children:"個人資料"})]})})}),(0,s.jsx)("div",{className:"container max-w-4xl px-4 py-6 mx-auto",children:(0,s.jsxs)("div",{className:"overflow-hidden border shadow-xl bg-white/60 backdrop-blur-sm rounded-2xl border-white/20",children:[(0,s.jsxs)("div",{className:"h-[600px] overflow-y-auto p-6 space-y-4",children:[o.map(e=>(0,s.jsx)("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,s.jsx)("div",{className:`max-w-[80%] rounded-2xl px-4 py-3 ${"user"===e.role?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":"bg-white/80 border border-gray-200 text-gray-800"}`,children:(0,s.jsxs)("div",{className:"flex items-start space-x-2",children:["assistant"===e.role&&(0,s.jsx)(h,{className:"flex-shrink-0 w-5 h-5 mt-1 text-purple-500"}),"user"===e.role&&(0,s.jsx)(x,{className:"flex-shrink-0 w-5 h-5 mt-1 text-white"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"whitespace-pre-wrap",children:P(e.content)}),e.suggestions&&e.suggestions.length>0&&(0,s.jsx)("div",{className:"mt-3 space-y-2",children:e.suggestions.map((e,t)=>(0,s.jsx)("button",{onClick:()=>f(e),className:"block w-full px-3 py-2 text-sm text-left text-purple-700 transition-colors rounded-lg bg-purple-50 hover:bg-purple-100",children:e},t))}),(0,s.jsx)("p",{className:"mt-2 text-xs opacity-60",children:e.timestamp.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})})]})]})})},e.id)),j&&(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("div",{className:"px-4 py-3 border border-gray-200 bg-white/80 rounded-2xl",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(h,{className:"w-5 h-5 text-purple-500"}),(0,s.jsxs)("div",{className:"flex space-x-1",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce"}),(0,s.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,s.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})}),(0,s.jsx)("div",{ref:q})]}),(0,s.jsxs)("div",{className:"px-6 py-4 border-t border-gray-200/50",children:[(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 mb-4 md:grid-cols-4",children:H.map((e,t)=>(0,s.jsxs)("button",{onClick:()=>I(e),className:"flex items-center px-3 py-2 space-x-2 text-sm text-purple-700 transition-all rounded-lg bg-gradient-to-r from-purple-100 to-pink-100 hover:from-purple-200 hover:to-pink-200 hover:scale-105",children:[e.icon,(0,s.jsx)("span",{className:"hidden sm:inline",children:e.text})]},t))}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("div",{className:"relative flex-1",children:(0,s.jsx)("textarea",{value:b,onChange:e=>f(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),E())},placeholder:"輸入你嘅想法，等我陪伴你...",className:"w-full px-4 py-3 transition-all border border-gray-200 resize-none bg-white/80 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-300 focus:border-transparent",rows:"2",disabled:j})}),(0,s.jsx)("button",{onClick:E,disabled:!b.trim()||j,className:"flex items-center justify-center px-6 py-3 text-white transition-all bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl hover:from-purple-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed hover:scale-105",children:(0,s.jsx)(m.A,{className:"w-5 h-5"})})]})]})]})}),A&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"w-full max-w-md p-6 bg-white shadow-2xl rounded-2xl",children:[(0,s.jsx)("h2",{className:"mb-4 text-xl font-bold text-gray-800",children:"個人資料設定"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"姓名"}),(0,s.jsx)("input",{type:"text",value:w.name,onChange:e=>k(t=>({...t,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300",placeholder:"請輸入你嘅姓名"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"生日"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-4",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("select",{value:w.birthday?new Date(w.birthday).getFullYear():"",onChange:e=>F("year",e.target.value),className:"w-full px-2 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300",children:[(0,s.jsx)("option",{value:"",children:"年"}),Array.from({length:80},(e,t)=>new Date().getFullYear()-15-t).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("select",{value:w.birthday?new Date(w.birthday).getMonth()+1:"",onChange:e=>F("month",e.target.value),className:"w-full px-2 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300",children:[(0,s.jsx)("option",{value:"",children:"月"}),Array.from({length:12},(e,t)=>t+1).map(e=>(0,s.jsxs)("option",{value:e,children:[e,"月"]},e))]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("select",{value:w.birthday?new Date(w.birthday).getDate():"",onChange:e=>F("day",e.target.value),className:"w-full px-2 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300",children:[(0,s.jsx)("option",{value:"",children:"日"}),Array.from({length:31},(e,t)=>t+1).map(e=>(0,s.jsxs)("option",{value:e,children:[e,"日"]},e))]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("select",{value:w.birthTime||"",onChange:e=>k(t=>({...t,birthTime:e.target.value})),className:"w-full px-2 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300",children:[(0,s.jsx)("option",{value:"",children:"時間"}),(0,s.jsx)("option",{value:"子時",children:"子時 (23:00-01:00)"}),(0,s.jsx)("option",{value:"丑時",children:"丑時 (01:00-03:00)"}),(0,s.jsx)("option",{value:"寅時",children:"寅時 (03:00-05:00)"}),(0,s.jsx)("option",{value:"卯時",children:"卯時 (05:00-07:00)"}),(0,s.jsx)("option",{value:"辰時",children:"辰時 (07:00-09:00)"}),(0,s.jsx)("option",{value:"巳時",children:"巳時 (09:00-11:00)"}),(0,s.jsx)("option",{value:"午時",children:"午時 (11:00-13:00)"}),(0,s.jsx)("option",{value:"未時",children:"未時 (13:00-15:00)"}),(0,s.jsx)("option",{value:"申時",children:"申時 (15:00-17:00)"}),(0,s.jsx)("option",{value:"酉時",children:"酉時 (17:00-19:00)"}),(0,s.jsx)("option",{value:"戌時",children:"戌時 (19:00-21:00)"}),(0,s.jsx)("option",{value:"亥時",children:"亥時 (21:00-23:00)"})]})})]}),(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"時間可選填，有助更精確嘅八字分析"})]})]}),(0,s.jsxs)("div",{className:"flex mt-6 space-x-3",children:[(0,s.jsx)("button",{onClick:()=>C(!1),className:"flex-1 px-4 py-2 text-gray-700 transition-colors border border-gray-300 rounded-lg hover:bg-gray-50",children:"取消"}),(0,s.jsx)("button",{onClick:()=>{C(!1);let e={id:Date.now(),role:"assistant",content:`好高興認識你，${w.name}！🌸 根據你提供嘅資訊，我會更好咁為你提供個人化嘅建議。${w.birthTime?`有埋時辰資料會令八字分析更準確！`:""}如果你想分析生辰八字或者居住環境嘅風水，我隨時都喺呢度幫你 ✨`,timestamp:new Date,emotion:"welcoming"};g(t=>[...t,e])},className:"flex-1 px-4 py-2 text-white transition-all rounded-lg bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:"保存"})]})]})}),D&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:(0,s.jsx)("div",{className:"max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)("div",{className:"bg-white shadow-2xl rounded-2xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"情緒分析助手"}),(0,s.jsx)("button",{onClick:()=>S(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)(y,{onAnalysisComplete:U,userProfile:w})})]})})}),M&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:(0,s.jsx)("div",{className:"max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)("div",{className:"bg-white shadow-2xl rounded-2xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"生辰八字分析"}),(0,s.jsx)("button",{onClick:()=>$(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)(v,{onAnalysisComplete:U,userProfile:w})})]})})})]})}},33873:e=>{"use strict";e.exports=require("path")},44054:(e,t,r)=>{Promise.resolve().then(r.bind(r,29407))},47252:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/[locale]/chat/page.jsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/[locale]/chat/page.jsx","default")},48249:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=r(65239),l=r(48088),a=r(88170),n=r.n(a),i=r(30893),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let d={children:["",{children:["[locale]",{children:["chat",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,47252)),"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/[locale]/chat/page.jsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,11434)),"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/[locale]/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,66196)),"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/[locale]/error.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,54413)),"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/[locale]/chat/page.jsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:l.RouteKind.APP_PAGE,page:"/[locale]/chat/page",pathname:"/[locale]/chat",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},48730:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},62688:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var s=r(43210);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),n=e=>{let t=a(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:l,className:a="",children:n,iconNode:d,...c},u)=>(0,s.createElement)("svg",{ref:u,...o,width:t,height:t,stroke:e,strokeWidth:l?24*Number(r)/Number(t):r,className:i("lucide",a),...c},[...d.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(n)?n:[n]])),c=(e,t)=>{let r=(0,s.forwardRef)(({className:r,...a},o)=>(0,s.createElement)(d,{ref:o,iconNode:t,className:i(`lucide-${l(n(e))}`,`lucide-${e}`,r),...a}));return r.displayName=n(e),r}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64398:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},67760:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},78200:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]])},79551:e=>{"use strict";e.exports=require("url")},81006:(e,t,r)=>{Promise.resolve().then(r.bind(r,47252))}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[7719,7380,9916,7076,5127,8491],()=>r(48249));module.exports=s})();