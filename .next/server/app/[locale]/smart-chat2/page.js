(()=>{var e={};e.id=3546,e.ids=[3546],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15444:(e,t,r)=>{Promise.resolve().then(r.bind(r,44877))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},24224:(e,t,r)=>{"use strict";r.d(t,{F:()=>n});var s=r(49384);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,o=s.$,n=(e,t)=>r=>{var s;if((null==t?void 0:t.variants)==null)return o(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:n,defaultVariants:l}=t,i=Object.keys(n).map(e=>{let t=null==r?void 0:r[e],s=null==l?void 0:l[e];if(null===t)return null;let o=a(t)||a(s);return n[e][o]}),d=r&&Object.entries(r).reduce((e,t)=>{let[r,s]=t;return void 0===s||(e[r]=s),e},{});return o(e,i,null==t?void 0:null===(s=t.compoundVariants)||void 0===s?void 0:s.reduce((e,t)=>{let{class:r,className:s,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...l,...d}[t]):({...l,...d})[t]===r})?[...e,r,s]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44877:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var s=r(60687),a=r(43210),o=r(99208),n=r(16189),l=r(25324),i=r(11860),d=r(12941);let c=(0,r(62688).A)("mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);var m=r(27900),p=r(78200);r(96834);var u=r(60118),h=r(53234);function x(){let{data:e}=(0,o.wV)(),t=(0,n.usePathname)(),[x,g]=(0,a.useState)("hongkong"),y=t?.split("/")||[],b="zh-CN"===y[1]||"zh-TW"===y[1]?y[1]:"zh-TW",[f,v]=(0,a.useState)(b),[w,j]=(0,a.useState)([]),[N,k]=(0,a.useState)(""),[S,C]=(0,a.useState)(!1),[P,T]=(0,a.useState)(""),[E,D]=(0,a.useState)(!1),I=(0,a.useRef)(null),[A,U]=(0,a.useState)(!1),[F,B]=(0,a.useState)(!1),[$,R]=(0,a.useState)(""),[L,_]=(0,a.useState)(!1),[z,q]=(0,a.useState)(""),[O,M]=(0,a.useState)(""),[W,G]=(0,a.useState)(""),[H,V]=(0,a.useState)([]),[Z,Q]=(0,a.useState)(""),[K,J]=(0,a.useState)(!1),[Y,X]=(0,a.useState)(!1),[ee,et]=(0,a.useState)(!0),[er,es]=(0,a.useState)(!1),ea=async()=>{if(!N.trim()||S)return;if(ee&&et(!1),console.log("\uD83D\uDD0D Before checking couple analysis - isCoupleAnalysis:",L,"inputMessage:",N.trim()),L&&"1"===N.trim()){console.log("\uD83C\uDFAF Couple analysis option 1 selected - redirecting directly to couple payment");let e={role:"user",content:N.trim(),timestamp:new Date};j(t=>[...t,e]),k("");let t={role:"assistant",content:"太好了！正在為您處理情侶合盤分析付款...",timestamp:new Date};j(e=>[...e,t]);let s=W||O||$||"感情關係和諧改善建議";try{C(!0);let e=localStorage.getItem("userRegion"),t={china:"zh-CN",hongkong:"zh-TW",taiwan:"zh-TW"}[e]||f;console.log("\uD83D\uDCB3 Couple payment - Using fresh locale:",t,"from stored region:",e);let a=await fetch("/api/payment-couple",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({locale:t,specificProblem:s,concern:$,fromChat:!0,sessionId:P})});if(a.ok){let e=await a.json();if(console.log("\uD83D\uDCB3 Couple Payment Response:",e),e.sessionId){let t="pk_test_51RTB0lECl1ZAgMvGTBBmWjK7BWeZBVkBEVVvUj4P14T67Z0WTHI9y0k6ZUDZQtOnQbBhd0B21CaXML5b5q4dN7q800qwxStuQU";if(!t)throw Error("Stripe public key not configured");let s=await r.e(9010).then(r.bind(r,39010)).then(e=>e.loadStripe(t));if(s)console.log("\uD83D\uDE80 Redirecting to Stripe checkout for couple payment"),await s.redirectToCheckout({sessionId:e.sessionId});else throw Error("Failed to load Stripe")}else throw Error("No session ID received from couple payment")}else throw Error(`Payment API error: ${a.status}`)}catch(t){console.error("\uD83D\uDCB3 Couple payment error:",t),C(!1);let e={role:"assistant",content:"抱歉，付款處理時發生錯誤，請稍後再試。",timestamp:new Date};j(t=>[...t,e])}return}let e={role:"user",content:N.trim(),timestamp:new Date};j(t=>[...t,e]),k(""),C(!0);try{let s=await fetch("/api/smart-chat2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e.content,sessionId:P,userId:Z})}),a=await s.json();if(console.log("\uD83D\uDD0D 完整 API 回應:",a),console.log("\uD83D\uDD0D data.specificProblem:",a.specificProblem),console.log("\uD83D\uDD0D data.concern:",a.concern),s.ok){let e={role:"assistant",content:a.response,timestamp:new Date,aiAnalysis:a.aiAnalysis,systemType:a.systemType};if(j(t=>[...t,e]),console.log("\uD83D\uDD0D 檢查 Payment 觸發條件:",a.needsBirthdayInfo,a.shouldTriggerModal,"isCoupleAnalysis:",a.isCoupleAnalysis),(a.hasCouplesBirthdays||a.isCoupleAnalysis)&&(console.log("\uD83C\uDFAF Setting couple analysis to true due to couple birthdays detected"),_(!0)),a.needsBirthdayInfo||a.shouldTriggerModal){let e;B(!0),R(a.concern||""),q(a.reportType||""),console.log("\uD83D\uDD14 檢查 API 回應中的 specificProblem:",a.specificProblem);let s="";a.specificProblem&&(G(a.specificProblem),console.log("\uD83D\uDCBE 更新最新具體問題:",a.specificProblem),O||(M(a.specificProblem),console.log("\uD83D\uDCDD 設置原始問題:",a.specificProblem)),s=a.specificProblem),console.log("\uD83D\uDCB3 直接觸發付款 - concern:",a.concern,"problem:",s),console.log("\uD83D\uDCB3 檢查付款類型 - paymentType:",a.paymentType,"concern:",a.concern,"problem:",s);let o="comprehensive"===a.paymentType,n="premium"===a.paymentType;e=o?"/api/checkoutSessions/payment4":n?"/api/checkoutSessions/payment2":"/api/payment-fortune",console.log(`💳 使用付款端點: ${e} (comprehensive: ${o}, premium: ${n})`);try{let l;if(C(!0),o||n)l=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantity:1,directPayment:!0})});else{let r={財運:"financial",健康:"health",事業:"career",工作:"career",感情:"love"}[a.concern]||"financial",o=localStorage.getItem("userRegion"),n={china:"zh-CN",hongkong:"zh-TW",taiwan:"zh-TW"},i=n[o]||f;console.log("\uD83D\uDD25\uD83D\uDD25\uD83D\uDD25 INDIVIDUAL PAYMENT LOCALE DEBUG \uD83D\uDD25\uD83D\uDD25\uD83D\uDD25"),console.log("\uD83D\uDCB0 About to call fortune payment with locale:",i),console.log("\uD83D\uDD0D All locale variables:"),console.log("   - userRegion (state):",x),console.log("   - currentLocale (state):",f),console.log("   - storedRegion (localStorage):",o),console.log("   - freshLocale (calculated):",i),console.log("   - pathname:",t),console.log("   - regionToLocaleMap:",n),console.log("\uD83D\uDD25\uD83D\uDD25\uD83D\uDD25 END INDIVIDUAL PAYMENT DEBUG \uD83D\uDD25\uD83D\uDD25\uD83D\uDD25");let d={concern:r,specificProblem:s,fromChat:!0,locale:i};console.log("\uD83D\uDCE4 INDIVIDUAL PAYMENT REQUEST PAYLOAD:",d),l=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})}if(l.ok){let e=await l.json();if(console.log(`💳 ${o?"Expert88 ($88)":n?"Premium ($188)":"Fortune ($38)"} Payment Response:`,e),o||n){if(e.data?.url)window.location.href=e.data.url;else throw Error(`No checkout URL received from ${n?"Premium":"Expert88"} payment`)}else if(e.sessionId){let t="pk_test_51RTB0lECl1ZAgMvGTBBmWjK7BWeZBVkBEVVvUj4P14T67Z0WTHI9y0k6ZUDZQtOnQbBhd0B21CaXML5b5q4dN7q800qwxStuQU";if(!t)throw Error("Stripe public key not configured");let s=await r.e(9010).then(r.bind(r,39010)).then(e=>e.loadStripe(t));if(s)await s.redirectToCheckout({sessionId:e.sessionId});else throw Error("Failed to load Stripe")}else throw Error("No session ID received from Fortune payment")}else{let e=await l.json();throw Error(e.error||"Payment error")}}catch(e){console.error(`💳 ${o?"Comprehensive ($88)":n?"Premium ($188)":"Fortune ($38)"} payment error:`,e),C(!1),j(e=>[...e,{role:"assistant",content:"抱歉，付款過程中出現錯誤。請稍後再試。",timestamp:new Date,isError:!0}])}}}else throw Error(a.error||"請求失敗")}catch(t){console.error("發送訊息失敗:",t);let e={role:"assistant",content:"抱歉，發送訊息時出現錯誤。請稍後再試。",timestamp:new Date,isError:!0};j(t=>[...t,e])}finally{C(!1)}},eo=e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),ea())},en=e=>{k(e),setTimeout(()=>{let e=document.querySelector("textarea");e&&e.focus()},100)},el=async e=>{if(U(!1),C(!0),console.log("\uD83D\uDD25 Birthday submit received:",e),e.isCoupleAnalysis||L){console.log("\uD83D\uDCCA Couple analysis detected, generating report URL...");let t=W||O||$||"感情關係和諧改善建議";console.log("\uD83D\uDD0D DEBUG - URL生成時的狀態檢查:"),console.log("   latestSpecificProblem:",W),console.log("   originalUserQuestion:",O),console.log("   concern:",$),console.log("   problemToUse:",t);let r=`/couple-report?birthday=${encodeURIComponent(e.userBirthday)}&birthday2=${encodeURIComponent(e.partnerBirthday)}&gender=${encodeURIComponent(e.userGender)}&gender2=${encodeURIComponent(e.partnerGender)}&concern=${encodeURIComponent($)}&originalProblem=${encodeURIComponent(t)}&reportType=${encodeURIComponent(z)}`;console.log("\uD83D\uDE80 Opening couple report:",r),window.open(r,"_blank"),C(!1);return}try{let t=await fetch("/api/smart-chat2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userBirthday:e.birthday,gender:e.gender,partnerBirthday:e.partnerBirthday,partnerGender:e.partnerGender,concern:$,isCoupleAnalysis:L||e.isCoupleAnalysis,reportType:z,messageType:"birthday_submission",sessionId:P,userId:Z})});if(!t.ok)throw Error(`HTTP error! status: ${t.status}`);let r=await t.json(),s={role:"assistant",content:r.response||r.message,timestamp:new Date,aiAnalysis:r.aiAnalysis,systemType:r.systemType};j(e=>[...e,s]),r.reportUrl&&(console.log("Opening report:",r.reportUrl),window.open(r.reportUrl,"_blank"))}catch(e){console.error("生日提交錯誤:",e),j(e=>[...e,{role:"assistant",content:"抱歉，處理生日資料時發生錯誤。請稍後再試。",timestamp:new Date}])}finally{C(!1)}},ei=async e=>{try{C(!0);let t=await fetch(`/api/load-conversation?conversationId=${encodeURIComponent(e)}`);if(t.ok){let r=await t.json();if(r.conversation&&Array.isArray(r.conversation)&&r.conversation.length>0){let e=r.conversation.map((e,t)=>({role:e.role,content:e.content||"",timestamp:new Date(e.timestamp),aiAnalysis:e.aiAnalysis||null,systemType:e.systemType||"smart-chat2",id:e.id||`loaded-${t}`}));e.some(e=>"assistant"===e.role&&e.content.includes("歡迎來到智能風水顧問"))||e.unshift({role:"assistant",content:"你好呀～我是風水妹！✨ 歡迎回到智能風水顧問 Smart-Chat2 (AI版)！\n\n繼續您之前的對話...",timestamp:new Date(r.metadata?.createdAt||Date.now()),aiAnalysis:null,systemType:"smart-chat2"}),j(e),et(!1)}else j([{role:"assistant",content:"你好呀～我是風水妹！✨ 歡迎來到智能風水顧問 Smart-Chat2 (AI版)！\n\n這是您之前的對話，請繼續...",timestamp:new Date,aiAnalysis:null,systemType:"smart-chat2"}]),et(!1);if(r.metadata){let e=r.metadata;T(e.sessionId||`smart-chat2-${Date.now()}`),R(e.primaryConcern||""),_(e.userData?.relationshipType==="couple"),q("")}console.log("對話加載成功:",r.metadata?.title||e)}else console.error("加載對話失敗:",t.statusText),j([{role:"assistant",content:"抱歉，無法加載該對話記錄。請嘗試創建新對話。",timestamp:new Date,isError:!0}])}catch(e){console.error("加載對話錯誤:",e),j([{role:"assistant",content:"載入對話時發生錯誤，請稍後再試。",timestamp:new Date,isError:!0}])}finally{C(!1)}},ed=e=>{if(!e)return"";let t=new Date(e),r=(new Date-t)/36e5;if(r<24)return t.toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit"});if(!(r<168))return t.toLocaleDateString("zh-TW",{month:"short",day:"numeric"});{let e=Math.floor(r/24);return`${e}天前`}};return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-indigo-50",children:[(0,s.jsx)(h.default,{backgroundColor:"EFEFEF"}),(0,s.jsxs)("div",{className:"relative flex h-screen mt-16",children:[(0,s.jsx)("button",{className:"fixed z-50 p-2 bg-white rounded-lg shadow-lg md:hidden top-4 left-4",onClick:()=>es(!er),children:er?(0,s.jsx)(i.A,{className:"w-6 h-6 text-gray-600"}):(0,s.jsx)(d.A,{className:"w-6 h-6 text-gray-600"})}),(0,s.jsxs)("div",{className:`
					${er?"translate-x-0":"-translate-x-full"}
					md:translate-x-0 transition-transform duration-300 ease-in-out
					fixed md:relative z-40 w-80 md:w-80 bg-[#EFEFEF] flex flex-col h-full
				`,children:[(0,s.jsx)("div",{className:"bg-[#E0E0E0] rounded-lg m-4 p-4 cursor-pointer hover:bg-[#d0d0d0] transition-colors",onClick:()=>{j([]),k(""),R(""),_(!1),q(""),T(`smart-chat2-${Date.now()}`),et(!0)},children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("img",{src:"/images/風水妹/風水妹.png",alt:"風水妹",className:"w-10 h-10 rounded-full",onError:e=>{e.target.style.display="none"}}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("span",{className:"font-medium text-gray-800",children:"建立新的對話"})}),(0,s.jsx)("div",{className:"text-xl text-gray-800",children:"+"})]})}),(0,s.jsxs)("div",{className:"bg-[#E0E0E0] rounded-lg mx-4 mb-4",children:[(0,s.jsx)("div",{className:"p-4 border-b border-[#d0d0d0]",children:(0,s.jsxs)("h3",{className:"flex items-center justify-between font-medium text-gray-800",children:["歷史對話",K&&(0,s.jsx)("div",{className:"w-4 h-4 border-b-2 border-gray-800 rounded-full animate-spin"})]})}),(0,s.jsx)("div",{className:"p-2 overflow-y-auto max-h-48",children:0===H.length?(0,s.jsx)("div",{className:"p-3 text-sm text-center text-gray-600",children:K?"載入中...":"尚無歷史對話"}):H.map(e=>(0,s.jsxs)("div",{className:"p-3 hover:bg-[#d0d0d0] rounded cursor-pointer transition-colors mb-1",onClick:()=>ei(e.conversationId),children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-800 truncate",children:e.title||"未命名對話"}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-1 text-xs text-gray-600",children:[(0,s.jsx)("span",{children:ed(e.lastUpdated)}),(0,s.jsx)("span",{className:"bg-[#d0d0d0] text-gray-800 px-2 py-0.5 rounded-full text-xs",children:e.messageCount||0})]}),e.topics&&e.topics.length>0&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[e.topics.slice(0,2).map((e,t)=>(0,s.jsx)("span",{className:"text-xs bg-[#c0c0c0] text-gray-800 px-2 py-0.5 rounded",children:e},t)),e.topics.length>2&&(0,s.jsxs)("span",{className:"text-xs text-gray-600",children:["+",e.topics.length-2]})]})]},e.conversationId))})]}),(0,s.jsx)("div",{className:"px-4 mb-4",children:(0,s.jsx)("div",{className:"p-4 transition-colors bg-white border border-gray-200 rounded-full shadow-sm cursor-pointer hover:bg-gray-50",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"font-medium text-gray-800",children:"付費報告預覽"}),(0,s.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-gray-100 rounded-full",children:(0,s.jsxs)("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})})}),(0,s.jsxs)("div",{className:"flex-1 px-4 pb-4 space-y-3 overflow-y-auto",children:[(0,s.jsx)(l.N_,{href:"/demo?category=fengshui",children:(0,s.jsx)("div",{className:"bg-[#768976] rounded-lg py-7 mb-3 cursor-pointer hover:bg-[#6b7d6b] transition-colors relative overflow-hidden",style:{backgroundImage:"url(/images/chatbox/house.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}})}),(0,s.jsx)(l.N_,{href:"/demo?category=life",children:(0,s.jsx)("div",{className:"bg-[#768976] rounded-lg py-7 mb-3 cursor-pointer hover:bg-[#6b7d6b] transition-colors relative overflow-hidden",style:{backgroundImage:"url(/images/chatbox/life.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}})}),(0,s.jsx)(l.N_,{href:"/demo?category=relationship",children:(0,s.jsx)("div",{className:"bg-[#768976] rounded-lg py-7 mb-3 cursor-pointer hover:bg-[#6b7d6b] transition-colors relative overflow-hidden",style:{backgroundImage:"url(/images/chatbox/relationship.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}})}),(0,s.jsx)(l.N_,{href:"/demo?category=career",children:(0,s.jsx)("div",{className:"bg-[#768976] rounded-lg py-7 mb-3 cursor-pointer hover:bg-[#6b7d6b] transition-colors relative overflow-hidden",style:{backgroundImage:"url(/images/chatbox/career.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}})}),(0,s.jsx)(l.N_,{href:"/demo?category=wealth",children:(0,s.jsx)("div",{className:"bg-[#768976] rounded-lg py-7 mb-3 cursor-pointer hover:bg-[#6b7d6b] transition-colors relative overflow-hidden",style:{backgroundImage:"url(/images/chatbox/wealth.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}})}),(0,s.jsx)(l.N_,{href:"/demo?category=health",children:(0,s.jsx)("div",{className:"bg-[#768976] rounded-lg py-7 mb-3 cursor-pointer hover:bg-[#6b7d6b] transition-colors relative overflow-hidden",style:{backgroundImage:"url(/images/chatbox/health.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}})})]})]}),er&&(0,s.jsx)("div",{className:"fixed inset-0 z-30 bg-black bg-opacity-50 md:hidden",onClick:()=>es(!1)}),(0,s.jsx)("div",{className:"flex flex-col flex-1 md:ml-0",style:{backgroundColor:"#EFEFEF",backgroundImage:"url(/images/report/housing-report-bg.png)",backgroundSize:"60%",backgroundPosition:"bottom right",backgroundRepeat:"no-repeat",boxShadow:"4px 4px 4px rgba(0, 0, 0, 0.25)",border:"3px solid #E0E0E0"},children:(0,s.jsxs)("div",{className:"flex flex-col flex-1 h-full",children:[(0,s.jsxs)("div",{className:"flex-1 p-4 md:p-6 space-y-4 overflow-y-auto max-h-[calc(100vh-8rem)] pt-16 md:pt-6",children:[ee?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center ",children:[(0,s.jsx)("img",{src:"/images/風水妹/風水妹.png",alt:"風水妹",className:" w-50 h-50 md:w-50 md:h-50",onError:e=>{e.target.style.display="none"}}),(0,s.jsx)("div",{className:"text-6xl font-bold md:text-6xl",style:{width:"280px",height:"60px",background:"linear-gradient(45deg, #A3B116, #374A37)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"serif"},children:"HarmoniQ"})]}),(0,s.jsx)("div",{className:"w-full max-w-2xl px-4 md:px-0",children:(0,s.jsxs)("div",{className:"flex items-center bg-white border border-gray-300 rounded-full shadow-lg",children:[(0,s.jsx)("textarea",{value:N,onChange:e=>k(e.target.value),onKeyPress:eo,placeholder:"請輸入訊息",className:"flex-1 px-4 py-3 text-sm text-black placeholder-gray-500 bg-transparent resize-none md:px-6 md:py-4 md:text-base focus:outline-none",rows:1,disabled:S}),(0,s.jsxs)("div",{className:"flex items-center px-3 space-x-1 md:px-4 md:space-x-2",children:[(0,s.jsx)("button",{className:"p-1.5 md:p-2 text-gray-400 transition-colors hover:text-gray-600",children:(0,s.jsx)(c,{className:"w-4 h-4 md:w-5 md:h-5"})}),(0,s.jsx)("button",{onClick:ea,disabled:!N.trim()||S,className:"p-1.5 md:p-2 text-purple-600 transition-colors hover:text-purple-700 disabled:text-gray-300 disabled:cursor-not-allowed",children:(0,s.jsx)(m.A,{className:"w-4 h-4 md:w-5 md:h-5"})})]})]})}),(0,s.jsxs)("div",{className:"flex flex-wrap justify-center gap-2 px-4 mt-5 md:gap-3 md:px-0",children:[(0,s.jsxs)("button",{onClick:()=>en("健康運勢"),className:"flex items-center px-4 py-2 space-x-2 text-xs font-medium text-gray-700 transition-shadow bg-white border border-gray-200 rounded-full shadow-md md:px-6 md:py-3 md:text-sm hover:shadow-lg hover:text-gray-900",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-6 h-6 bg-green-100 rounded-full",children:(0,s.jsx)("span",{className:"text-sm text-green-600",children:"\uD83C\uDF43"})}),(0,s.jsx)("span",{children:"健康運勢"})]}),(0,s.jsxs)("button",{onClick:()=>en("感情運勢"),className:"flex items-center px-4 py-2 space-x-2 text-xs font-medium text-gray-700 transition-shadow bg-white border border-gray-200 rounded-full shadow-md md:px-6 md:py-3 md:text-sm hover:shadow-lg hover:text-gray-900",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-6 h-6 bg-pink-100 rounded-full",children:(0,s.jsx)("span",{className:"text-sm text-pink-600",children:"\uD83C\uDF38"})}),(0,s.jsx)("span",{children:"感情運勢"})]}),(0,s.jsxs)("button",{onClick:()=>en("財運運勢"),className:"flex items-center px-4 py-2 space-x-2 text-xs font-medium text-gray-700 transition-shadow bg-white border border-gray-200 rounded-full shadow-md md:px-6 md:py-3 md:text-sm hover:shadow-lg hover:text-gray-900",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-6 h-6 bg-yellow-100 rounded-full",children:(0,s.jsx)("span",{className:"text-sm text-yellow-600",children:"\uD83D\uDCB0"})}),(0,s.jsx)("span",{children:"財運運勢"})]}),(0,s.jsxs)("button",{onClick:()=>en("事業運勢"),className:"flex items-center px-4 py-2 space-x-2 text-xs font-medium text-gray-700 transition-shadow bg-white border border-gray-200 rounded-full shadow-md md:px-6 md:py-3 md:text-sm hover:shadow-lg hover:text-gray-900",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-6 h-6 bg-blue-100 rounded-full",children:(0,s.jsx)("span",{className:"text-sm text-blue-600",children:"\uD83D\uDCBC"})}),(0,s.jsx)("span",{children:"事業運勢"})]})]})]}):w.map((e,t)=>(0,s.jsx)("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:"user"===e.role?(0,s.jsx)("div",{className:"max-w-[85%] md:max-w-[70%] p-3 md:p-4 rounded-2xl shadow-md",style:{backgroundColor:"#CFE117"},children:(0,s.jsx)("div",{className:"text-sm font-medium text-black",children:e.content||""})}):(0,s.jsxs)("div",{className:"max-w-[95%] md:max-w-[90%] bg-white rounded-2xl shadow-md border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center p-3 md:p-4",children:[(0,s.jsx)("img",{src:"/images/風水妹/風水妹.png",alt:"風水妹",className:"w-10 h-10 mr-2 rounded-full md:w-12 md:h-12 md:mr-3",onError:e=>{e.target.style.display="none"}}),(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-sm font-medium text-black md:text-base",children:"風水妹"})})]}),(0,s.jsx)("div",{className:"px-3 pb-2 md:px-4",children:(0,s.jsx)("div",{className:"text-sm leading-relaxed text-black whitespace-pre-wrap",children:e.content||""})}),(0,s.jsx)("div",{className:"px-3 pb-2 md:px-4 md:pb-3",children:(0,s.jsx)("div",{className:"text-xs text-gray-500",children:E?(()=>{let t=new Date(e.timestamp),r=t.getHours().toString().padStart(2,"0"),s=t.getMinutes().toString().padStart(2,"0"),a=t.getSeconds().toString().padStart(2,"0");return`${r}:${s}:${a}`})():"--:--:--"})})]})},t)),S&&(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsxs)("div",{className:"bg-white border border-gray-200 shadow-md rounded-2xl",children:[(0,s.jsxs)("div",{className:"flex items-center p-3 md:p-4",children:[(0,s.jsx)("img",{src:"/images/風水妹/風水妹.png",alt:"風水妹",className:"w-10 h-10 mr-2 rounded-full md:w-12 md:h-12 md:mr-3",onError:e=>{e.target.style.display="none"}}),(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"font-medium text-black",children:"風水妹"})})]}),(0,s.jsx)("div",{className:"px-3 pb-3 md:px-4 md:pb-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-sm text-black",children:"風水妹費神運算中"}),(0,s.jsx)(p.A,{className:"w-4 h-4 text-purple-600 animate-pulse"}),(0,s.jsxs)("div",{className:"flex space-x-1",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce"}),(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,s.jsx)("div",{className:"w-2 h-2 bg-pink-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})]})}),(0,s.jsx)("div",{ref:I})]}),!ee&&(0,s.jsx)("div",{className:"flex-shrink-0 p-3 border-t border-gray-200 md:p-4 ",children:(0,s.jsxs)("div",{className:"flex items-center bg-white border border-gray-200 rounded-full shadow-lg",children:[(0,s.jsx)("textarea",{value:N,onChange:e=>k(e.target.value),onKeyPress:eo,placeholder:"輸入任何問題，風水妹會分析並引導你...",className:"flex-1 px-4 py-2 text-sm text-black placeholder-gray-500 bg-transparent resize-none md:px-6 md:py-3 md:text-base focus:outline-none",rows:1,disabled:S}),(0,s.jsx)("div",{className:"flex items-center px-3 space-x-1 md:px-4 md:space-x-2",children:(0,s.jsx)("button",{onClick:ea,disabled:!N.trim()||S,className:"p-1.5 md:p-2 text-purple-600 transition-colors hover:text-purple-700 disabled:text-gray-300 disabled:cursor-not-allowed",children:(0,s.jsx)(m.A,{className:"w-4 h-4 md:w-5 md:h-5"})})})]})})]})})]}),A&&(0,s.jsx)(u.A,{isOpen:A,onClose:()=>U(!1),onSubmit:el,concern:$,isCoupleAnalysis:L,reportType:z})]})}},56829:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=r(65239),a=r(48088),o=r(88170),n=r.n(o),l=r(30893),i={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);r.d(t,i);let d={children:["",{children:["[locale]",{children:["smart-chat2",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,98092)),"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/[locale]/smart-chat2/page.jsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,11434)),"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/[locale]/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,66196)),"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/[locale]/error.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,54413)),"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/[locale]/smart-chat2/page.jsx"],m={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/[locale]/smart-chat2/page",pathname:"/[locale]/smart-chat2",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79060:(e,t,r)=>{Promise.resolve().then(r.bind(r,98092))},79551:e=>{"use strict";e.exports=require("url")},96834:(e,t,r)=>{"use strict";r(60687),r(43210);var s=r(24224);r(4780),(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-100 text-green-800 hover:bg-green-200",warning:"border-transparent bg-yellow-100 text-yellow-800 hover:bg-yellow-200",info:"border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"}},defaultVariants:{variant:"default"}})},98092:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/[locale]/smart-chat2/page.jsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/[locale]/smart-chat2/page.jsx","default")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[7719,7380,9916,7076,5127,6157,8491,6433,3234,5258],()=>r(56829));module.exports=s})();