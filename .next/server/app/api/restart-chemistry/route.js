(()=>{var e={};e.id=7342,e.ids=[7342],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},35702:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>h,routeModule:()=>c,serverHooks:()=>g,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>u});var a={};r.r(a),r.d(a,{POST:()=>p});var s=r(96559),n=r(48088),o=r(37719),i=r(32190);function l(e){try{let t=new Date(e),r=t.getFullYear(),a=t.getMonth()+1;t.getDate();let s=["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],n=["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],o=(r-4)%10,i=s[o]+n[(r-4)%12],l=s[(2*o+a)%10]+n[(a+1)%12],p=Math.floor(t.getTime()/864e5),c=s[(p+4)%10]+n[(p+4)%12];return{year:i,month:l,day:c,hour:"甲子"}}catch(e){return console.error("BaZi calculation error:",e),null}}async function p(e){try{let{femaleUser:t,maleUser:r,femaleBazi:a,maleBazi:s,requestType:n}=await e.json();if(!t||!r)return i.NextResponse.json({error:"Missing user data"},{status:400});let o=a||l(t.birthDate),p=s||l(r.birthDate);if(!o||!p)return i.NextResponse.json({error:"Failed to calculate BaZi data"},{status:400});let c=`
作為專業八字命理師，請為這對情侶提供「重啟默契」的破冰儀式建議。

女方八字：${o.year} ${o.month} ${o.day} ${o.hour}
男方八字：${p.year} ${p.month} ${p.day} ${p.hour}

請提供3個破冰儀式建議，針對能量沉寂的核心問題：

格式要求：
1. 每個儀式需要：
   - 儀式名稱（活潑有趣）
   - 3個具體執行步驟
   - 八字原理說明（連結五行元素，如金生水補能量）

2. 最後提供一般溝通建議（增加共同活動、調整表達方式等）

要求：
- 儀式要有趣實用，容易執行
- 說明五行相生相剋原理
- 內容生動活潑，避免說教
- 重點解決感情沉悶問題

請直接提供3個儀式建議：
`,d=await fetch("https://api.deepseek.com/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${process.env.DEEPSEEK_API_KEY}`},body:JSON.stringify({model:"deepseek-chat",messages:[{role:"system",content:"你是專業的八字命理師，擅長設計有趣的情侶互動儀式。回答要生動活潑、實用有效。"},{role:"user",content:c}],temperature:.8,max_tokens:1200})});if(!d.ok)throw Error(`DeepSeek API error: ${d.status}`);let u=await d.json(),g=u.choices?.[0]?.message?.content;if(!g)throw Error("No content received from AI");console.log("\uD83E\uDD16 Chemistry AI Response:",g),console.log("\uD83D\uDCCA BaZi data before parsing:",{femaleBaziData:o,maleBaziData:p});let h=function(e,t,r){try{let a,s,n,o,i,l;if(!e||"string"!=typeof e)return console.log("⚠️ Invalid content provided to chemistry parser"),null;console.log("\uD83D\uDD0D Parsing chemistry content:",e.substring(0,200)+"..."),console.log("\uD83D\uDD0D BaZi Data Check:",{femaleBaziData:t,maleBaziData:r,femaleDataType:typeof t,maleDataType:typeof r}),t&&"object"==typeof t?(a=t.year||t.yearPillar||"甲子",n=t.day||t.dayPillar||"丙寅",i=t.month||t.monthPillar||"戊辰"):(a="甲子",n="丙寅",i="戊辰"),r&&"object"==typeof r?(s=r.year||r.yearPillar||"乙丑",o=r.day||r.dayPillar||"丁卯",l=r.month||r.monthPillar||"己巳"):(s="乙丑",o="丁卯",l="己巳"),console.log("✅ Extracted BaZi:",{femaleYear:a,maleYear:s,femaleDay:n,maleDay:o,femaleMonth:i,maleMonth:l});let p=[{title:"雙人能量流轉茶會",steps:["選擇帶有花香（木元素）的茶葉，搭配紅色茶具（火元素）","在客廳東南方位佈置溫馨茶席，點燃暖色蠟燭","泡茶時輪流分享當天最溫暖的一個時刻"],principle:`根據你們的八字分析，${a}年與${s}年的五行配置，需要木生火的能量流轉來化解沉寂`,gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"五行音波共振舞",steps:["女方選金屬音質（鐘聲/鋼琴曲），男方選水屬性音樂（流水聲）","交叉播放不同元素音樂，隨音樂自由擺動身體","每首歌結束後擁抱10秒，感受彼此能量"],principle:`以金生水→水生木的循環，針對你們八字中的${n}日與${o}日柱進行能量調和`,gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"星光願力投射劇場",steps:["用暖黃燈光（火）與陶土燭台（土）佈置陽台或房間","準備願景便利貼，各自寫下對未來3個月的期待","輪流演出自己的願景，另一人扮演支持者角色"],principle:`運用火土相生破解你們八字中水過旺的懷舊傾向，${i}月與${l}月柱需要暖土穩定`,gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"}],c=`基於你們的八字配置分析，建議增加「元素體驗日」活動（週一金屬日一起烹飪、週三木日公園野餐），調整表達方式為「火元素表達法」—說話前先微笑3秒，將抱怨轉為「我希望我們可以...」的正向表達。每日進行「五行擊掌」儀式，按金木水火土順序擊掌五次，幫助你們的能量完整流動，重建默契與和諧。`;return{iceBreakers:p,generalAdvice:c}}catch(e){return console.error("Chemistry parsing error:",e),null}}(g,o,p);if(console.log("\uD83D\uDCCA Chemistry Parsed Data:",h),!h)return i.NextResponse.json({iceBreakers:[{title:"夜晚心情分享儀式",steps:["每晚睡前設定15分鐘分享時間","輪流分享當天最印象深刻的事情","用心聆聽，給予溫暖回應"],principle:"金水相生，促進情感流動，增強心靈連結",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"週末探險計劃",steps:["每週挑選一個新的地點或活動","輪流負責規劃和安排行程","記錄美好時光和新發現"],principle:"木火相助，激發關係活力和新鮮感",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"},{title:"感謝表達練習",steps:["每天找一個具體行為表達感謝","用「因為你...我感到...」的句式","寫在小紙條上互相交換"],principle:"土金相生，穩固感情基礎，增進相互欣賞",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"}],generalAdvice:"建議雙方增加日常的溫暖互動，如共同做飯、散步聊天，調整溝通方式避免過於直接或冷漠，多表達內心真實感受，營造和諧包容的關係氛圍。"});return i.NextResponse.json(h)}catch(e){return console.error("Restart Chemistry API error:",e),i.NextResponse.json({iceBreakers:[{title:"生成建議中",steps:["正在分析您的八字配置","生成個人化破冰儀式","請稍候片刻"],principle:"系統正在運算中...",gradient:"linear-gradient(135deg, #C74772 0%, #D09900 100%)"}],generalAdvice:"系統正在為您生成個人化的重啟默契建議，請稍後..."},{status:200})}}let c=new s.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/restart-chemistry/route",pathname:"/api/restart-chemistry",filename:"route",bundlePath:"app/api/restart-chemistry/route"},resolvedPagePath:"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/api/restart-chemistry/route.js",nextConfigOutput:"",userland:a}),{workAsyncStorage:d,workUnitAsyncStorage:u,serverHooks:g}=c;function h(){return(0,o.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:u})}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[7719,580],()=>r(35702));module.exports=a})();