(()=>{var e={};e.id=5389,e.ids=[5389],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8355:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>f,routeModule:()=>p,serverHooks:()=>g,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>m});var n={};r.r(n),r.d(n,{POST:()=>u});var o=r(96559),s=r(48088),i=r(37719),a=r(32190),l=r(51367);let c=process.env.DEEPSEEK_API_KEY;async function u(e){let t=Math.random().toString(36).substring(2,15),r=null,n=null,o=null;try{let s;let i=await e.text();if(!i)return console.error("Empty request body received"),a.NextResponse.json({error:"Empty request body"},{status:400});try{s=JSON.parse(i)}catch(e){return console.error("JSON parse error:",e.message,"Body:",i),a.NextResponse.json({error:"Invalid JSON in request body"},{status:400})}let{pillar:u,userInfo:p}=s;if(!u||!p)return a.NextResponse.json({error:"Missing required parameters: pillar or userInfo"},{status:400});r=(0,l.hz)("interpersonal-advice",p,{pillar:u}),console.log(`[${t}] Cache key: ${r}`);let d=(0,l.I7)(r,t);if(d)return a.NextResponse.json(d);let m=await (0,l.Xu)(r,t);if(m)return a.NextResponse.json(m);let g=(0,l.NG)(r,t);n=g.resolvePending,o=g.rejectPending;let f=`你是資深的八字命理師，需要根據用戶的${u}信息，提供人際關係調和的重點建議。

用戶信息：
- 姓名：${p.name}
- 性別：${"male"===p.gender?"男":"女"}
- 出生日期：${p.birthDate}
- 出生時間：${p.birthTime}
- 出生地點：${p.location}
- ${u}：${u}相關的命理信息

請從以下角度提供人際關係調和建議：

1. **人際特質分析**
   - 分析此人在人際關係中的天賦優勢
   - 指出容易遇到的人際挑戰

2. **溝通風格建議**
   - 如何改善溝通技巧
   - 適合的溝通方式和注意事項

3. **關係維護要點**
   - 如何建立良好的人際關係
   - 維護長期關係的關鍵

4. **化解衝突方法**
   - 面對人際衝突時的處理策略
   - 預防關係惡化的方法

請以溫暖、實用的語調提供建議，每個要點都要具體且可執行。
返回格式必須是純JSON，包含以下結構：
{
    "personalTraits": "人際特質分析",
    "communicationStyle": "溝通風格建議", 
    "relationshipMaintenance": "關係維護要點",
    "conflictResolution": "化解衝突方法"
}`;try{let e;let o=await fetch("https://api.deepseek.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({model:"deepseek-chat",messages:[{role:"user",content:f}],temperature:.7,max_tokens:1e3})});if(!o.ok)throw Error(`DeepSeek API error: ${o.status}`);let s=await o.json(),i=s.choices[0]?.message?.content;if(!i)throw Error("No content received from DeepSeek API");let u=i;i.includes("```json")?u=i.replace(/```json\s*/g,"").replace(/\s*```/g,""):i.includes("```")&&(u=i.replace(/```\s*/g,"").replace(/\s*```/g,""));try{e=JSON.parse(u)}catch(e){throw console.error("Error parsing AI response:",e),console.error("Raw content:",i),console.error("Cleaned content:",u),Error("Invalid JSON response from AI")}for(let t of["personalTraits","communicationStyle","relationshipMaintenance","conflictResolution"])if(!e[t])throw Error(`Missing required field: ${t}`);let p={success:!0,analysis:e,requestId:t,aiGenerated:!0,timestamp:new Date().toISOString()};return(0,l.e0)(r,p,t),(0,l.dV)(r,p,t,n),a.NextResponse.json(p)}catch(t){console.error("AI API Error:",t);let e={年柱:{personalTraits:"年柱反映了您早期的人際特質，天生具有親和力，容易獲得他人信任。在人際關係中展現出純真和熱情，但有時可能過於直接，需要學習更多的人際技巧。",communicationStyle:"建議在溝通時保持真誠，但要學會察言觀色。避免過於衝動的表達，多聽少說，給對方充分的表達空間。在重要場合前先思考再開口。",relationshipMaintenance:"重視情感交流，定期與朋友家人聯繫。學會記住他人的重要日子，適時表達關心。建立互相支持的友誼圈，但要保持適當的界限。",conflictResolution:"面對衝突時，先冷靜下來，避免情緒化的反應。學會換位思考，理解對方的立場。用溫和但堅定的態度表達自己的觀點，尋求雙贏的解決方案。"},月柱:{personalTraits:"月柱顯示您在青年時期的人際發展，善於與同輩建立關係，具有團隊合作精神。在群體中能發揮協調作用，但有時可能會過於在意他人看法。",communicationStyle:"適合採用平等、開放的溝通方式。善於傾聽和回應，但要注意表達自己的真實想法。避免為了迎合他人而失去自我，保持適度的主見。",relationshipMaintenance:"注重友情的深度發展，喜歡與志同道合的人建立長期關係。定期組織聚會或活動，維繫友誼。學會在給予和接受之間保持平衡。",conflictResolution:"擅長調解他人之間的矛盾，但面對自己的衝突時可能會退縮。學會勇於面對問題，用理性和感性並重的方式處理分歧。"},日柱:{personalTraits:"日柱代表您的核心人際特質，展現出成熟穩重的交往風格。能夠承擔責任，在人際關係中扮演重要角色，但有時可能承受過多壓力。",communicationStyle:"溝通風格較為直接和實用，重視效率和結果。建議增加一些情感表達，讓溝通更有溫度。學會在正式和輕鬆的語調之間切換。",relationshipMaintenance:"重視長期穩定的關係，願意為重要的人付出時間和精力。建議定期檢視人際關係品質，及時修復可能出現的裂痕。",conflictResolution:"面對衝突時比較理性，能夠客觀分析問題。但要避免過於冷漠，適時表達情感和理解。學會在堅持原則的同時保持彈性。"},時柱:{personalTraits:"時柱反映了您晚年的人際智慧，具有豐富的人生閱歷和包容心。善於給予他人指導和支持，在人際關係中扮演長者和智者的角色。",communicationStyle:"溝通時展現出智慧和耐心，善於用故事和比喻來傳達觀點。建議保持開放的心態，不要過於固執己見，尊重年輕一代的想法。",relationshipMaintenance:"重視家庭和傳統的人際網絡，善於維繫跨代關係。學會在傳統和現代之間找到平衡，與不同年齡層的人建立良好關係。",conflictResolution:"具有化解矛盾的智慧，能夠從更高的角度看待問題。建議發揮調解者的作用，幫助他人解決分歧，同時也要照顧好自己的感受。"}};return a.NextResponse.json({success:!0,analysis:e[u]||e["日柱"]})}}catch(e){return console.error("API Error:",e),(0,l.ME)(r,e,t,o),a.NextResponse.json({error:"Internal server error"},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/interpersonal-advice/route",pathname:"/api/interpersonal-advice",filename:"route",bundlePath:"app/api/interpersonal-advice/route"},resolvedPagePath:"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/api/interpersonal-advice/route.js",nextConfigOutput:"",userland:n}),{workAsyncStorage:d,workUnitAsyncStorage:m,serverHooks:g}=p;function f(){return(0,i.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:m})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},51367:(e,t,r)=>{"use strict";r.d(t,{I7:()=>l,ME:()=>m,NG:()=>u,Xu:()=>c,dV:()=>d,e0:()=>p,hz:()=>i});let n=new Map,o=new Map,s={TTL:36e5,MAX_SIZE:1e3};function i(e,t,r={}){if(!t?.birthDateTime)return null;let n=new Date(t.birthDateTime),o=`${e}_${n.getFullYear()}_${n.getMonth()}_${n.getDate()}_${n.getHours()}_${t.gender||""}`,s=Object.keys(r).sort();return o+(s.length>0?"_"+s.map(e=>`${e}:${r[e]}`).join("_"):"")}function a(e){return Date.now()-e.timestamp>s.TTL}function l(e,t){if(!e||!n.has(e))return null;let r=n.get(e);return a(r)?(n.delete(e),console.log(`[${t}] 🗑️ Removed expired cache for ${e}`),null):(console.log(`[${t}] 🎯 RETURNING CACHED RESULT for ${e}`),{...r.data,cached:!0,requestId:t,originalRequestId:r.originalRequestId,cacheAge:Date.now()-r.timestamp})}async function c(e,t){if(!e||!o.has(e))return null;console.log(`[${t}] 🚨 REQUEST ALREADY PENDING for ${e}, waiting...`);try{let r=await o.get(e);return console.log(`[${t}] ✅ Got result from pending request`),{...r,waitedForResult:!0,requestId:t,originalRequestId:r.requestId}}catch(r){return console.log(`[${t}] ⚠️ Pending request failed, proceeding with new request`),o.delete(e),null}}function u(e,t){let r,n;if(!e)return{resolvePending:null,rejectPending:null};let s=new Promise((e,t)=>{r=e,n=t});return o.set(e,s),console.log(`[${t}] 🔄 Created pending request for ${e}`),{resolvePending:r,rejectPending:n}}function p(e,t,r){if(!e)return;n.size>.8*s.MAX_SIZE&&function(){for(let[e,t]of n.entries())a(t)&&n.delete(e);n.size>s.MAX_SIZE&&Array.from(n.entries()).sort((e,t)=>e[1].timestamp-t[1].timestamp).slice(0,n.size-s.MAX_SIZE).forEach(([e])=>n.delete(e))}();let o={data:t,timestamp:Date.now(),originalRequestId:t.requestId||r};n.set(e,o),console.log(`[${r}] ✅ CACHED result for ${e}`)}function d(e,t,r,n){e&&n&&(n(t),o.delete(e),console.log(`[${r}] ✅ Resolved pending promise for ${e}`))}function m(e,t,r,n){e&&n&&(n(t),o.delete(e),console.log(`[${r}] 🚨 Rejected pending promise for ${e}`))}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[7719,580],()=>r(8355));module.exports=n})();