(()=>{var e={};e.id=1661,e.ids=[1661],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},75472:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>C,routeModule:()=>d,serverHooks:()=>m,workAsyncStorage:()=>_,workUnitAsyncStorage:()=>h});var s={};t.r(s),t.d(s,{POST:()=>l});var o=t(96559),n=t(48088),c=t(37719),p=t(32190),i=t(97877),u=t(98870);let a=new i.A(process.env.STRIPE_SECRET_KEY);async function l(e){try{let{locale:r,specificProblem:t,concern:s,fromChat:o}=await e.json(),n=r||(0,u.y3)(e);console.log(`ðŸŒ Couple payment - Detected locale: ${n}`);let c=(0,u._j)(n,"couple");console.log(`ðŸ’° Couple payment - Using price ID: ${c} for couple ${n}`);let i=`${process.env.NEXTAUTH_URL}/${n}/success?session_id={CHECKOUT_SESSION_ID}&type=couple`;o&&(t||s)&&(t&&(i+=`&specificProblem=${encodeURIComponent(t)}`),s&&(i+=`&concern=${encodeURIComponent(s)}`),i+="&fromChat=true");let l=await a.checkout.sessions.create({payment_method_types:["card","wechat_pay","alipay"],payment_method_options:{wechat_pay:{client:"web"}},line_items:[{price:c,quantity:1}],mode:"payment",success_url:i,cancel_url:`${process.env.NEXTAUTH_URL}/${n}/price`,custom_text:{submit:{message:"zh-CN"===n?"å®Œæˆä»˜æ¬¾åŽï¼Œæ‚¨å°†æ”¶åˆ°ä¸“å±žçš„æƒ…ä¾£åˆç›˜åˆ†æžæŠ¥å‘Š":"å®Œæˆä»˜æ¬¾å¾Œï¼Œæ‚¨å°‡æ”¶åˆ°å°ˆå±¬çš„æƒ…ä¾¶åˆç›¤åˆ†æžå ±å‘Š"}},locale:"zh-CN"===n?"zh":"zh-TW",billing_address_collection:"auto",customer_creation:"always",ui_mode:"hosted",metadata:{paymentType:"couple",locale:n,...o&&t&&{specificProblem:t,fromChat:"true"},...o&&s&&{concern:s}}});return p.NextResponse.json({sessionId:l.id})}catch(e){return console.error("Error creating checkout session:",e),p.NextResponse.json({error:"Error creating checkout session"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/payment-couple/route",pathname:"/api/payment-couple",filename:"route",bundlePath:"app/api/payment-couple/route"},resolvedPagePath:"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/api/payment-couple/route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:_,workUnitAsyncStorage:h,serverHooks:m}=d;function C(){return(0,c.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:h})}},78335:()=>{},79646:e=>{"use strict";e.exports=require("child_process")},81630:e=>{"use strict";e.exports=require("http")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{},98870:(e,r,t)=>{"use strict";function s(e,r){let t="zh-CN"===e?"CNY":"HKD",s={CNY:{fengshui:process.env.PRICE_ID2_CNY,life:process.env.PRICE_ID4_CNY,fortune:process.env.PRICE_ID5_CNY,couple:process.env.PRICE_ID6_CNY},HKD:{fengshui:process.env.PRICE_ID2_HKD,life:process.env.PRICE_ID4_HKD,fortune:process.env.PRICE_ID5_HKD,couple:process.env.PRICE_ID6_HKD}},o=s[t]?.[r];return o?(console.log(`âœ… Selected price ID: ${o} for ${t} ${r}`),o):(console.error(`âŒ No price ID found for currency: ${t}, paymentType: ${r}`),s.HKD[r]||process.env.PRICE_ID2_HKD)}function o(e){let r=new URL(e.url).pathname.split("/");return"zh-CN"===r[1]?"zh-CN":"zh-TW"===r[1]?"zh-TW":(e.headers.get("accept-language")||"").includes("zh-CN")||(e.headers.get("referer")||"").includes("/zh-CN/")?"zh-CN":"zh-TW"}t.d(r,{_j:()=>s,y3:()=>o})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[7719,580,7877],()=>t(75472));module.exports=s})();