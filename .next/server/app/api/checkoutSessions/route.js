(()=>{var e={};e.id=341,e.ids=[341],e.modules={2592:(e,s,r)=>{"use strict";function t(e){return{status:401,message:e||"Unauthorized"}}function n(e){let s={status:0};return e&&(s.data=e),s}function u(e){return{status:-1,message:e||"server error"}}r.d(s,{Cs:()=>n,J4:()=>u,kn:()=>t})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},24592:(e,s,r)=>{"use strict";r.r(s),r.d(s,{patchFetch:()=>h,routeModule:()=>x,serverHooks:()=>_,workAsyncStorage:()=>v,workUnitAsyncStorage:()=>E});var t={};r.r(t),r.d(t,{POST:()=>l});var n=r(79643),u=r(57380),i=r(50747),o=r(24714),c=r(85883),a=r(2592),p=r(28896),d=r(48151);async function l(){let e=await (0,d.u)();if(null==e)return o.NextResponse.json((0,a.kn)());try{let s=(await (0,c.b3)()).get("origin"),r=await p._.checkout.sessions.create({line_items:[{price:process.env.PRICE_ID,quantity:1}],mode:"payment",success_url:`${s}/success?session_id={CHECKOUT_SESSION_ID}`,cancel_url:`${s}/report?canceled=true`,metadata:{userId:e.userId}});return console.log("session.url",r.url),o.NextResponse.json((0,a.Cs)(r))}catch(e){return o.NextResponse.json((0,a.J4)("支付错误"+e.message))}}let x=new n.AppRouteRouteModule({definition:{kind:u.RouteKind.APP_ROUTE,page:"/api/checkoutSessions/route",pathname:"/api/checkoutSessions",filename:"route",bundlePath:"app/api/checkoutSessions/route"},resolvedPagePath:"D:\\code\\fengshui\\src\\app\\api\\checkoutSessions\\route.js",nextConfigOutput:"",userland:t}),{workAsyncStorage:v,workUnitAsyncStorage:E,serverHooks:_}=x;function h(){return(0,i.patchFetch)({workAsyncStorage:v,workUnitAsyncStorage:E})}},28354:e=>{"use strict";e.exports=require("util")},28896:(e,s,r)=>{"use strict";r.d(s,{_:()=>t});let t=new(r(52127)).A(process.env.STRIPE_SECRET_KEY)},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},36439:()=>{},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48151:(e,s,r)=>{"use strict";r.d(s,{u:()=>u});var t=r(59357);async function n(){let e=await (0,t.j2)();return e?.user?e.user:null}let u=(0,r(73780).cache)(n)},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},57975:e=>{"use strict";e.exports=require("node:util")},59357:(e,s,r)=>{"use strict";r.d(s,{Y9:()=>o,j2:()=>p});var t=r(79588),n=r(42308),u=r(50922),i=r(29660);let{handlers:o,signIn:c,signOut:a,auth:p}=(0,t.Ay)({trustHost:!0,providers:[i.A,(0,n.A)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET}),(0,u.A)({clientId:process.env.APPLE_ID,clientSecret:process.env.APPLE_SECRET})],secret:process.env.NEXTAUTH_SECRET,callbacks:{jwt:async({token:e,user:s,account:r})=>(r&&s&&(e.accessToken=r.access_token,e.id=s.id),e),session:async({session:e,token:s})=>(s&&e.user&&(e.user={...e.user,id:s.sub,userId:e.user.email}),e)},pages:{}})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},77598:e=>{"use strict";e.exports=require("node:crypto")},79646:e=>{"use strict";e.exports=require("child_process")},81630:e=>{"use strict";e.exports=require("http")},94735:e=>{"use strict";e.exports=require("events")},99487:()=>{}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[643,883,702,622,921,127],()=>r(24592));module.exports=t})();