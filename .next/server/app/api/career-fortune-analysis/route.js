(()=>{var e={};e.id=6731,e.ids=[6731],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{},98309:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>y,routeModule:()=>p,serverHooks:()=>g,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>m});var n={};r.r(n),r.d(n,{POST:()=>c});var s=r(96559),a=r(48088),o=r(37719),i=r(32190);async function c(e){try{let{prompt:t,userInfo:r,wuxingData:n}=await e.json(),s=!!(process.env.DEEPSEEK_API_KEY||process.env.API_KEY);console.log("\uD83C\uDFE2 Career Analysis Request:",{hasPrompt:!!t,userGender:r?.gender,dayMaster:n?.dayStem,hasDeepSeekKey:s,apiKeySource:process.env.DEEPSEEK_API_KEY?"DEEPSEEK_API_KEY":process.env.API_KEY?"API_KEY":"NONE"});let a=await l(t,r,n);return console.log("✅ Career Analysis Generated Successfully"),i.NextResponse.json({success:!0,analysis:a,isAIGenerated:s})}catch(e){return console.error("❌ Career Fortune Analysis API Error:",e),i.NextResponse.json({success:!1,error:"Failed to generate career analysis"},{status:500})}}async function l(e,t,r){try{console.log("\uD83D\uDD11 Attempting DeepSeek API call for career analysis...");let n=process.env.DEEPSEEK_API_KEY||process.env.API_KEY;if(console.log("\uD83D\uDD0D API Key found:",n?`${n.substring(0,10)}...${n.substring(n.length-4)}`:"NOT FOUND"),!n||"your_actual_deepseek_api_key_here"===n)throw Error("DeepSeek API key not configured");let s=await fetch("https://api.deepseek.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`,Accept:"application/json"},body:JSON.stringify({model:"deepseek-chat",messages:[{role:"system",content:"你是一位專業的命理師和職業規劃師，擅長根據八字進行事業分析。請嚴格按照要求的JSON格式回應，不要添加任何額外的文字說明。"},{role:"user",content:e}],temperature:.3,max_tokens:4e3,stream:!1})});if(console.log("\uD83D\uDCE1 DeepSeek Response Status:",s.status),!s.ok){let e=await s.text();throw console.log("❌ DeepSeek API Error:",e),Error(`API request failed: ${s.status} - ${e}`)}let a=await s.json();if(console.log("✅ DeepSeek API Success for career analysis"),a.choices&&a.choices[0]&&a.choices[0].message)return function(e,t,r){try{var n,s,a;let t=e.trim();return t.startsWith("```json")?t=t.replace(/```json\n?/,"").replace(/\n?```$/,""):t.startsWith("```")&&(t=t.replace(/```\n?/,"").replace(/\n?```$/,"")),n=JSON.parse(t),s=0,a=r,{summary:{title:n.summary?.title||`傷官制殺，專業權威之路`,description:n.summary?.description||"基於八字分析的事業運勢總結"},talents:{天賦特質解碼:{title:"天賦特質解碼",content:n.talents?.["天賦特質解碼"]?.content||[{name:`${a.yearStem}${a.yearBranch}傷官`,description:"核心優勢分析",attention:"注意事項說明"}]},二十年黃金賽道:{title:"二十年黃金賽道",content:n.talents?.["二十年黃金賽道"]?.content||{periods:[{years:"2025-2035",luck:"大運",action:"關鍵動作",bestYear:"最佳年份",warning:"風險預警"}]}},權力巔峰標誌:{title:"權力巔峰標誌",content:n.talents?.["權力巔峰標誌"]?.content||{peakYear:"巔峰年份",peakDescription:"權力表現",bestPartners:"最佳合作",avoidIndustries:"行業紅線"}}},strategies:{officeLayout:n.strategies?.officeLayout||{title:"辦公室佈局",description:"佈局建議",details:"詳細說明",warning:"禁忌事項"},annualStrategy:n.strategies?.annualStrategy||{title:"流年借力",year:"特定年份",description:"格局優勢",benefit:"利用方式"},lifelongTaboo:n.strategies?.lifelongTaboo||{title:"終身禁忌",warning:"禁忌行為",reason:"理論解釋"}}}}catch(e){return console.log("Error parsing AI career response, using fallback:",e.message),u(t,r)}}(a.choices[0].message.content,t,r);throw console.log("⚠️ Unexpected response format:",JSON.stringify(a,null,2)),Error("Invalid API response format")}catch(e){return console.log("\uD83D\uDD04 DeepSeek AI unavailable for career, using structured mock data:",e.message),u(t,r)}}function u(e,t){let r=new Date(e.birthDateTime),n=new Date().getFullYear();r.getFullYear();let s=t.dayStem||"甲",a=t.dayStemWuxing||"木";return e.gender,{summary:{title:`傷官制殺，專業權威之路`,description:`年柱${t.yearStem}${t.yearBranch}傷官駕殺（制${t.monthStem}中${t.monthBranch}金），月柱${t.monthStem}${t.monthBranch}七殺透干，構成「傷官制殺」貴格，適合金性權威職業。`},talents:{天賦特質解碼:{title:"天賦特質解碼",content:[{name:`${t.yearStem}${t.yearBranch}傷官`,description:`${t.yearStem}${a}代表生發與創新，傷官格賦予顛覆性思維，擅長打破常規，轉化危機為機會，能在混亂中快速識別問題核心，提出獨到解決方案。`,attention:`注意事項：傷官過旺易招是非，職場中謹言慎行。可佩戴綠玉吊墜，化傷為財，穩定情緒。`},{name:`${t.monthStem}${t.monthBranch}七殺`,description:`${t.monthStem}土穩重厚實，七殺主權威與壓力，賦予極強抗壓能力與執行力，適合高壓行業。能在緊迫環境中保持冷靜，高效決策。`,attention:`注意事項：七殺為忌時易生疲勞，注意休息；辦公桌右後方（白虎位）放置黑曜石球，化殺生身，防小人干擾。`},{name:`${t.hourStem}${t.hourBranch}正印`,description:`${t.hourStem}${t.hourStemWuxing}柔韌滲透，代表智慧與洞察，主滲透分析力，利於情報分析、市場調研或數據挖掘，能深入挖掘隱藏信息，預測趨勢。`,attention:`注意事項：${t.hourStemWuxing}喜流動，避久坐辦公；家中北方位（坎位）擺放流水景觀（小魚缸，3-5條魚），旺水氣，助思維敏捷。`}]},二十年黃金賽道:{title:"二十年黃金賽道",content:{periods:[{years:`${n} - ${n+10}`,luck:"丁卯運",action:"考取司法/醫師資格",bestYear:`${n+2}丁未年最佳`,warning:`${n+6}辛亥年慎言辭職`},{years:`${n+10} - ${n+20}`,luck:"丙寅運",action:"組建專業團隊",bestYear:`${n+13}戊午年契機`,warning:"避開東南亞市場（寅巳申三刑）"},{years:`${n+20} - ${n+30}`,luck:"乙丑運",action:"創立行業標準",bestYear:`${n+21}丙寅年`,warning:"防下屬背叛（丑戌刑）"}]}},權力巔峰標誌:{title:"權力巔峰標誌",content:{peakYear:`${n+24}己巳年`,peakDescription:"己土殺星透干，掌機構決策權",bestPartners:"猴（申）、鼠（子）、龍（辰）三合水局",avoidIndustries:"遠離地產業（土重剋水）、娛樂業（火旺耗身）"}}},strategies:{officeLayout:{title:"辦公室佈局",description:"正西放銅質文昌塔（申金位）",details:"銅質文昌塔，放置於辦公桌正西或辦公室西牆邊，底座穩固，塔尖朝上，增強文昌星能量，助思考敏捷與職場表現。",warning:"正西避免放置紅色物品（如紅色文件夾或裝飾），以免火剋金，削弱文昌塔功效；保持該區域整潔，避免雜物堆積。"},annualStrategy:{title:"流年借力",year:`${n+4}年為己酉年`,description:"天干己土（印星）與地支酉金（七殺）形成殺印相生格局",benefit:`利於權力提升與職場突破。此年你的${s}${a}日主得印星生助，思維清晰，決策果斷，適合競聘管理職位或承擔更高責任。`},lifelongTaboo:{title:"終身禁忌",warning:"勿與上司發生戀情（七殺為忌神）",reason:"七殺為忌神，代表壓力與權威，若與上司發展戀情，易因權力不平衡引發職場危機，影響事業前途，甚至導致名譽損失或職位不穩。"}}}}let p=new s.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/career-fortune-analysis/route",pathname:"/api/career-fortune-analysis",filename:"route",bundlePath:"app/api/career-fortune-analysis/route"},resolvedPagePath:"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/api/career-fortune-analysis/route.js",nextConfigOutput:"",userland:n}),{workAsyncStorage:d,workUnitAsyncStorage:m,serverHooks:g}=p;function y(){return(0,o.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:m})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[7719,580],()=>r(98309));module.exports=n})();