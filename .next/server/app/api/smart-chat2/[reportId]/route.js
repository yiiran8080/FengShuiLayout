(()=>{var e={};e.id=9950,e.ids=[9950],e.modules={2271:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>g,routeModule:()=>u,serverHooks:()=>m,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>d});var s={};t.r(s),t.d(s,{GET:()=>c});var o=t(96559),i=t(48088),n=t(37719),a=t(12518);let p=process.env.MONGODB_URI;async function c(e,{params:r}){try{let{reportId:e}=r;if(!e)return Response.json({success:!1,error:"Report ID is required"},{status:400});let t=new a.MongoClient(p);await t.connect();let s=t.db("HarmoniqFengShui");console.log(`ðŸ” æ­£åœ¨æŸ¥æ‰¾å ±å‘Š ID: ${e}`);let o=await s.collection("CoupleReports").findOne({_id:new a.ObjectId(e)});if(o)return console.log(`ðŸ“„ å¾žCoupleReportsæ‰¾åˆ°å ±å‘Š:`,{sessionId:o.sessionId,originalSpecificProblem:o.reportMetadata?.originalSpecificProblem}),await t.close(),Response.json({userInputs:o.userInputs,reportMetadata:o.reportMetadata,messages:[{content:o.reportMetadata?.originalSpecificProblem||o.userInputs?.problem||"æ„Ÿæƒ…åˆ†æž",timestamp:o.createdAt}]});let i=await s.collection("SmartUserIntents").findOne({reportId:e});if(!i)return await t.close(),Response.json({success:!1,error:"Report not found"},{status:404});console.log(`ðŸ“„ æ‰¾åˆ°SmartUserIntent:`,{sessionId:i.sessionId,originalSpecificProblem:i.originalSpecificProblem,primaryConcern:i.primaryConcern});let n={userInputs:{birthday:i.userBirthday,birthday2:i.partnerBirthday,gender:i.userGender||"male",gender2:i.partnerGender||"female",time:i.userTime,time2:i.partnerTime,problem:i.specificQuestion},reportMetadata:{originalSpecificProblem:i.originalSpecificProblem,primaryConcern:i.primaryConcern,relationshipAnalysisType:i.relationshipAnalysisType,sessionId:i.sessionId,reportId:e,paymentStatus:i.paymentStatus,createdAt:i.createdAt},messages:[{content:i.originalSpecificProblem||i.specificQuestion,timestamp:i.createdAt}]};return await t.close(),console.log(`âœ… å ±å‘Šæ•¸æ“šæº–å‚™å®Œæˆ:`,{originalSpecificProblem:n.reportMetadata.originalSpecificProblem,fallbackProblem:n.userInputs.problem}),Response.json(n)}catch(e){return console.error("Get report error:",e),Response.json({success:!1,error:e.message},{status:500})}}let u=new o.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/smart-chat2/[reportId]/route",pathname:"/api/smart-chat2/[reportId]",filename:"route",bundlePath:"app/api/smart-chat2/[reportId]/route"},resolvedPagePath:"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/api/smart-chat2/[reportId]/route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:d,serverHooks:m}=u;function g(){return(0,n.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:d})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12518:e=>{"use strict";e.exports=require("mongodb")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{},96559:(e,r,t)=>{"use strict";e.exports=t(44870)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[7719],()=>t(2271));module.exports=s})();