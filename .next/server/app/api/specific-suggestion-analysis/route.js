(()=>{var e={};e.id=4674,e.ids=[4674],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{},99918:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>f,routeModule:()=>g,serverHooks:()=>h,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{POST:()=>p});var o=r(96559),n=r(48088),i=r(37719),c=r(32190);async function a(e){try{let t=await fetch("https://api.deepseek.com/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${process.env.DEEPSEEK_API_KEY}`},body:JSON.stringify({model:"deepseek-chat",messages:[{role:"system",content:"你是一位專業的風水命理大師，具備深厚的八字分析能力。請根據用戶的具體問題生成專業建議。請全部使用繁體中文回應。"},{role:"user",content:e}],max_tokens:6e3,temperature:.8})});if(!t.ok)throw Error(`DeepSeek API error: ${t.status}`);return(await t.json()).choices[0].message.content}catch(e){throw console.error("DeepSeek API Error:",e),e}}function l(){return[{title:"環境調整",description:"根據你的八字分析，建議調整居住或工作環境，增強有利的風水元素。選擇適合的方位和佈局，有助於提升整體運勢。",icon:"\uD83C\uDFE0",category:"環境型"},{title:"時機把握",description:"依據你的命理週期，建議在有利的時間段進行重要決策。關注農曆時間和個人運勢週期，把握最佳行動時機。",icon:"⏰",category:"時機型"},{title:"個人提升",description:"針對你的八字特點，建議加強相應的個人能力和素質。透過學習和實踐，提升自身的競爭力和適應能力。",icon:"\uD83D\uDCDA",category:"提升型"},{title:"人際網絡",description:"根據你的社交宮位分析，建議擴展有益的人際關係。與貴人建立良好關係，避免與不利的人過多接觸。",icon:"\uD83E\uDD1D",category:"人脈型"},{title:"心態調整",description:"基於你的性格特質，建議保持積極正面的心態。透過冥想、運動等方式調節情緒，維持內心的平衡與和諧。",icon:"\uD83E\uDDD8",category:"心理型"}]}function u(){return[{title:"衝動決策",description:"避免在情緒激動或壓力大的時候做重要決定。冷靜思考，諮詢可靠的建議後再行動，以免造成不必要的損失。",icon:"\uD83D\uDEAB",level:"嚴禁",consequence:"可能導致重大失誤"},{title:"負面環境",description:"遠離充滿負能量的人和環境，避免長期處於消極的氛圍中。選擇積極正面的環境，有助於維持良好的運勢。",icon:"⚠️",level:"避免",consequence:"影響個人氣場"},{title:"過度勞累",description:"注意工作與生活的平衡，避免過度透支身體和精神。適當休息和放鬆，保持身心健康的狀態。",icon:"\uD83D\uDE35",level:"注意",consequence:"損害身體健康"},{title:"投機行為",description:"避免參與高風險的投機活動，包括賭博、投機股票等。穩健理財，避免因貪心而造成財務損失。",icon:"\uD83C\uDFB0",level:"禁止",consequence:"財務風險增大"},{title:"忽視直覺",description:"不要完全忽視內心的直覺和感受，特別是在重要決策時。適當相信第六感，但也要結合理性分析。",icon:"\uD83D\uDD2E",level:"警惕",consequence:"錯失重要機會"}]}async function p(e){try{let{userInfo:t}=await e.json();if(!t)return c.NextResponse.json({error:"User information is required"},{status:400});let r=function(e){let{birthDateTime:t,concern:r,problem:s,gender:o}=e;return`請為用戶的具體問題提供專業的風水命理建議分析：

【用戶資訊】
出生時間：${t}
性別：${"male"===o?"男性":"女性"}
關注領域：${({財運:"財務財運",事業:"事業發展",感情:"感情關係",健康:"健康養生",學業:"學業成就",工作:"工作職場"})[r]||r}
具體問題：${s}

【分析要求】
請基於用戶的八字命理和具體問題，生成：

五大建議方案：
1. [建議標題]：[具體可行的建議內容，約100字，包含實際操作方法]
2. [建議標題]：[具體可行的建議內容，約100字，包含實際操作方法]
3. [建議標題]：[具體可行的建議內容，約100字，包含實際操作方法]
4. [建議標題]：[具體可行的建議內容，約100字，包含實際操作方法]
5. [建議標題]：[具體可行的建議內容，約100字，包含實際操作方法]

五大禁忌行為：
1. [禁忌標題]：[必須避免的行為，約100字，說明為什麼要避免和可能後果]
2. [禁忌標題]：[必須避免的行為，約100字，說明為什麼要避免和可能後果]
3. [禁忌標題]：[必須避免的行為，約100字，說明為什麼要避免和可能後果]
4. [禁忌標題]：[必須避免的行為，約100字，說明為什麼要避免和可能後果]
5. [禁忌標題]：[必須避免的行為，約100字，說明為什麼要避免和可能後果]

【格式要求】
- 每個建議和禁忌都要具體可行
- 內容長度控制在100字左右
- 結合八字命理原理
- 針對具體問題提供解決方案
- 語言專業但易懂
- **重要：請全部使用繁體中文輸出，不要使用簡體中文**

請嚴格按照上述格式輸出，確保內容的專業性和實用性。所有回應必須使用繁體中文。`}(t);console.log("Generated prompt:",r);let s=await a(r);console.log("AI Response received:",s);let o=function(e){try{console.log("Raw AI Response:",e);let t=e.match(/五大建議方案[：:](.*?)五大禁忌行為/s),r=t?t[1].trim():"";if(!r){let t=e.match(/建議方案[：:]?(.*?)(?=禁忌|避免|注意)/s);r=t?t[1].trim():""}let s=e.match(/五大禁忌行為[：:](.*?)(?:\n\n|$)/s),o=s?s[1].trim():"";if(!o){let t=e.match(/禁忌行為[：:]?(.*?)$/s);o=t?t[1].trim():""}console.log("Extracted suggestions text:",r),console.log("Extracted taboos text:",o);let n=function(e){let t=[],r=[];for(let t of[/(\d+)[、.]\s*([^：:]+)[：:]([^。]+。?)/g,/([^：:]+)[：:]([^。\n]+)/g,/\*\*([^*]+)\*\*[：:]?([^。\n]+)/g,/([一二三四五六七八九十]+)[、.]\s*([^：:]+)[：:]([^。]+)/g]){let s=[...e.matchAll(t)];if(s.length>0){r=s;break}}return r.forEach((e,r)=>{if(r<5){let s=e[2]||e[1]||`建議 ${r+1}`,o=e[3]||e[2]||e[1]||"";s=s.trim().replace(/[：:]/g,""),(o=o.trim()).length<80?o+="...根據你的八字分析，建議持續觀察並調整策略，以達到最佳效果。":o.length>120&&(o=o.substring(0,100)+"..."),t.push({title:s,description:o,icon:["\uD83C\uDFAF","\uD83D\uDCA1","⭐","\uD83D\uDE80","\uD83D\uDD2E"][r]||"\uD83D\uDCAB",category:["核心型","實用型","提升型","突破型","智慧型"][r]||"建議型"})}}),t}(r),i=function(e){let t=[],r=[];for(let t of[/(\d+)[、.]\s*([^：:]+)[：:]([^。]+。?)/g,/([^：:]+)[：:]([^。\n]+)/g,/\*\*([^*]+)\*\*[：:]?([^。\n]+)/g,/([一二三四五六七八九十]+)[、.]\s*([^：:]+)[：:]([^。]+)/g]){let s=[...e.matchAll(t)];if(s.length>0){r=s;break}}return r.forEach((e,r)=>{if(r<5){let s=e[2]||e[1]||`禁忌 ${r+1}`,o=e[3]||e[2]||e[1]||"";s=s.trim().replace(/[：:]/g,""),(o=o.trim()).length<80?o+="...避免此行為可能導致的負面後果，建議謹慎處理相關事務。":o.length>120&&(o=o.substring(0,100)+"..."),t.push({title:s,description:o,icon:["\uD83D\uDEAB","⚠️","❌","\uD83D\uDD34","\uD83D\uDED1"][r]||"⛔",level:["嚴禁","避免","謹慎","警惕","注意"][r]||"注意",consequence:["影響運勢","阻礙發展","增加風險","損害利益","破壞平衡"][r]||"可能影響整體運勢"})}}),t}(o);return console.log("Parsed suggestions:",n),console.log("Parsed taboos:",i),{suggestions:n.length>0?n:l(),taboos:i.length>0?i:u()}}catch(e){return console.error("Parse error:",e),{suggestions:l(),taboos:u()}}}(s),n={title:"針對性建議",subtitle:`專門解決：${t.problem||"個人關注問題"}`,suggestions:o.suggestions,taboos:o.taboos,concern:t.concern,problem:t.problem,userBirthday:t.birthDateTime,userGender:"male"===t.gender?"男性":"女性",aiResponse:s,prompt:r};return c.NextResponse.json({success:!0,data:n})}catch(t){console.error("API Error:",t);let e={title:"針對性建議",subtitle:"基於傳統風水命理的一般性建議",suggestions:l(),taboos:u(),concern:"綜合",problem:"一般性問題",userBirthday:"未指定",userGender:"未指定",aiResponse:"使用預設建議內容",prompt:"系統預設分析"};return c.NextResponse.json({success:!0,data:e,fallback:!0})}}let g=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/specific-suggestion-analysis/route",pathname:"/api/specific-suggestion-analysis",filename:"route",bundlePath:"app/api/specific-suggestion-analysis/route"},resolvedPagePath:"/Users/michaelng/Desktop/HarmoniqFengShui/FengShuiLayout/src/app/api/specific-suggestion-analysis/route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:d,workUnitAsyncStorage:m,serverHooks:h}=g;function f(){return(0,i.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:m})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[7719,580],()=>r(99918));module.exports=s})();