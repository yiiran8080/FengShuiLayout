# 🎯 Mixpanel 追蹤設定清單

## 📄 頁面名稱對應表

### 🏠 首頁

- `/zh-TW` → **首頁**
- `/zh-CN` → **首页**

### 🏢 主要服務頁面

- `/zh-TW/design` → **房間設計頁面**
- `/zh-TW/report` → **綜合報告頁面**
- `/zh-TW/success` → **成功頁面**
- `/zh-TW/price` → **價格頁面**
- `/zh-CN/design` → **房间设计页面**
- `/zh-CN/report` → **综合报告页面**
- `/zh-CN/success` → **成功页面**
- `/zh-CN/price` → **价格页面**

### 📊 分析報告頁面

- `/zh-TW/feng-shui-report` → **風水分析報告**
- `/zh-TW/couple-report` → **情侶配對報告**
- `/zh-TW/bazhai-report` → **八宅分析報告**
- `/zh-TW/four-fortune-analysis` → **四柱分析**
- `/zh-CN/feng-shui-report` → **风水分析报告**
- `/zh-CN/couple-report` → **情侣配对报告**
- `/zh-CN/bazhai-report` → **八宅分析报告**
- `/zh-CN/four-fortune-analysis` → **四柱分析**

### 📝 輸入表單頁面

- `/zh-TW/birthday-entry` → **生日輸入表單**
- `/zh-TW/couple-entry` → **情侶資料表單**
- `/zh-TW/fortune-entry` → **運勢輸入表單**
- `/zh-CN/birthday-entry` → **生日输入表单**
- `/zh-CN/couple-entry` → **情侣资料表单**
- `/zh-CN/fortune-entry` → **运势输入表单**

### 💬 聊天互動頁面

- `/zh-TW/chat` → **聊天介面**
- `/zh-TW/smart-chat2` → **AI聊天介面**
- `/zh-CN/chat` → **聊天界面**
- `/zh-CN/smart-chat2` → **AI聊天界面**

### 👤 用戶管理頁面

- `/zh-TW/auth` → **用戶認證**
- `/zh-TW/customer` → **客戶儀表板**
- `/zh-TW/payment` → **付款頁面**
- `/zh-TW/report-history` → **報告歷史**
- `/zh-CN/auth` → **用户认证**
- `/zh-CN/customer` → **客户仪表板**
- `/zh-CN/payment` → **付款页面**
- `/zh-CN/report-history` → **报告历史**

### 🧪 測試演示頁面

- `/zh-TW/mixpanel-user-demo` → **Mixpanel用戶演示**
- `/zh-TW/button-test` → **按鈕追蹤測試頁面**
- `/zh-TW/demo` → **演示頁面**
- `/zh-TW/test-history` → **測試歷史**
- `/zh-CN/demo` → **演示页面**
- `/zh-CN/test-history` → **测试历史**

### 🔄 未定義頁面

- 其他路徑 → **頁面: [實際路徑]**

---

## 🔘 按鈕名稱識別系統

### 🏆 優先級順序 (從高到低)

#### 1️⃣ **最高優先級: data-track 屬性**

```html
<button data-track="免費開始測算">點擊</button>
```

→ Mixpanel 顯示: **免費開始測算**

#### 2️⃣ **第二優先級: aria-label 屬性**

```html
<button aria-label="立即分析">🔮</button>
```

→ Mixpanel 顯示: **立即分析**

#### 3️⃣ **第三優先級: 按鈕文字內容**

```html
<button>查看報告</button>
```

→ Mixpanel 顯示: **查看報告**

#### 4️⃣ **第四優先級: 按鈕 ID**

```html
<button id="couple-analysis-btn">分析</button>
```

→ Mixpanel 顯示: **couple-analysis-btn**

#### 5️⃣ **最後選擇: 智能上下文識別**

### 🧠 智能識別模式

#### 🗑️ 刪除按鈕

- 圖片 alt 包含 "trash" → **刪除按鈕**
- 元素包含垃圾桶圖標 → **刪除按鈕**

#### 📁 文件上傳

- 包含 SVG 且父元素有"照片" → **文件上傳區域**
- 父元素包含"瀏覽"或"選擇" → **瀏覽文件按鈕**

#### 🔵 圓形圖標

- 圓形按鈕 + 包含圖片 → **圓形圖標按鈕**

#### 🔗 連結按鈕

- 有 href 屬性 → **連結: [href 最後部分]**

#### 🏷️ 類名識別

尋找類名中包含以下關鍵字:

- `btn` → **btn按鈕**
- `button` → **button按鈕**
- `upload` → **upload按鈕**
- `delete` → **delete按鈕**
- `close` → **close按鈕**
- `submit` → **submit按鈕**
- `cta` → **cta按鈕**
- `primary` → **primary按鈕**
- `secondary` → **secondary按鈕**

#### ❓ 最後選擇

- 都無法識別 → **未知按鈕**

---

## 📋 常見按鈕名稱範例

### 🎯 業務相關按鈕

- **免費開始測算**
- **立即分析**
- **情侶配對**
- **查看報告**
- **開始測算**
- **風水分析**
- **夫妻配對**
- **八字分析**

### 🔧 功能性按鈕

- **提交表格**
- **登入**
- **登出**
- **註冊**
- **返回**
- **下一步**
- **確認**
- **取消**

### 📱 UI 控制按鈕

- **關閉**
- **展開**
- **收合**
- **刷新**
- **搜尋**
- **篩選**

---

## 🎨 按鈕追蹤屬性

每個按鈕點擊都會包含以下詳細資訊:

### 📊 基本資訊

- **按鈕名稱**: 識別出的按鈕名稱
- **按鈕文字**: 實際顯示的文字
- **按鈕ID**: HTML ID 屬性
- **按鈕類別**: CSS 類名
- **按鈕標籤**: aria-label 屬性
- **按鈕連結**: href 屬性 (如果是連結)

### 🏷️ 類型資訊

- **按鈕類型**: button/a/input
- **是否按鈕**: true/false
- **是否輸入**: true/false
- **是否連結**: true/false

### 📍 位置資訊

- **按鈕位置**: {x, y, width, height}
- **頁面路徑**: 當前頁面路徑
- **頁面標題**: 頁面標題
- **點擊時間戳**: ISO 時間戳

### 🌐 環境資訊

- **語言**: zh-TW 或 zh-CN
- **環境類型**: 正式環境 或 測試環境

---

## 💬 Chatbox 追蹤系統

### ✅ **已實施的聊天追蹤**

#### 🔄 **聊天會話追蹤**

- **會話開始**: 自動生成會話ID，記錄開始時間
- **會話結束**: 頁面離開時記錄會話時長和總訊息數

#### ⌨️ **輸入行為追蹤**

- **開始輸入**: 檢測用戶開始在文字框輸入
- **停止輸入**: 2秒無輸入後認為停止，記錄輸入時長
- **聚焦輸入框**: 記錄用戶點擊輸入框的行為

#### 📤 **發送訊息追蹤**

- **點擊發送**: 追蹤發送按鈕點擊
- **鍵盤發送**: 追蹤 Enter 鍵發送
- **訊息詳情**: 長度、語言類型 (中文/英文/數字)

#### 🤖 **AI 回應追蹤**

- **自動檢測**: 監測包含"風鈴"、"AI"的回應
- **回應分析**: 記錄回應長度、類型、是否包含圖片

### 📊 **聊天事件列表**

| 事件名稱         | 觸發時機             | 主要屬性                       |
| ---------------- | -------------------- | ------------------------------ |
| **聊天會話開始** | 頁面載入聊天介面     | 會話ID、開始時間、頁面路徑     |
| **開始輸入訊息** | 用戶在輸入框開始打字 | 會話ID、當前訊息數             |
| **停止輸入訊息** | 用戶停止輸入2秒後    | 輸入時長、訊息長度、包含中文   |
| **聚焦輸入框**   | 用戶點擊輸入框       | 會話ID、聚焦時間               |
| **發送聊天訊息** | 點擊發送或按Enter    | 訊息長度、發送方式、語言類型   |
| **收到AI回應**   | AI返回回應訊息       | AI回應長度、回應類型、包含圖片 |
| **聊天會話結束** | 用戶離開頁面         | 會話時長、總訊息數、結束原因   |

### 🎯 **追蹤的聊天頁面**

- `/zh-TW/chat` → **聊天介面**
- `/zh-TW/smart-chat2` → **AI聊天介面**
- `/zh-CN/chat` → **聊天界面**
- `/zh-CN/smart-chat2` → **AI聊天界面**
- `/zh-TW` (首頁聊天功能)
- `/zh-CN` (首页聊天功能)

---

## 🎯 使用建議

### ✅ 推薦做法

1. 重要按鈕添加 `data-track` 屬性
2. 圖標按鈕添加 `aria-label` 屬性
3. 使用描述性的按鈕文字
4. 為特殊功能按鈕設置有意義的 ID
5. **聊天元素**: 確保聊天相關元素有適當的類名或ID

### 📝 範例

```html
<!-- 最佳實踐 -->
<button data-track="開始風水分析">🔮 免費開始測算</button>

<!-- 聊天發送按鈕 -->
<button data-track="發送聊天訊息" aria-label="發送訊息">
	<Send className="w-4 h-4" />
</button>

<!-- 聊天輸入框 -->
<textarea
	data-track="聊天輸入框"
	placeholder="輸入任何問題..."
	className="chat-input"
/>

<!-- 次佳實踐 -->
<button aria-label="情侶配對分析">💑</button>

<!-- 一般實踐 -->
<button id="submit-form">提交表格</button>

<!-- 基本實踐 -->
<button>查看報告</button>
```

### 🔍 **在 Mixpanel 中查看聊天數據**

- 使用 `會話ID` 過濾特定聊天會話
- 查看 `發送方式` 了解用戶偏好 (點擊 vs 鍵盤)
- 分析 `訊息長度` 和 `語言類型` 了解用戶行為
- 監控 `會話時長` 評估用戶參與度

這樣設定後，Mixpanel 中就會顯示完整的聊天行為數據和清晰的按鈕/頁面名稱！
